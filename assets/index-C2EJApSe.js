const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/HomeView-3j3n4A9y.js","assets/vendor-goXqKlOD.js","assets/Button-CKwyDI4h.js","assets/CircularCountdown-mLldGJJz.js","assets/CircularCountdown-B3Wehvel.css","assets/prayerTimesService-C3AToNJq.js","assets/HomeView-Bqg2P8_t.css","assets/ImportView-VXP2fb45.js","assets/ImportView-5Y_YcOMU.css","assets/BrowseView-MQXZctlx.js","assets/CategoryView-aMnnN-9N.js","assets/QuestionListItem-Ny9Qfla_.js","assets/QuestionListItem-Bu5oIuY4.css","assets/CategoryView-B-K7dwJs.css","assets/QuestionView-DMCHS61o.js","assets/sharing-C8lTFykI.js","assets/QuestionView-RwT1VcNa.css","assets/SearchView-45U3b9cy.js","assets/search-Ch1WBRTM.js","assets/FoldersView-DUTtWcOO.js","assets/FoldersView-B7VYpyYr.css","assets/QuizView-RK0TrP2k.js","assets/leaderboardService-BAmpFpHg.js","assets/QuizView-D__CkTCI.css","assets/PrayerTimesView-HOFp6Vk9.js","assets/LeaderboardView-C78hfZIN.js","assets/SettingsView-Czq47F7k.js","assets/SettingsView-C5u1OKlS.css","assets/PrivacyView-BnH7USGb.js"])))=>i.map(i=>d[i]);
import{c as Xa,a as es,r as pe,d as Ii,b as Ke,h as Q,e as ue,f as ro,g as Ai,n as Ue,o as oe,i as le,u as Je,j as Si,k as oo,l as T,w as Ot,F as un,m as Vn,p as Ve,t as Me,q as Ci,s as ts,v as Oi,x as ns,T as rs,y as Ti,z as os,A as is,B as cn,C as as,D as ss,E as cs,G as us}from"./vendor-goXqKlOD.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))c(l);new MutationObserver(l=>{for(const h of l)if(h.type==="childList")for(const m of h.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&c(m)}).observe(document,{childList:!0,subtree:!0});function i(l){const h={};return l.integrity&&(h.integrity=l.integrity),l.referrerPolicy&&(h.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?h.credentials="include":l.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function c(l){if(l.ep)return;l.ep=!0;const h=i(l);fetch(l.href,h)}})();const ls="modulepreload",ds=function(o){return"/islamqa/"+o},ei={},Le=function(n,i,c){let l=Promise.resolve();if(i&&i.length>0){document.getElementsByTagName("link");const m=document.querySelector("meta[property=csp-nonce]"),E=(m==null?void 0:m.nonce)||(m==null?void 0:m.getAttribute("nonce"));l=Promise.allSettled(i.map(C=>{if(C=ds(C),C in ei)return;ei[C]=!0;const q=C.endsWith(".css"),R=q?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${C}"]${R}`))return;const $=document.createElement("link");if($.rel=q?"stylesheet":ls,q||($.as="script"),$.crossOrigin="",$.href=C,E&&$.setAttribute("nonce",E),document.head.appendChild($),q)return new Promise((F,Y)=>{$.addEventListener("load",F),$.addEventListener("error",()=>Y(new Error(`Unable to preload CSS for ${C}`)))})}))}function h(m){const E=new Event("vite:preloadError",{cancelable:!0});if(E.payload=m,window.dispatchEvent(E),!E.defaultPrevented)throw m}return l.then(m=>{for(const E of m||[])E.status==="rejected"&&h(E.reason);return n().catch(h)})},fs=()=>{};var ti={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Di=function(o){const n=[];let i=0;for(let c=0;c<o.length;c++){let l=o.charCodeAt(c);l<128?n[i++]=l:l<2048?(n[i++]=l>>6|192,n[i++]=l&63|128):(l&64512)===55296&&c+1<o.length&&(o.charCodeAt(c+1)&64512)===56320?(l=65536+((l&1023)<<10)+(o.charCodeAt(++c)&1023),n[i++]=l>>18|240,n[i++]=l>>12&63|128,n[i++]=l>>6&63|128,n[i++]=l&63|128):(n[i++]=l>>12|224,n[i++]=l>>6&63|128,n[i++]=l&63|128)}return n},hs=function(o){const n=[];let i=0,c=0;for(;i<o.length;){const l=o[i++];if(l<128)n[c++]=String.fromCharCode(l);else if(l>191&&l<224){const h=o[i++];n[c++]=String.fromCharCode((l&31)<<6|h&63)}else if(l>239&&l<365){const h=o[i++],m=o[i++],E=o[i++],C=((l&7)<<18|(h&63)<<12|(m&63)<<6|E&63)-65536;n[c++]=String.fromCharCode(55296+(C>>10)),n[c++]=String.fromCharCode(56320+(C&1023))}else{const h=o[i++],m=o[i++];n[c++]=String.fromCharCode((l&15)<<12|(h&63)<<6|m&63)}}return n.join("")},Pi={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(o,n){if(!Array.isArray(o))throw Error("encodeByteArray takes an array as a parameter");this.init_();const i=n?this.byteToCharMapWebSafe_:this.byteToCharMap_,c=[];for(let l=0;l<o.length;l+=3){const h=o[l],m=l+1<o.length,E=m?o[l+1]:0,C=l+2<o.length,q=C?o[l+2]:0,R=h>>2,$=(h&3)<<4|E>>4;let F=(E&15)<<2|q>>6,Y=q&63;C||(Y=64,m||(F=64)),c.push(i[R],i[$],i[F],i[Y])}return c.join("")},encodeString(o,n){return this.HAS_NATIVE_SUPPORT&&!n?btoa(o):this.encodeByteArray(Di(o),n)},decodeString(o,n){return this.HAS_NATIVE_SUPPORT&&!n?atob(o):hs(this.decodeStringToByteArray(o,n))},decodeStringToByteArray(o,n){this.init_();const i=n?this.charToByteMapWebSafe_:this.charToByteMap_,c=[];for(let l=0;l<o.length;){const h=i[o.charAt(l++)],E=l<o.length?i[o.charAt(l)]:0;++l;const q=l<o.length?i[o.charAt(l)]:64;++l;const $=l<o.length?i[o.charAt(l)]:64;if(++l,h==null||E==null||q==null||$==null)throw new ps;const F=h<<2|E>>4;if(c.push(F),q!==64){const Y=E<<4&240|q>>2;if(c.push(Y),$!==64){const de=q<<6&192|$;c.push(de)}}}return c},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let o=0;o<this.ENCODED_VALS.length;o++)this.byteToCharMap_[o]=this.ENCODED_VALS.charAt(o),this.charToByteMap_[this.byteToCharMap_[o]]=o,this.byteToCharMapWebSafe_[o]=this.ENCODED_VALS_WEBSAFE.charAt(o),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[o]]=o,o>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(o)]=o,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(o)]=o)}}};class ps extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ms=function(o){const n=Di(o);return Pi.encodeByteArray(n,!0)},Un=function(o){return ms(o).replace(/\./g,"")},gs=function(o){try{return Pi.decodeString(o,!0)}catch(n){console.error("base64Decode failed: ",n)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ys(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vs=()=>ys().__FIREBASE_DEFAULTS__,bs=()=>{if(typeof process>"u"||typeof ti>"u")return;const o=ti.__FIREBASE_DEFAULTS__;if(o)return JSON.parse(o)},ws=()=>{if(typeof document>"u")return;let o;try{o=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const n=o&&gs(o[1]);return n&&JSON.parse(n)},Yn=()=>{try{return fs()||vs()||bs()||ws()}catch(o){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${o}`);return}},_s=o=>{var n,i;return(i=(n=Yn())===null||n===void 0?void 0:n.emulatorHosts)===null||i===void 0?void 0:i[o]},Yd=o=>{const n=_s(o);if(!n)return;const i=n.lastIndexOf(":");if(i<=0||i+1===n.length)throw new Error(`Invalid host ${n} with no separate hostname and port!`);const c=parseInt(n.substring(i+1),10);return n[0]==="["?[n.substring(1,i-1),c]:[n.substring(0,i),c]},qi=()=>{var o;return(o=Yn())===null||o===void 0?void 0:o.config},Jd=o=>{var n;return(n=Yn())===null||n===void 0?void 0:n[`_${o}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((n,i)=>{this.resolve=n,this.reject=i})}wrapCallback(n){return(i,c)=>{i?this.reject(i):this.resolve(c),typeof n=="function"&&(this.promise.catch(()=>{}),n.length===1?n(i):n(i,c))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ks(o){try{return(o.startsWith("http://")||o.startsWith("https://")?new URL(o).hostname:o).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Zd(o){return(await fetch(o,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xd(o,n){if(o.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const i={alg:"none",type:"JWT"},c=n||"demo-project",l=o.iat||0,h=o.sub||o.user_id;if(!h)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const m=Object.assign({iss:`https://securetoken.google.com/${c}`,aud:c,iat:l,exp:l+3600,auth_time:l,sub:h,user_id:h,firebase:{sign_in_provider:"custom",identities:{}}},o);return[Un(JSON.stringify(i)),Un(JSON.stringify(m)),""].join(".")}const ln={};function Es(){const o={prod:[],emulator:[]};for(const n of Object.keys(ln))ln[n]?o.emulator.push(n):o.prod.push(n);return o}function Is(o){let n=document.getElementById(o),i=!1;return n||(n=document.createElement("div"),n.setAttribute("id",o),i=!0),{created:i,element:n}}let ni=!1;function ef(o,n){if(typeof window>"u"||typeof document>"u"||!ks(window.location.host)||ln[o]===n||ln[o]||ni)return;ln[o]=n;function i(F){return`__firebase__banner__${F}`}const c="__firebase__banner",h=Es().prod.length>0;function m(){const F=document.getElementById(c);F&&F.remove()}function E(F){F.style.display="flex",F.style.background="#7faaf0",F.style.position="fixed",F.style.bottom="5px",F.style.left="5px",F.style.padding=".5em",F.style.borderRadius="5px",F.style.alignItems="center"}function C(F,Y){F.setAttribute("width","24"),F.setAttribute("id",Y),F.setAttribute("height","24"),F.setAttribute("viewBox","0 0 24 24"),F.setAttribute("fill","none"),F.style.marginLeft="-6px"}function q(){const F=document.createElement("span");return F.style.cursor="pointer",F.style.marginLeft="16px",F.style.fontSize="24px",F.innerHTML=" &times;",F.onclick=()=>{ni=!0,m()},F}function R(F,Y){F.setAttribute("id",Y),F.innerText="Learn more",F.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",F.setAttribute("target","__blank"),F.style.paddingLeft="5px",F.style.textDecoration="underline"}function $(){const F=Is(c),Y=i("text"),de=document.getElementById(Y)||document.createElement("span"),_e=i("learnmore"),ve=document.getElementById(_e)||document.createElement("a"),Re=i("preprendIcon"),be=document.getElementById(Re)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(F.created){const U=F.element;E(U),R(ve,_e);const X=q();C(be,Re),U.append(be,de,ve,X),document.body.appendChild(U)}h?(de.innerText="Preview backend disconnected.",be.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(be.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,de.innerText="Preview backend running in this workspace."),de.setAttribute("id",Y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",$):$()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mi(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function tf(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Mi())}function Bi(){var o;const n=(o=Yn())===null||o===void 0?void 0:o.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function nf(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function As(){const o=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof o=="object"&&o.id!==void 0}function rf(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function of(){const o=Mi();return o.indexOf("MSIE ")>=0||o.indexOf("Trident/")>=0}function af(){return!Bi()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function sf(){return!Bi()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function Ri(){try{return typeof indexedDB=="object"}catch{return!1}}function ji(){return new Promise((o,n)=>{try{let i=!0;const c="validate-browser-context-for-indexeddb-analytics-module",l=self.indexedDB.open(c);l.onsuccess=()=>{l.result.close(),i||self.indexedDB.deleteDatabase(c),o(!0)},l.onupgradeneeded=()=>{i=!1},l.onerror=()=>{var h;n(((h=l.error)===null||h===void 0?void 0:h.message)||"")}}catch(i){n(i)}})}function Ss(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cs="FirebaseError";class qt extends Error{constructor(n,i,c){super(i),this.code=n,this.customData=c,this.name=Cs,Object.setPrototypeOf(this,qt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Jn.prototype.create)}}class Jn{constructor(n,i,c){this.service=n,this.serviceName=i,this.errors=c}create(n,...i){const c=i[0]||{},l=`${this.service}/${n}`,h=this.errors[n],m=h?Os(h,c):"Error",E=`${this.serviceName}: ${m} (${l}).`;return new qt(l,E,c)}}function Os(o,n){return o.replace(Ts,(i,c)=>{const l=n[c];return l!=null?String(l):`<${c}?>`})}const Ts=/\{\$([^}]+)}/g;function cf(o){for(const n in o)if(Object.prototype.hasOwnProperty.call(o,n))return!1;return!0}function Hn(o,n){if(o===n)return!0;const i=Object.keys(o),c=Object.keys(n);for(const l of i){if(!c.includes(l))return!1;const h=o[l],m=n[l];if(ri(h)&&ri(m)){if(!Hn(h,m))return!1}else if(h!==m)return!1}for(const l of c)if(!i.includes(l))return!1;return!0}function ri(o){return o!==null&&typeof o=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uf(o){const n=[];for(const[i,c]of Object.entries(o))Array.isArray(c)?c.forEach(l=>{n.push(encodeURIComponent(i)+"="+encodeURIComponent(l))}):n.push(encodeURIComponent(i)+"="+encodeURIComponent(c));return n.length?"&"+n.join("&"):""}function lf(o,n){const i=new Ds(o,n);return i.subscribe.bind(i)}class Ds{constructor(n,i){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=i,this.task.then(()=>{n(this)}).catch(c=>{this.error(c)})}next(n){this.forEachObserver(i=>{i.next(n)})}error(n){this.forEachObserver(i=>{i.error(n)}),this.close(n)}complete(){this.forEachObserver(n=>{n.complete()}),this.close()}subscribe(n,i,c){let l;if(n===void 0&&i===void 0&&c===void 0)throw new Error("Missing Observer.");Ps(n,["next","error","complete"])?l=n:l={next:n,error:i,complete:c},l.next===void 0&&(l.next=$r),l.error===void 0&&(l.error=$r),l.complete===void 0&&(l.complete=$r);const h=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?l.error(this.finalError):l.complete()}catch{}}),this.observers.push(l),h}unsubscribeOne(n){this.observers===void 0||this.observers[n]===void 0||(delete this.observers[n],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(n){if(!this.finalized)for(let i=0;i<this.observers.length;i++)this.sendOne(i,n)}sendOne(n,i){this.task.then(()=>{if(this.observers!==void 0&&this.observers[n]!==void 0)try{i(this.observers[n])}catch(c){typeof console<"u"&&console.error&&console.error(c)}})}close(n){this.finalized||(this.finalized=!0,n!==void 0&&(this.finalError=n),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Ps(o,n){if(typeof o!="object"||o===null)return!1;for(const i of n)if(i in o&&typeof o[i]=="function")return!0;return!1}function $r(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qs=1e3,Ms=2,Bs=4*60*60*1e3,Rs=.5;function oi(o,n=qs,i=Ms){const c=n*Math.pow(i,o),l=Math.round(Rs*c*(Math.random()-.5)*2);return Math.min(Bs,c+l)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hn(o){return o&&o._delegate?o._delegate:o}class pt{constructor(n,i,c){this.name=n,this.instanceFactory=i,this.type=c,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(n){return this.instantiationMode=n,this}setMultipleInstances(n){return this.multipleInstances=n,this}setServiceProps(n){return this.serviceProps=n,this}setInstanceCreatedCallback(n){return this.onInstanceCreated=n,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const St="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class js{constructor(n,i){this.name=n,this.container=i,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(n){const i=this.normalizeInstanceIdentifier(n);if(!this.instancesDeferred.has(i)){const c=new xs;if(this.instancesDeferred.set(i,c),this.isInitialized(i)||this.shouldAutoInitialize())try{const l=this.getOrInitializeService({instanceIdentifier:i});l&&c.resolve(l)}catch{}}return this.instancesDeferred.get(i).promise}getImmediate(n){var i;const c=this.normalizeInstanceIdentifier(n==null?void 0:n.identifier),l=(i=n==null?void 0:n.optional)!==null&&i!==void 0?i:!1;if(this.isInitialized(c)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:c})}catch(h){if(l)return null;throw h}else{if(l)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(n){if(n.name!==this.name)throw Error(`Mismatching Component ${n.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=n,!!this.shouldAutoInitialize()){if(Fs(n))try{this.getOrInitializeService({instanceIdentifier:St})}catch{}for(const[i,c]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);try{const h=this.getOrInitializeService({instanceIdentifier:l});c.resolve(h)}catch{}}}}clearInstance(n=St){this.instancesDeferred.delete(n),this.instancesOptions.delete(n),this.instances.delete(n)}async delete(){const n=Array.from(this.instances.values());await Promise.all([...n.filter(i=>"INTERNAL"in i).map(i=>i.INTERNAL.delete()),...n.filter(i=>"_delete"in i).map(i=>i._delete())])}isComponentSet(){return this.component!=null}isInitialized(n=St){return this.instances.has(n)}getOptions(n=St){return this.instancesOptions.get(n)||{}}initialize(n={}){const{options:i={}}=n,c=this.normalizeInstanceIdentifier(n.instanceIdentifier);if(this.isInitialized(c))throw Error(`${this.name}(${c}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const l=this.getOrInitializeService({instanceIdentifier:c,options:i});for(const[h,m]of this.instancesDeferred.entries()){const E=this.normalizeInstanceIdentifier(h);c===E&&m.resolve(l)}return l}onInit(n,i){var c;const l=this.normalizeInstanceIdentifier(i),h=(c=this.onInitCallbacks.get(l))!==null&&c!==void 0?c:new Set;h.add(n),this.onInitCallbacks.set(l,h);const m=this.instances.get(l);return m&&n(m,l),()=>{h.delete(n)}}invokeOnInitCallbacks(n,i){const c=this.onInitCallbacks.get(i);if(c)for(const l of c)try{l(n,i)}catch{}}getOrInitializeService({instanceIdentifier:n,options:i={}}){let c=this.instances.get(n);if(!c&&this.component&&(c=this.component.instanceFactory(this.container,{instanceIdentifier:zs(n),options:i}),this.instances.set(n,c),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(c,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,c)}catch{}return c||null}normalizeInstanceIdentifier(n=St){return this.component?this.component.multipleInstances?n:St:n}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function zs(o){return o===St?void 0:o}function Fs(o){return o.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s{constructor(n){this.name=n,this.providers=new Map}addComponent(n){const i=this.getProvider(n.name);if(i.isComponentSet())throw new Error(`Component ${n.name} has already been registered with ${this.name}`);i.setComponent(n)}addOrOverwriteComponent(n){this.getProvider(n.name).isComponentSet()&&this.providers.delete(n.name),this.addComponent(n)}getProvider(n){if(this.providers.has(n))return this.providers.get(n);const i=new js(n,this);return this.providers.set(n,i),i}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fe;(function(o){o[o.DEBUG=0]="DEBUG",o[o.VERBOSE=1]="VERBOSE",o[o.INFO=2]="INFO",o[o.WARN=3]="WARN",o[o.ERROR=4]="ERROR",o[o.SILENT=5]="SILENT"})(fe||(fe={}));const Ns={debug:fe.DEBUG,verbose:fe.VERBOSE,info:fe.INFO,warn:fe.WARN,error:fe.ERROR,silent:fe.SILENT},Ls=fe.INFO,Ks={[fe.DEBUG]:"log",[fe.VERBOSE]:"log",[fe.INFO]:"info",[fe.WARN]:"warn",[fe.ERROR]:"error"},Vs=(o,n,...i)=>{if(n<o.logLevel)return;const c=new Date().toISOString(),l=Ks[n];if(l)console[l](`[${c}]  ${o.name}:`,...i);else throw new Error(`Attempted to log a message with an invalid logType (value: ${n})`)};class zi{constructor(n){this.name=n,this._logLevel=Ls,this._logHandler=Vs,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(n){if(!(n in fe))throw new TypeError(`Invalid value "${n}" assigned to \`logLevel\``);this._logLevel=n}setLogLevel(n){this._logLevel=typeof n=="string"?Ns[n]:n}get logHandler(){return this._logHandler}set logHandler(n){if(typeof n!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=n}get userLogHandler(){return this._userLogHandler}set userLogHandler(n){this._userLogHandler=n}debug(...n){this._userLogHandler&&this._userLogHandler(this,fe.DEBUG,...n),this._logHandler(this,fe.DEBUG,...n)}log(...n){this._userLogHandler&&this._userLogHandler(this,fe.VERBOSE,...n),this._logHandler(this,fe.VERBOSE,...n)}info(...n){this._userLogHandler&&this._userLogHandler(this,fe.INFO,...n),this._logHandler(this,fe.INFO,...n)}warn(...n){this._userLogHandler&&this._userLogHandler(this,fe.WARN,...n),this._logHandler(this,fe.WARN,...n)}error(...n){this._userLogHandler&&this._userLogHandler(this,fe.ERROR,...n),this._logHandler(this,fe.ERROR,...n)}}const Us=(o,n)=>n.some(i=>o instanceof i);let ii,ai;function Hs(){return ii||(ii=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Qs(){return ai||(ai=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Fi=new WeakMap,Gr=new WeakMap,$i=new WeakMap,Nr=new WeakMap,io=new WeakMap;function Ws(o){const n=new Promise((i,c)=>{const l=()=>{o.removeEventListener("success",h),o.removeEventListener("error",m)},h=()=>{i(lt(o.result)),l()},m=()=>{c(o.error),l()};o.addEventListener("success",h),o.addEventListener("error",m)});return n.then(i=>{i instanceof IDBCursor&&Fi.set(i,o)}).catch(()=>{}),io.set(n,o),n}function Gs(o){if(Gr.has(o))return;const n=new Promise((i,c)=>{const l=()=>{o.removeEventListener("complete",h),o.removeEventListener("error",m),o.removeEventListener("abort",m)},h=()=>{i(),l()},m=()=>{c(o.error||new DOMException("AbortError","AbortError")),l()};o.addEventListener("complete",h),o.addEventListener("error",m),o.addEventListener("abort",m)});Gr.set(o,n)}let Yr={get(o,n,i){if(o instanceof IDBTransaction){if(n==="done")return Gr.get(o);if(n==="objectStoreNames")return o.objectStoreNames||$i.get(o);if(n==="store")return i.objectStoreNames[1]?void 0:i.objectStore(i.objectStoreNames[0])}return lt(o[n])},set(o,n,i){return o[n]=i,!0},has(o,n){return o instanceof IDBTransaction&&(n==="done"||n==="store")?!0:n in o}};function Ys(o){Yr=o(Yr)}function Js(o){return o===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(n,...i){const c=o.call(Lr(this),n,...i);return $i.set(c,n.sort?n.sort():[n]),lt(c)}:Qs().includes(o)?function(...n){return o.apply(Lr(this),n),lt(Fi.get(this))}:function(...n){return lt(o.apply(Lr(this),n))}}function Zs(o){return typeof o=="function"?Js(o):(o instanceof IDBTransaction&&Gs(o),Us(o,Hs())?new Proxy(o,Yr):o)}function lt(o){if(o instanceof IDBRequest)return Ws(o);if(Nr.has(o))return Nr.get(o);const n=Zs(o);return n!==o&&(Nr.set(o,n),io.set(n,o)),n}const Lr=o=>io.get(o);function Ni(o,n,{blocked:i,upgrade:c,blocking:l,terminated:h}={}){const m=indexedDB.open(o,n),E=lt(m);return c&&m.addEventListener("upgradeneeded",C=>{c(lt(m.result),C.oldVersion,C.newVersion,lt(m.transaction),C)}),i&&m.addEventListener("blocked",C=>i(C.oldVersion,C.newVersion,C)),E.then(C=>{h&&C.addEventListener("close",()=>h()),l&&C.addEventListener("versionchange",q=>l(q.oldVersion,q.newVersion,q))}).catch(()=>{}),E}const Xs=["get","getKey","getAll","getAllKeys","count"],ec=["put","add","delete","clear"],Kr=new Map;function si(o,n){if(!(o instanceof IDBDatabase&&!(n in o)&&typeof n=="string"))return;if(Kr.get(n))return Kr.get(n);const i=n.replace(/FromIndex$/,""),c=n!==i,l=ec.includes(i);if(!(i in(c?IDBIndex:IDBObjectStore).prototype)||!(l||Xs.includes(i)))return;const h=async function(m,...E){const C=this.transaction(m,l?"readwrite":"readonly");let q=C.store;return c&&(q=q.index(E.shift())),(await Promise.all([q[i](...E),l&&C.done]))[0]};return Kr.set(n,h),h}Ys(o=>({...o,get:(n,i,c)=>si(n,i)||o.get(n,i,c),has:(n,i)=>!!si(n,i)||o.has(n,i)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc{constructor(n){this.container=n}getPlatformInfoString(){return this.container.getProviders().map(i=>{if(nc(i)){const c=i.getImmediate();return`${c.library}/${c.version}`}else return null}).filter(i=>i).join(" ")}}function nc(o){const n=o.getComponent();return(n==null?void 0:n.type)==="VERSION"}const Jr="@firebase/app",ci="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tt=new zi("@firebase/app"),rc="@firebase/app-compat",oc="@firebase/analytics-compat",ic="@firebase/analytics",ac="@firebase/app-check-compat",sc="@firebase/app-check",cc="@firebase/auth",uc="@firebase/auth-compat",lc="@firebase/database",dc="@firebase/data-connect",fc="@firebase/database-compat",hc="@firebase/functions",pc="@firebase/functions-compat",mc="@firebase/installations",gc="@firebase/installations-compat",yc="@firebase/messaging",vc="@firebase/messaging-compat",bc="@firebase/performance",wc="@firebase/performance-compat",_c="@firebase/remote-config",xc="@firebase/remote-config-compat",kc="@firebase/storage",Ec="@firebase/storage-compat",Ic="@firebase/firestore",Ac="@firebase/ai",Sc="@firebase/firestore-compat",Cc="firebase",Oc="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zr="[DEFAULT]",Tc={[Jr]:"fire-core",[rc]:"fire-core-compat",[ic]:"fire-analytics",[oc]:"fire-analytics-compat",[sc]:"fire-app-check",[ac]:"fire-app-check-compat",[cc]:"fire-auth",[uc]:"fire-auth-compat",[lc]:"fire-rtdb",[dc]:"fire-data-connect",[fc]:"fire-rtdb-compat",[hc]:"fire-fn",[pc]:"fire-fn-compat",[mc]:"fire-iid",[gc]:"fire-iid-compat",[yc]:"fire-fcm",[vc]:"fire-fcm-compat",[bc]:"fire-perf",[wc]:"fire-perf-compat",[_c]:"fire-rc",[xc]:"fire-rc-compat",[kc]:"fire-gcs",[Ec]:"fire-gcs-compat",[Ic]:"fire-fst",[Sc]:"fire-fst-compat",[Ac]:"fire-vertex","fire-js":"fire-js",[Cc]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dn=new Map,Dc=new Map,Xr=new Map;function ui(o,n){try{o.container.addComponent(n)}catch(i){tt.debug(`Component ${n.name} failed to register with FirebaseApp ${o.name}`,i)}}function Tt(o){const n=o.name;if(Xr.has(n))return tt.debug(`There were multiple attempts to register component ${n}.`),!1;Xr.set(n,o);for(const i of dn.values())ui(i,o);for(const i of Dc.values())ui(i,o);return!0}function Zn(o,n){const i=o.container.getProvider("heartbeat").getImmediate({optional:!0});return i&&i.triggerHeartbeat(),o.container.getProvider(n)}function df(o){return o==null?!1:o.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pc={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},dt=new Jn("app","Firebase",Pc);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc{constructor(n,i,c){this._isDeleted=!1,this._options=Object.assign({},n),this._config=Object.assign({},i),this._name=i.name,this._automaticDataCollectionEnabled=i.automaticDataCollectionEnabled,this._container=c,this.container.addComponent(new pt("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(n){this.checkDestroyed(),this._automaticDataCollectionEnabled=n}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(n){this._isDeleted=n}checkDestroyed(){if(this.isDeleted)throw dt.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ff=Oc;function Li(o,n={}){let i=o;typeof n!="object"&&(n={name:n});const c=Object.assign({name:Zr,automaticDataCollectionEnabled:!0},n),l=c.name;if(typeof l!="string"||!l)throw dt.create("bad-app-name",{appName:String(l)});if(i||(i=qi()),!i)throw dt.create("no-options");const h=dn.get(l);if(h){if(Hn(i,h.options)&&Hn(c,h.config))return h;throw dt.create("duplicate-app",{appName:l})}const m=new $s(l);for(const C of Xr.values())m.addComponent(C);const E=new qc(i,c,m);return dn.set(l,E),E}function Ki(o=Zr){const n=dn.get(o);if(!n&&o===Zr&&qi())return Li();if(!n)throw dt.create("no-app",{appName:o});return n}function Mc(){return Array.from(dn.values())}function ft(o,n,i){var c;let l=(c=Tc[o])!==null&&c!==void 0?c:o;i&&(l+=`-${i}`);const h=l.match(/\s|\//),m=n.match(/\s|\//);if(h||m){const E=[`Unable to register library "${l}" with version "${n}":`];h&&E.push(`library name "${l}" contains illegal characters (whitespace or "/")`),h&&m&&E.push("and"),m&&E.push(`version name "${n}" contains illegal characters (whitespace or "/")`),tt.warn(E.join(" "));return}Tt(new pt(`${l}-version`,()=>({library:l,version:n}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bc="firebase-heartbeat-database",Rc=1,fn="firebase-heartbeat-store";let Vr=null;function Vi(){return Vr||(Vr=Ni(Bc,Rc,{upgrade:(o,n)=>{switch(n){case 0:try{o.createObjectStore(fn)}catch(i){console.warn(i)}}}}).catch(o=>{throw dt.create("idb-open",{originalErrorMessage:o.message})})),Vr}async function jc(o){try{const i=(await Vi()).transaction(fn),c=await i.objectStore(fn).get(Ui(o));return await i.done,c}catch(n){if(n instanceof qt)tt.warn(n.message);else{const i=dt.create("idb-get",{originalErrorMessage:n==null?void 0:n.message});tt.warn(i.message)}}}async function li(o,n){try{const c=(await Vi()).transaction(fn,"readwrite");await c.objectStore(fn).put(n,Ui(o)),await c.done}catch(i){if(i instanceof qt)tt.warn(i.message);else{const c=dt.create("idb-set",{originalErrorMessage:i==null?void 0:i.message});tt.warn(c.message)}}}function Ui(o){return`${o.name}!${o.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zc=1024,Fc=30;class $c{constructor(n){this.container=n,this._heartbeatsCache=null;const i=this.container.getProvider("app").getImmediate();this._storage=new Lc(i),this._heartbeatsCachePromise=this._storage.read().then(c=>(this._heartbeatsCache=c,c))}async triggerHeartbeat(){var n,i;try{const l=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),h=di();if(((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((i=this._heartbeatsCache)===null||i===void 0?void 0:i.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===h||this._heartbeatsCache.heartbeats.some(m=>m.date===h))return;if(this._heartbeatsCache.heartbeats.push({date:h,agent:l}),this._heartbeatsCache.heartbeats.length>Fc){const m=Kc(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(m,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(c){tt.warn(c)}}async getHeartbeatsHeader(){var n;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const i=di(),{heartbeatsToSend:c,unsentEntries:l}=Nc(this._heartbeatsCache.heartbeats),h=Un(JSON.stringify({version:2,heartbeats:c}));return this._heartbeatsCache.lastSentHeartbeatDate=i,l.length>0?(this._heartbeatsCache.heartbeats=l,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),h}catch(i){return tt.warn(i),""}}}function di(){return new Date().toISOString().substring(0,10)}function Nc(o,n=zc){const i=[];let c=o.slice();for(const l of o){const h=i.find(m=>m.agent===l.agent);if(h){if(h.dates.push(l.date),fi(i)>n){h.dates.pop();break}}else if(i.push({agent:l.agent,dates:[l.date]}),fi(i)>n){i.pop();break}c=c.slice(1)}return{heartbeatsToSend:i,unsentEntries:c}}class Lc{constructor(n){this.app=n,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Ri()?ji().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const i=await jc(this.app);return i!=null&&i.heartbeats?i:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(n){var i;if(await this._canUseIndexedDBPromise){const l=await this.read();return li(this.app,{lastSentHeartbeatDate:(i=n.lastSentHeartbeatDate)!==null&&i!==void 0?i:l.lastSentHeartbeatDate,heartbeats:n.heartbeats})}else return}async add(n){var i;if(await this._canUseIndexedDBPromise){const l=await this.read();return li(this.app,{lastSentHeartbeatDate:(i=n.lastSentHeartbeatDate)!==null&&i!==void 0?i:l.lastSentHeartbeatDate,heartbeats:[...l.heartbeats,...n.heartbeats]})}else return}}function fi(o){return Un(JSON.stringify({version:2,heartbeats:o})).length}function Kc(o){if(o.length===0)return-1;let n=0,i=o[0].date;for(let c=1;c<o.length;c++)o[c].date<i&&(i=o[c].date,n=c);return n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vc(o){Tt(new pt("platform-logger",n=>new tc(n),"PRIVATE")),Tt(new pt("heartbeat",n=>new $c(n),"PRIVATE")),ft(Jr,ci,o),ft(Jr,ci,"esm2017"),ft("fire-js","")}Vc("");var Uc="firebase",Hc="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ft(Uc,Hc,"app");const Hi="@firebase/installations",ao="0.6.18";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qi=1e4,Wi=`w:${ao}`,Gi="FIS_v2",Qc="https://firebaseinstallations.googleapis.com/v1",Wc=60*60*1e3,Gc="installations",Yc="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jc={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Dt=new Jn(Gc,Yc,Jc);function Yi(o){return o instanceof qt&&o.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ji({projectId:o}){return`${Qc}/projects/${o}/installations`}function Zi(o){return{token:o.token,requestStatus:2,expiresIn:Xc(o.expiresIn),creationTime:Date.now()}}async function Xi(o,n){const c=(await n.json()).error;return Dt.create("request-failed",{requestName:o,serverCode:c.code,serverMessage:c.message,serverStatus:c.status})}function ea({apiKey:o}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":o})}function Zc(o,{refreshToken:n}){const i=ea(o);return i.append("Authorization",eu(n)),i}async function ta(o){const n=await o();return n.status>=500&&n.status<600?o():n}function Xc(o){return Number(o.replace("s","000"))}function eu(o){return`${Gi} ${o}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tu({appConfig:o,heartbeatServiceProvider:n},{fid:i}){const c=Ji(o),l=ea(o),h=n.getImmediate({optional:!0});if(h){const q=await h.getHeartbeatsHeader();q&&l.append("x-firebase-client",q)}const m={fid:i,authVersion:Gi,appId:o.appId,sdkVersion:Wi},E={method:"POST",headers:l,body:JSON.stringify(m)},C=await ta(()=>fetch(c,E));if(C.ok){const q=await C.json();return{fid:q.fid||i,registrationStatus:2,refreshToken:q.refreshToken,authToken:Zi(q.authToken)}}else throw await Xi("Create Installation",C)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function na(o){return new Promise(n=>{setTimeout(n,o)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nu(o){return btoa(String.fromCharCode(...o)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ru=/^[cdef][\w-]{21}$/,eo="";function ou(){try{const o=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(o),o[0]=112+o[0]%16;const i=iu(o);return ru.test(i)?i:eo}catch{return eo}}function iu(o){return nu(o).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xn(o){return`${o.appName}!${o.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ra=new Map;function oa(o,n){const i=Xn(o);ia(i,n),au(i,n)}function ia(o,n){const i=ra.get(o);if(i)for(const c of i)c(n)}function au(o,n){const i=su();i&&i.postMessage({key:o,fid:n}),cu()}let Ct=null;function su(){return!Ct&&"BroadcastChannel"in self&&(Ct=new BroadcastChannel("[Firebase] FID Change"),Ct.onmessage=o=>{ia(o.data.key,o.data.fid)}),Ct}function cu(){ra.size===0&&Ct&&(Ct.close(),Ct=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uu="firebase-installations-database",lu=1,Pt="firebase-installations-store";let Ur=null;function so(){return Ur||(Ur=Ni(uu,lu,{upgrade:(o,n)=>{switch(n){case 0:o.createObjectStore(Pt)}}})),Ur}async function Qn(o,n){const i=Xn(o),l=(await so()).transaction(Pt,"readwrite"),h=l.objectStore(Pt),m=await h.get(i);return await h.put(n,i),await l.done,(!m||m.fid!==n.fid)&&oa(o,n.fid),n}async function aa(o){const n=Xn(o),c=(await so()).transaction(Pt,"readwrite");await c.objectStore(Pt).delete(n),await c.done}async function er(o,n){const i=Xn(o),l=(await so()).transaction(Pt,"readwrite"),h=l.objectStore(Pt),m=await h.get(i),E=n(m);return E===void 0?await h.delete(i):await h.put(E,i),await l.done,E&&(!m||m.fid!==E.fid)&&oa(o,E.fid),E}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function co(o){let n;const i=await er(o.appConfig,c=>{const l=du(c),h=fu(o,l);return n=h.registrationPromise,h.installationEntry});return i.fid===eo?{installationEntry:await n}:{installationEntry:i,registrationPromise:n}}function du(o){const n=o||{fid:ou(),registrationStatus:0};return sa(n)}function fu(o,n){if(n.registrationStatus===0){if(!navigator.onLine){const l=Promise.reject(Dt.create("app-offline"));return{installationEntry:n,registrationPromise:l}}const i={fid:n.fid,registrationStatus:1,registrationTime:Date.now()},c=hu(o,i);return{installationEntry:i,registrationPromise:c}}else return n.registrationStatus===1?{installationEntry:n,registrationPromise:pu(o)}:{installationEntry:n}}async function hu(o,n){try{const i=await tu(o,n);return Qn(o.appConfig,i)}catch(i){throw Yi(i)&&i.customData.serverCode===409?await aa(o.appConfig):await Qn(o.appConfig,{fid:n.fid,registrationStatus:0}),i}}async function pu(o){let n=await hi(o.appConfig);for(;n.registrationStatus===1;)await na(100),n=await hi(o.appConfig);if(n.registrationStatus===0){const{installationEntry:i,registrationPromise:c}=await co(o);return c||i}return n}function hi(o){return er(o,n=>{if(!n)throw Dt.create("installation-not-found");return sa(n)})}function sa(o){return mu(o)?{fid:o.fid,registrationStatus:0}:o}function mu(o){return o.registrationStatus===1&&o.registrationTime+Qi<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gu({appConfig:o,heartbeatServiceProvider:n},i){const c=yu(o,i),l=Zc(o,i),h=n.getImmediate({optional:!0});if(h){const q=await h.getHeartbeatsHeader();q&&l.append("x-firebase-client",q)}const m={installation:{sdkVersion:Wi,appId:o.appId}},E={method:"POST",headers:l,body:JSON.stringify(m)},C=await ta(()=>fetch(c,E));if(C.ok){const q=await C.json();return Zi(q)}else throw await Xi("Generate Auth Token",C)}function yu(o,{fid:n}){return`${Ji(o)}/${n}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uo(o,n=!1){let i;const c=await er(o.appConfig,h=>{if(!ca(h))throw Dt.create("not-registered");const m=h.authToken;if(!n&&wu(m))return h;if(m.requestStatus===1)return i=vu(o,n),h;{if(!navigator.onLine)throw Dt.create("app-offline");const E=xu(h);return i=bu(o,E),E}});return i?await i:c.authToken}async function vu(o,n){let i=await pi(o.appConfig);for(;i.authToken.requestStatus===1;)await na(100),i=await pi(o.appConfig);const c=i.authToken;return c.requestStatus===0?uo(o,n):c}function pi(o){return er(o,n=>{if(!ca(n))throw Dt.create("not-registered");const i=n.authToken;return ku(i)?Object.assign(Object.assign({},n),{authToken:{requestStatus:0}}):n})}async function bu(o,n){try{const i=await gu(o,n),c=Object.assign(Object.assign({},n),{authToken:i});return await Qn(o.appConfig,c),i}catch(i){if(Yi(i)&&(i.customData.serverCode===401||i.customData.serverCode===404))await aa(o.appConfig);else{const c=Object.assign(Object.assign({},n),{authToken:{requestStatus:0}});await Qn(o.appConfig,c)}throw i}}function ca(o){return o!==void 0&&o.registrationStatus===2}function wu(o){return o.requestStatus===2&&!_u(o)}function _u(o){const n=Date.now();return n<o.creationTime||o.creationTime+o.expiresIn<n+Wc}function xu(o){const n={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},o),{authToken:n})}function ku(o){return o.requestStatus===1&&o.requestTime+Qi<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Eu(o){const n=o,{installationEntry:i,registrationPromise:c}=await co(n);return c?c.catch(console.error):uo(n).catch(console.error),i.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Iu(o,n=!1){const i=o;return await Au(i),(await uo(i,n)).token}async function Au(o){const{registrationPromise:n}=await co(o);n&&await n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Su(o){if(!o||!o.options)throw Hr("App Configuration");if(!o.name)throw Hr("App Name");const n=["projectId","apiKey","appId"];for(const i of n)if(!o.options[i])throw Hr(i);return{appName:o.name,projectId:o.options.projectId,apiKey:o.options.apiKey,appId:o.options.appId}}function Hr(o){return Dt.create("missing-app-config-values",{valueName:o})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ua="installations",Cu="installations-internal",Ou=o=>{const n=o.getProvider("app").getImmediate(),i=Su(n),c=Zn(n,"heartbeat");return{app:n,appConfig:i,heartbeatServiceProvider:c,_delete:()=>Promise.resolve()}},Tu=o=>{const n=o.getProvider("app").getImmediate(),i=Zn(n,ua).getImmediate();return{getId:()=>Eu(i),getToken:l=>Iu(i,l)}};function Du(){Tt(new pt(ua,Ou,"PUBLIC")),Tt(new pt(Cu,Tu,"PRIVATE"))}Du();ft(Hi,ao);ft(Hi,ao,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wn="analytics",Pu="firebase_id",qu="origin",Mu=60*1e3,Bu="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",lo="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Se=new zi("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ru={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},$e=new Jn("analytics","Analytics",Ru);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ju(o){if(!o.startsWith(lo)){const n=$e.create("invalid-gtag-resource",{gtagURL:o});return Se.warn(n.message),""}return o}function la(o){return Promise.all(o.map(n=>n.catch(i=>i)))}function zu(o,n){let i;return window.trustedTypes&&(i=window.trustedTypes.createPolicy(o,n)),i}function Fu(o,n){const i=zu("firebase-js-sdk-policy",{createScriptURL:ju}),c=document.createElement("script"),l=`${lo}?l=${o}&id=${n}`;c.src=i?i==null?void 0:i.createScriptURL(l):l,c.async=!0,document.head.appendChild(c)}function $u(o){let n=[];return Array.isArray(window[o])?n=window[o]:window[o]=n,n}async function Nu(o,n,i,c,l,h){const m=c[l];try{if(m)await n[m];else{const C=(await la(i)).find(q=>q.measurementId===l);C&&await n[C.appId]}}catch(E){Se.error(E)}o("config",l,h)}async function Lu(o,n,i,c,l){try{let h=[];if(l&&l.send_to){let m=l.send_to;Array.isArray(m)||(m=[m]);const E=await la(i);for(const C of m){const q=E.find($=>$.measurementId===C),R=q&&n[q.appId];if(R)h.push(R);else{h=[];break}}}h.length===0&&(h=Object.values(n)),await Promise.all(h),o("event",c,l||{})}catch(h){Se.error(h)}}function Ku(o,n,i,c){async function l(h,...m){try{if(h==="event"){const[E,C]=m;await Lu(o,n,i,E,C)}else if(h==="config"){const[E,C]=m;await Nu(o,n,i,c,E,C)}else if(h==="consent"){const[E,C]=m;o("consent",E,C)}else if(h==="get"){const[E,C,q]=m;o("get",E,C,q)}else if(h==="set"){const[E]=m;o("set",E)}else o(h,...m)}catch(E){Se.error(E)}}return l}function Vu(o,n,i,c,l){let h=function(...m){window[c].push(arguments)};return window[l]&&typeof window[l]=="function"&&(h=window[l]),window[l]=Ku(h,o,n,i),{gtagCore:h,wrappedGtag:window[l]}}function Uu(o){const n=window.document.getElementsByTagName("script");for(const i of Object.values(n))if(i.src&&i.src.includes(lo)&&i.src.includes(o))return i;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hu=30,Qu=1e3;class Wu{constructor(n={},i=Qu){this.throttleMetadata=n,this.intervalMillis=i}getThrottleMetadata(n){return this.throttleMetadata[n]}setThrottleMetadata(n,i){this.throttleMetadata[n]=i}deleteThrottleMetadata(n){delete this.throttleMetadata[n]}}const da=new Wu;function Gu(o){return new Headers({Accept:"application/json","x-goog-api-key":o})}async function Yu(o){var n;const{appId:i,apiKey:c}=o,l={method:"GET",headers:Gu(c)},h=Bu.replace("{app-id}",i),m=await fetch(h,l);if(m.status!==200&&m.status!==304){let E="";try{const C=await m.json();!((n=C.error)===null||n===void 0)&&n.message&&(E=C.error.message)}catch{}throw $e.create("config-fetch-failed",{httpStatus:m.status,responseMessage:E})}return m.json()}async function Ju(o,n=da,i){const{appId:c,apiKey:l,measurementId:h}=o.options;if(!c)throw $e.create("no-app-id");if(!l){if(h)return{measurementId:h,appId:c};throw $e.create("no-api-key")}const m=n.getThrottleMetadata(c)||{backoffCount:0,throttleEndTimeMillis:Date.now()},E=new el;return setTimeout(async()=>{E.abort()},Mu),fa({appId:c,apiKey:l,measurementId:h},m,E,n)}async function fa(o,{throttleEndTimeMillis:n,backoffCount:i},c,l=da){var h;const{appId:m,measurementId:E}=o;try{await Zu(c,n)}catch(C){if(E)return Se.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${E} provided in the "measurementId" field in the local Firebase config. [${C==null?void 0:C.message}]`),{appId:m,measurementId:E};throw C}try{const C=await Yu(o);return l.deleteThrottleMetadata(m),C}catch(C){const q=C;if(!Xu(q)){if(l.deleteThrottleMetadata(m),E)return Se.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${E} provided in the "measurementId" field in the local Firebase config. [${q==null?void 0:q.message}]`),{appId:m,measurementId:E};throw C}const R=Number((h=q==null?void 0:q.customData)===null||h===void 0?void 0:h.httpStatus)===503?oi(i,l.intervalMillis,Hu):oi(i,l.intervalMillis),$={throttleEndTimeMillis:Date.now()+R,backoffCount:i+1};return l.setThrottleMetadata(m,$),Se.debug(`Calling attemptFetch again in ${R} millis`),fa(o,$,c,l)}}function Zu(o,n){return new Promise((i,c)=>{const l=Math.max(n-Date.now(),0),h=setTimeout(i,l);o.addEventListener(()=>{clearTimeout(h),c($e.create("fetch-throttle",{throttleEndTimeMillis:n}))})})}function Xu(o){if(!(o instanceof qt)||!o.customData)return!1;const n=Number(o.customData.httpStatus);return n===429||n===500||n===503||n===504}class el{constructor(){this.listeners=[]}addEventListener(n){this.listeners.push(n)}abort(){this.listeners.forEach(n=>n())}}async function tl(o,n,i,c,l){if(l&&l.global){o("event",i,c);return}else{const h=await n,m=Object.assign(Object.assign({},c),{send_to:h});o("event",i,m)}}async function nl(o,n,i,c){{const l=await n;o("config",l,{update:!0,user_id:i})}}async function rl(o,n,i,c){{const l=await n;o("config",l,{update:!0,user_properties:i})}}async function ol(o,n){const i=await o;window[`ga-disable-${i}`]=!n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function il(){if(Ri())try{await ji()}catch(o){return Se.warn($e.create("indexeddb-unavailable",{errorInfo:o==null?void 0:o.toString()}).message),!1}else return Se.warn($e.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function al(o,n,i,c,l,h,m){var E;const C=Ju(o);C.then(Y=>{i[Y.measurementId]=Y.appId,o.options.measurementId&&Y.measurementId!==o.options.measurementId&&Se.warn(`The measurement ID in the local Firebase config (${o.options.measurementId}) does not match the measurement ID fetched from the server (${Y.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(Y=>Se.error(Y)),n.push(C);const q=il().then(Y=>{if(Y)return c.getId()}),[R,$]=await Promise.all([C,q]);Uu(h)||Fu(h,R.measurementId),l("js",new Date);const F=(E=m==null?void 0:m.config)!==null&&E!==void 0?E:{};return F[qu]="firebase",F.update=!0,$!=null&&(F[Pu]=$),l("config",R.measurementId,F),R.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sl{constructor(n){this.app=n}_delete(){return delete ht[this.app.options.appId],Promise.resolve()}}let ht={},mi=[];const gi={};let Qr="dataLayer",cl="gtag",yi,tr,vi=!1;function ul(){const o=[];if(As()&&o.push("This is a browser extension environment."),Ss()||o.push("Cookies are not available."),o.length>0){const n=o.map((c,l)=>`(${l+1}) ${c}`).join(" "),i=$e.create("invalid-analytics-context",{errorInfo:n});Se.warn(i.message)}}function ll(o,n,i){ul();const c=o.options.appId;if(!c)throw $e.create("no-app-id");if(!o.options.apiKey)if(o.options.measurementId)Se.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${o.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw $e.create("no-api-key");if(ht[c]!=null)throw $e.create("already-exists",{id:c});if(!vi){$u(Qr);const{wrappedGtag:h,gtagCore:m}=Vu(ht,mi,gi,Qr,cl);tr=h,yi=m,vi=!0}return ht[c]=al(o,mi,gi,n,yi,Qr,i),new sl(o)}function dl(o=Ki()){o=hn(o);const n=Zn(o,Wn);return n.isInitialized()?n.getImmediate():fl(o)}function fl(o,n={}){const i=Zn(o,Wn);if(i.isInitialized()){const l=i.getImmediate();if(Hn(n,i.getOptions()))return l;throw $e.create("already-initialized")}return i.initialize({options:n})}function hl(o,n,i){o=hn(o),nl(tr,ht[o.app.options.appId],n).catch(c=>Se.error(c))}function pl(o,n,i){o=hn(o),rl(tr,ht[o.app.options.appId],n).catch(c=>Se.error(c))}function fo(o,n){o=hn(o),ol(ht[o.app.options.appId],n).catch(i=>Se.error(i))}function to(o,n,i,c){o=hn(o),tl(tr,ht[o.app.options.appId],n,i,c).catch(l=>Se.error(l))}const bi="@firebase/analytics",wi="0.10.17";function ml(){Tt(new pt(Wn,(n,{options:i})=>{const c=n.getProvider("app").getImmediate(),l=n.getProvider("installations-internal").getImmediate();return ll(c,l,i)},"PUBLIC")),Tt(new pt("analytics-internal",o,"PRIVATE")),ft(bi,wi),ft(bi,wi,"esm2017");function o(n){try{const i=n.getProvider(Wn).getImmediate();return{logEvent:(c,l,h)=>to(i,c,l,h)}}catch(i){throw $e.create("interop-component-reg-failed",{reason:i})}}}ml();const ho="privacy_consent",po="1.0",Kn={analytics:!1,crashReporting:!1,version:po,timestamp:null,askedUser:!1};function pn(){try{const o=localStorage.getItem(ho);if(!o)return{...Kn};const n=JSON.parse(o);return n.version!==po?(console.log("[Privacy] Consent version outdated, resetting..."),{...Kn}):n}catch(o){return console.error("[Privacy] Error reading consent preferences:",o),{...Kn}}}function nr(o){try{const n={...o,version:po,timestamp:Date.now(),askedUser:!0};return localStorage.setItem(ho,JSON.stringify(n)),console.log("[Privacy] Consent preferences saved:",n),window.dispatchEvent(new CustomEvent("consent-changed",{detail:n})),n}catch(n){return console.error("[Privacy] Error saving consent preferences:",n),null}}function gl(){return pn().askedUser}function ha(){return pn().analytics}function yl(){return pn().crashReporting}function vl(){return nr({analytics:!0,crashReporting:!0})}function bl(){return nr({analytics:!1,crashReporting:!1})}function wl(o,n){const i=pn();return nr({...i,[o]:n})}function _l(){localStorage.removeItem(ho),console.log("[Privacy] Consent reset"),window.dispatchEvent(new CustomEvent("consent-changed",{detail:Kn}))}function xl(){return{dataCollected:[{category:"Analytics",items:["Screen views and navigation patterns","Search queries and result interactions","Question views and bookmark actions","App performance metrics","Device type and platform (Android/iOS/Web)"],purpose:"To understand how users interact with the app and improve user experience",retention:"14 months (automatically deleted after)",required:!1},{category:"Essential Data",items:["App preferences (theme, settings)","Bookmarks and custom folders","Offline database cache"],purpose:"Required for core app functionality",retention:"Until you clear app data",required:!0}],dataNotCollected:["Personal information (name, email, phone)","Location data","Contact information","Photos or media files","Payment information","Browsing history outside this app"],thirdPartyServices:[{name:"Google Firebase Analytics",purpose:"Anonymous usage analytics",link:"https://firebase.google.com/support/privacy"}],userRights:["You can opt out of analytics at any time","You can request data deletion","Your data is never sold to third parties","No personal identification is collected"]}}function kl(){return{consent:pn(),hasBeenAsked:gl(),isAnalyticsEnabled:ha(),isCrashReportingEnabled:yl(),acceptAll:vl,rejectAll:bl,updateConsent:wl,saveConsentPreferences:nr,getPrivacyInfo:xl,resetConsent:_l}}const El={apiKey:"AIzaSyAOc2d3NPbuWzF5rWE3Fx8Ij7EGm4dFNT8",authDomain:"betterislamqa.firebaseapp.com",projectId:"betterislamqa",storageBucket:"betterislamqa.firebasestorage.app",messagingSenderId:"1062208000513",appId:"1:1062208000513:web:d7c0b7697df2ab88d12600",measurementId:"G-99MZ5VYR07"};let Be=null,et=!1,Ae=!1;const pa=!!window.cordova,ut=!pa;function Il(){if(et){console.log("[Analytics] Already initialized");return}if(Ae=ha(),console.log("[Analytics] User consent status:",Ae?"Granted":"Denied"),ut)try{const o=Mc().length===0?Li(El):Ki();Be=dl(o),fo(Be,Ae),et=!0,console.log("[Analytics]  Firebase Web SDK initialized (collection:",Ae?"enabled":"disabled",")")}catch(o){console.error("[Analytics]  Web initialization error:",o)}else window.FirebasePlugin?(window.FirebasePlugin.setAnalyticsCollectionEnabled(Ae),et=!0,console.log("[Analytics]  Firebase Cordova plugin ready (collection:",Ae?"enabled":"disabled",")")):console.warn("[Analytics]  Firebase Cordova plugin not found");window.addEventListener("consent-changed",Al)}function Al(o){const i=o.detail.analytics;i!==Ae&&(Ae=i,console.log("[Analytics] Consent changed, analytics now:",Ae?"enabled":"disabled"),et&&(ut&&Be?fo(Be,Ae):window.FirebasePlugin&&window.FirebasePlugin.setAnalyticsCollectionEnabled(Ae)))}function Sl(o){Ae=o,et&&(ut&&Be?(fo(Be,o),console.log("[Analytics] Collection",o?"enabled":"disabled")):window.FirebasePlugin&&(window.FirebasePlugin.setAnalyticsCollectionEnabled(o),console.log("[Analytics] Collection",o?"enabled":"disabled")))}function Cl(){return Ae}function Ol(){const o=(R,$={})=>{if(!et||!Ae)return;const F={screen_name:R,screen_class:R,...$};ut&&Be?(to(Be,"screen_view",F),console.log("[Analytics]  Screen view:",R)):window.FirebasePlugin&&(window.FirebasePlugin.logEvent("screen_view",F),console.log("[Analytics]  Screen view:",R))},n=(R,$={})=>{!et||!Ae||(ut&&Be?(to(Be,R,$),console.log("[Analytics]  Event:",R,$)):window.FirebasePlugin&&(window.FirebasePlugin.logEvent(R,$),console.log("[Analytics]  Event:",R,$)))};return{logScreen:o,logEvent:n,logSearch:(R,$=0)=>{n("search",{search_term:R,result_count:$})},logQuestionView:(R,$="")=>{n("question_viewed",{question_id:R,category:$})},logCategoryView:(R,$)=>{n("category_viewed",{category_name:R,category_id:$})},logFolderAction:(R,$)=>{n("folder_action",{action:R,folder_name:$})},logShare:(R,$)=>{n("share",{content_type:R,content_id:$})},logQuizEvent:(R,$={})=>{n(`quiz_${R}`,$)},setUserProperties:R=>{!et||!Ae||(ut&&Be?(pl(Be,R),console.log("[Analytics]  User properties:",R)):window.FirebasePlugin&&(Object.keys(R).forEach($=>{window.FirebasePlugin.setUserProperty($,String(R[$]))}),console.log("[Analytics]  User properties:",R)))},setUserId:R=>{!et||!Ae||(ut&&Be?(hl(Be,R),console.log("[Analytics]  User ID set:",R)):window.FirebasePlugin&&(window.FirebasePlugin.setUserId(R),console.log("[Analytics]  User ID set:",R)))},setEnabled:Sl,isEnabled:Cl,isCordova:pa,isWeb:ut}}const ma=Xa({history:es(),routes:[{path:"/",name:"home",component:()=>Le(()=>import("./HomeView-3j3n4A9y.js"),__vite__mapDeps([0,1,2,3,4,5,6])),meta:{title:"BetterIslam Q&A"}},{path:"/import",name:"import",component:()=>Le(()=>import("./ImportView-VXP2fb45.js"),__vite__mapDeps([7,1,8])),meta:{title:"Import Data"}},{path:"/browse",name:"browse",component:()=>Le(()=>import("./BrowseView-MQXZctlx.js"),__vite__mapDeps([9,1,2])),meta:{title:"Browse Categories"}},{path:"/category/:id",name:"category",component:()=>Le(()=>import("./CategoryView-aMnnN-9N.js"),__vite__mapDeps([10,1,11,12,13])),meta:{title:"Category"}},{path:"/question/:id",name:"question",component:()=>Le(()=>import("./QuestionView-DMCHS61o.js"),__vite__mapDeps([14,1,2,15,16])),meta:{title:"Question"}},{path:"/search",name:"search",component:()=>Le(()=>import("./SearchView-45U3b9cy.js"),__vite__mapDeps([17,1,18,11,12])),meta:{title:"Search"}},{path:"/bookmarks",name:"bookmarks",component:()=>Le(()=>import("./FoldersView-DUTtWcOO.js"),__vite__mapDeps([19,1,20])),meta:{title:"My Bookmarks"}},{path:"/quiz",name:"quiz",component:()=>Le(()=>import("./QuizView-RK0TrP2k.js"),__vite__mapDeps([21,1,22,23])),meta:{title:"Quiz"}},{path:"/prayer-times",name:"prayer-times",component:()=>Le(()=>import("./PrayerTimesView-HOFp6Vk9.js"),__vite__mapDeps([24,1,3,4,5])),meta:{title:"Prayer Times"}},{path:"/leaderboard",name:"leaderboard",component:()=>Le(()=>import("./LeaderboardView-C78hfZIN.js"),__vite__mapDeps([25,1,22])),meta:{title:"Leaderboard"}},{path:"/settings",name:"settings",component:()=>Le(()=>import("./SettingsView-Czq47F7k.js"),__vite__mapDeps([26,1,15,22,5,27])),meta:{title:"Settings"}},{path:"/privacy",name:"privacy",component:()=>Le(()=>import("./PrivacyView-BnH7USGb.js"),__vite__mapDeps([28,1])),meta:{title:"Privacy Information"}}]});ma.afterEach(o=>{document.title=o.meta.title||"BetterIslam Q&A";const{logScreen:n}=Ol();n(o.name||"unknown",{page_path:o.path,page_title:o.meta.title||"BetterIslam Q&A"})});const Wr=pe(!1);function ga(){const o=c=>{Wr.value=c,c?(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light"))};return{isDark:Wr,setTheme:o,toggleTheme:()=>{o(!Wr.value)},initTheme:()=>{const c=localStorage.getItem("theme");if(c)o(c==="dark");else{const l=window.matchMedia("(prefers-color-scheme: dark)").matches;o(l)}window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",l=>{localStorage.getItem("theme")||o(l.matches)})}}}var _i=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Tl(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var ya={exports:{}};(function(o,n){(function(i,c){o.exports=c()})(_i,function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(r[s]=a[s])})(e,t)},c=function(){return(c=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};function l(e,t,r){for(var a,s=0,u=t.length;s<u;s++)!a&&s in t||((a=a||Array.prototype.slice.call(t,0,s))[s]=t[s]);return e.concat(a||Array.prototype.slice.call(t))}var h=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:_i,m=Object.keys,E=Array.isArray;function C(e,t){return typeof t!="object"||m(t).forEach(function(r){e[r]=t[r]}),e}typeof Promise>"u"||h.Promise||(h.Promise=Promise);var q=Object.getPrototypeOf,R={}.hasOwnProperty;function $(e,t){return R.call(e,t)}function F(e,t){typeof t=="function"&&(t=t(q(e))),(typeof Reflect>"u"?m:Reflect.ownKeys)(t).forEach(function(r){de(e,r,t[r])})}var Y=Object.defineProperty;function de(e,t,r,a){Y(e,t,C(r&&$(r,"get")&&typeof r.get=="function"?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},a))}function _e(e){return{from:function(t){return e.prototype=Object.create(t.prototype),de(e.prototype,"constructor",e),{extend:F.bind(null,e.prototype)}}}}var ve=Object.getOwnPropertyDescriptor,Re=[].slice;function be(e,t,r){return Re.call(e,t,r)}function U(e,t){return t(e)}function X(e){if(!e)throw new Error("Assertion Failed")}function Ce(e){h.setImmediate?setImmediate(e):setTimeout(e,0)}function Ie(e,t){if(typeof t=="string"&&$(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var r=[],a=0,s=t.length;a<s;++a){var u=Ie(e,t[a]);r.push(u)}return r}var d=t.indexOf(".");if(d!==-1){var f=e[t.substr(0,d)];return f==null?void 0:Ie(f,t.substr(d+1))}}function xe(e,t,r){if(e&&t!==void 0&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){X(typeof r!="string"&&"length"in r);for(var a=0,s=t.length;a<s;++a)xe(e,t[a],r[a])}else{var u,d,f=t.indexOf(".");f!==-1?(u=t.substr(0,f),(d=t.substr(f+1))===""?r===void 0?E(e)&&!isNaN(parseInt(u))?e.splice(u,1):delete e[u]:e[u]=r:xe(f=!(f=e[u])||!$(e,u)?e[u]={}:f,d,r)):r===void 0?E(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=r}}function He(e){var t,r={};for(t in e)$(e,t)&&(r[t]=e[t]);return r}var Ht=[].concat;function Mt(e){return Ht.apply([],e)}var yt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Mt([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return h[e]}),H=new Set(yt.map(function(e){return h[e]})),Z=null;function ae(e){return Z=new WeakMap,e=function t(r){if(!r||typeof r!="object")return r;var a=Z.get(r);if(a)return a;if(E(r)){a=[],Z.set(r,a);for(var s=0,u=r.length;s<u;++s)a.push(t(r[s]))}else if(H.has(r.constructor))a=r;else{var d,f=q(r);for(d in a=f===Object.prototype?{}:Object.create(f),Z.set(r,a),r)$(r,d)&&(a[d]=t(r[d]))}return a}(e),Z=null,e}var mt={}.toString;function Bt(e){return mt.call(e).slice(8,-1)}var we=typeof Symbol<"u"?Symbol.iterator:"@@iterator",re=typeof we=="symbol"?function(e){var t;return e!=null&&(t=e[we])&&t.apply(e)}:function(){return null};function me(e,t){return t=e.indexOf(t),0<=t&&e.splice(t,1),0<=t}var je={};function Qe(e){var t,r,a,s;if(arguments.length===1){if(E(e))return e.slice();if(this===je&&typeof e=="string")return[e];if(s=re(e)){for(r=[];!(a=s.next()).done;)r.push(a.value);return r}if(e==null)return[e];if(typeof(t=e.length)!="number")return[e];for(r=new Array(t);t--;)r[t]=e[t];return r}for(t=arguments.length,r=new Array(t);t--;)r[t]=arguments[t];return r}var rr=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Gt=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Ne=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Gt),_a={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Rt(e,t){this.name=e,this.message=t}function yo(e,t){return e+". Errors: "+Object.keys(t).map(function(r){return t[r].toString()}).filter(function(r,a,s){return s.indexOf(r)===a}).join(`
`)}function mn(e,t,r,a){this.failures=t,this.failedKeys=a,this.successCount=r,this.message=yo(e,t)}function jt(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(r){return t[r]}),this.failuresByPos=t,this.message=yo(e,this.failures)}_e(Rt).from(Error).extend({toString:function(){return this.name+": "+this.message}}),_e(mn).from(Rt),_e(jt).from(Rt);var or=Ne.reduce(function(e,t){return e[t]=t+"Error",e},{}),xa=Rt,V=Ne.reduce(function(e,t){var r=t+"Error";function a(s,u){this.name=r,s?typeof s=="string"?(this.message="".concat(s).concat(u?`
 `+u:""),this.inner=u||null):typeof s=="object"&&(this.message="".concat(s.name," ").concat(s.message),this.inner=s):(this.message=_a[t]||r,this.inner=null)}return _e(a).from(xa),e[t]=a,e},{});V.Syntax=SyntaxError,V.Type=TypeError,V.Range=RangeError;var vo=Gt.reduce(function(e,t){return e[t+"Error"]=V[t],e},{}),gn=Ne.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=V[t]),e},{});function ie(){}function Qt(e){return e}function ka(e,t){return e==null||e===Qt?t:function(r){return t(e(r))}}function gt(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function Ea(e,t){return e===ie?t:function(){var r=e.apply(this,arguments);r!==void 0&&(arguments[0]=r);var a=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var u=t.apply(this,arguments);return a&&(this.onsuccess=this.onsuccess?gt(a,this.onsuccess):a),s&&(this.onerror=this.onerror?gt(s,this.onerror):s),u!==void 0?u:r}}function Ia(e,t){return e===ie?t:function(){e.apply(this,arguments);var r=this.onsuccess,a=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?gt(r,this.onsuccess):r),a&&(this.onerror=this.onerror?gt(a,this.onerror):a)}}function Aa(e,t){return e===ie?t:function(r){var a=e.apply(this,arguments);C(r,a);var s=this.onsuccess,u=this.onerror;return this.onsuccess=null,this.onerror=null,r=t.apply(this,arguments),s&&(this.onsuccess=this.onsuccess?gt(s,this.onsuccess):s),u&&(this.onerror=this.onerror?gt(u,this.onerror):u),a===void 0?r===void 0?void 0:r:C(a,r)}}function Sa(e,t){return e===ie?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function ir(e,t){return e===ie?t:function(){var r=e.apply(this,arguments);if(r&&typeof r.then=="function"){for(var a=this,s=arguments.length,u=new Array(s);s--;)u[s]=arguments[s];return r.then(function(){return t.apply(a,u)})}return t.apply(this,arguments)}}gn.ModifyError=mn,gn.DexieError=Rt,gn.BulkError=jt;var We=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function bo(e){We=e}var Wt={},wo=100,yt=typeof Promise>"u"?[]:function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,q(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,q(t),e]}(),Gt=yt[0],Ne=yt[1],yt=yt[2],Ne=Ne&&Ne.then,vt=Gt&&Gt.constructor,ar=!!yt,Yt=function(e,t){Jt.push([e,t]),yn&&(queueMicrotask(Oa),yn=!1)},sr=!0,yn=!0,bt=[],vn=[],cr=Qt,nt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ie,pgp:!1,env:{},finalize:ie},K=nt,Jt=[],wt=0,bn=[];function N(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=K;if(typeof e!="function"){if(e!==Wt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&lr(this,this._value))}this._state=null,this._value=null,++t.ref,function r(a,s){try{s(function(u){if(a._state===null){if(u===a)throw new TypeError("A promise cannot be resolved with itself.");var d=a._lib&&zt();u&&typeof u.then=="function"?r(a,function(f,g){u instanceof N?u._then(f,g):u.then(f,g)}):(a._state=!0,a._value=u,xo(a)),d&&Ft()}},lr.bind(null,a))}catch(u){lr(a,u)}}(this,e)}var ur={get:function(){var e=K,t=kn;function r(a,s){var u=this,d=!e.global&&(e!==K||t!==kn),f=d&&!ot(),g=new N(function(y,_){dr(u,new _o(Eo(a,e,d,f),Eo(s,e,d,f),y,_,e))});return this._consoleTask&&(g._consoleTask=this._consoleTask),g}return r.prototype=Wt,r},set:function(e){de(this,"then",e&&e.prototype===Wt?ur:{get:function(){return e},set:ur.set})}};function _o(e,t,r,a,s){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=r,this.reject=a,this.psd=s}function lr(e,t){var r,a;vn.push(t),e._state===null&&(r=e._lib&&zt(),t=cr(t),e._state=!1,e._value=t,a=e,bt.some(function(s){return s._value===a._value})||bt.push(a),xo(e),r&&Ft())}function xo(e){var t=e._listeners;e._listeners=[];for(var r=0,a=t.length;r<a;++r)dr(e,t[r]);var s=e._PSD;--s.ref||s.finalize(),wt===0&&(++wt,Yt(function(){--wt==0&&fr()},[]))}function dr(e,t){if(e._state!==null){var r=e._state?t.onFulfilled:t.onRejected;if(r===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++wt,Yt(Ca,[r,e,t])}else e._listeners.push(t)}function Ca(e,t,r){try{var a,s=t._value;!t._state&&vn.length&&(vn=[]),a=We&&t._consoleTask?t._consoleTask.run(function(){return e(s)}):e(s),t._state||vn.indexOf(s)!==-1||function(u){for(var d=bt.length;d;)if(bt[--d]._value===u._value)return bt.splice(d,1)}(t),r.resolve(a)}catch(u){r.reject(u)}finally{--wt==0&&fr(),--r.psd.ref||r.psd.finalize()}}function Oa(){_t(nt,function(){zt()&&Ft()})}function zt(){var e=sr;return yn=sr=!1,e}function Ft(){var e,t,r;do for(;0<Jt.length;)for(e=Jt,Jt=[],r=e.length,t=0;t<r;++t){var a=e[t];a[0].apply(null,a[1])}while(0<Jt.length);yn=sr=!0}function fr(){var e=bt;bt=[],e.forEach(function(a){a._PSD.onunhandled.call(null,a._value,a)});for(var t=bn.slice(0),r=t.length;r;)t[--r]()}function wn(e){return new N(Wt,!1,e)}function he(e,t){var r=K;return function(){var a=zt(),s=K;try{return it(r,!0),e.apply(this,arguments)}catch(u){t&&t(u)}finally{it(s,!1),a&&Ft()}}}F(N.prototype,{then:ur,_then:function(e,t){dr(this,new _o(null,null,e,t,K))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=e,r=arguments[1];return typeof t=="function"?this.then(null,function(a){return(a instanceof t?r:wn)(a)}):this.then(null,function(a){return(a&&a.name===t?r:wn)(a)})},finally:function(e){return this.then(function(t){return N.resolve(e()).then(function(){return t})},function(t){return N.resolve(e()).then(function(){return wn(t)})})},timeout:function(e,t){var r=this;return e<1/0?new N(function(a,s){var u=setTimeout(function(){return s(new V.Timeout(t))},e);r.then(a,s).finally(clearTimeout.bind(null,u))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&de(N.prototype,Symbol.toStringTag,"Dexie.Promise"),nt.env=ko(),F(N,{all:function(){var e=Qe.apply(null,arguments).map(En);return new N(function(t,r){e.length===0&&t([]);var a=e.length;e.forEach(function(s,u){return N.resolve(s).then(function(d){e[u]=d,--a||t(e)},r)})})},resolve:function(e){return e instanceof N?e:e&&typeof e.then=="function"?new N(function(t,r){e.then(t,r)}):new N(Wt,!0,e)},reject:wn,race:function(){var e=Qe.apply(null,arguments).map(En);return new N(function(t,r){e.map(function(a){return N.resolve(a).then(t,r)})})},PSD:{get:function(){return K},set:function(e){return K=e}},totalEchoes:{get:function(){return kn}},newPSD:rt,usePSD:_t,scheduler:{get:function(){return Yt},set:function(e){Yt=e}},rejectionMapper:{get:function(){return cr},set:function(e){cr=e}},follow:function(e,t){return new N(function(r,a){return rt(function(s,u){var d=K;d.unhandleds=[],d.onunhandled=u,d.finalize=gt(function(){var f,g=this;f=function(){g.unhandleds.length===0?s():u(g.unhandleds[0])},bn.push(function y(){f(),bn.splice(bn.indexOf(y),1)}),++wt,Yt(function(){--wt==0&&fr()},[])},d.finalize),e()},t,r,a)})}}),vt&&(vt.allSettled&&de(N,"allSettled",function(){var e=Qe.apply(null,arguments).map(En);return new N(function(t){e.length===0&&t([]);var r=e.length,a=new Array(r);e.forEach(function(s,u){return N.resolve(s).then(function(d){return a[u]={status:"fulfilled",value:d}},function(d){return a[u]={status:"rejected",reason:d}}).then(function(){return--r||t(a)})})})}),vt.any&&typeof AggregateError<"u"&&de(N,"any",function(){var e=Qe.apply(null,arguments).map(En);return new N(function(t,r){e.length===0&&r(new AggregateError([]));var a=e.length,s=new Array(a);e.forEach(function(u,d){return N.resolve(u).then(function(f){return t(f)},function(f){s[d]=f,--a||r(new AggregateError(s))})})})}),vt.withResolvers&&(N.withResolvers=vt.withResolvers));var ke={awaits:0,echoes:0,id:0},Ta=0,_n=[],xn=0,kn=0,Da=0;function rt(e,t,r,a){var s=K,u=Object.create(s);return u.parent=s,u.ref=0,u.global=!1,u.id=++Da,nt.env,u.env=ar?{Promise:N,PromiseProp:{value:N,configurable:!0,writable:!0},all:N.all,race:N.race,allSettled:N.allSettled,any:N.any,resolve:N.resolve,reject:N.reject}:{},t&&C(u,t),++s.ref,u.finalize=function(){--this.parent.ref||this.parent.finalize()},a=_t(u,e,r,a),u.ref===0&&u.finalize(),a}function $t(){return ke.id||(ke.id=++Ta),++ke.awaits,ke.echoes+=wo,ke.id}function ot(){return!!ke.awaits&&(--ke.awaits==0&&(ke.id=0),ke.echoes=ke.awaits*wo,!0)}function En(e){return ke.echoes&&e&&e.constructor===vt?($t(),e.then(function(t){return ot(),t},function(t){return ot(),ge(t)})):e}function Pa(){var e=_n[_n.length-1];_n.pop(),it(e,!1)}function it(e,t){var r,a=K;(t?!ke.echoes||xn++&&e===K:!xn||--xn&&e===K)||queueMicrotask(t?(function(s){++kn,ke.echoes&&--ke.echoes!=0||(ke.echoes=ke.awaits=ke.id=0),_n.push(K),it(s,!0)}).bind(null,e):Pa),e!==K&&(K=e,a===nt&&(nt.env=ko()),ar&&(r=nt.env.Promise,t=e.env,(a.global||e.global)&&(Object.defineProperty(h,"Promise",t.PromiseProp),r.all=t.all,r.race=t.race,r.resolve=t.resolve,r.reject=t.reject,t.allSettled&&(r.allSettled=t.allSettled),t.any&&(r.any=t.any))))}function ko(){var e=h.Promise;return ar?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(h,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function _t(e,t,r,a,s){var u=K;try{return it(e,!0),t(r,a,s)}finally{it(u,!1)}}function Eo(e,t,r,a){return typeof e!="function"?e:function(){var s=K;r&&$t(),it(t,!0);try{return e.apply(this,arguments)}finally{it(s,!1),a&&queueMicrotask(ot)}}}function hr(e){Promise===vt&&ke.echoes===0?xn===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}(""+Ne).indexOf("[native code]")===-1&&($t=ot=ie);var ge=N.reject,xt="",Ze="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Io="String expected.",Nt=[],In="__dbnames",pr="readonly",mr="readwrite";function kt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var Ao={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function An(e){return typeof e!="string"||/\./.test(e)?function(t){return t}:function(t){return t[e]===void 0&&e in t&&delete(t=ae(t))[e],t}}function So(){throw V.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function te(e,t){try{var r=Co(e),a=Co(t);if(r!==a)return r==="Array"?1:a==="Array"?-1:r==="binary"?1:a==="binary"?-1:r==="string"?1:a==="string"?-1:r==="Date"?1:a!=="Date"?NaN:-1;switch(r){case"number":case"Date":case"string":return t<e?1:e<t?-1:0;case"binary":return function(s,u){for(var d=s.length,f=u.length,g=d<f?d:f,y=0;y<g;++y)if(s[y]!==u[y])return s[y]<u[y]?-1:1;return d===f?0:d<f?-1:1}(Oo(e),Oo(t));case"Array":return function(s,u){for(var d=s.length,f=u.length,g=d<f?d:f,y=0;y<g;++y){var _=te(s[y],u[y]);if(_!==0)return _}return d===f?0:d<f?-1:1}(e,t)}}catch{}return NaN}function Co(e){var t=typeof e;return t!="object"?t:ArrayBuffer.isView(e)?"binary":(e=Bt(e),e==="ArrayBuffer"?"binary":e)}function Oo(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}function Sn(e,t,r){var a=e.schema.yProps;return a?(t&&0<r.numFailures&&(t=t.filter(function(s,u){return!r.failures[u]})),Promise.all(a.map(function(s){return s=s.updatesTable,t?e.db.table(s).where("k").anyOf(t).delete():e.db.table(s).clear()})).then(function(){return r})):r}var Zt=(To.prototype.execute=function(e){var t=this["@@propmod"];if(t.add!==void 0){var r=t.add;if(E(r))return l(l([],E(e)?e:[],!0),r).sort();if(typeof r=="number")return(Number(e)||0)+r;if(typeof r=="bigint")try{return BigInt(e)+r}catch{return BigInt(0)+r}throw new TypeError("Invalid term ".concat(r))}if(t.remove!==void 0){var a=t.remove;if(E(a))return E(e)?e.filter(function(s){return!a.includes(s)}).sort():[];if(typeof a=="number")return Number(e)-a;if(typeof a=="bigint")try{return BigInt(e)-a}catch{return BigInt(0)-a}throw new TypeError("Invalid subtrahend ".concat(a))}return r=(r=t.replacePrefix)===null||r===void 0?void 0:r[0],r&&typeof e=="string"&&e.startsWith(r)?t.replacePrefix[1]+e.substring(r.length):e},To);function To(e){this["@@propmod"]=e}function Do(e,t){for(var r=m(t),a=r.length,s=!1,u=0;u<a;++u){var d=r[u],f=t[d],g=Ie(e,d);f instanceof Zt?(xe(e,d,f.execute(g)),s=!0):g!==f&&(xe(e,d,f),s=!0)}return s}var Po=(se.prototype._trans=function(e,t,r){var a=this._tx||K.trans,s=this.name,u=We&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(e==="readonly"?"read":"write"," ").concat(this.name));function d(y,_,p){if(!p.schema[s])throw new V.NotFound("Table "+s+" not part of transaction");return t(p.idbtrans,p)}var f=zt();try{var g=a&&a.db._novip===this.db._novip?a===K.trans?a._promise(e,d,r):rt(function(){return a._promise(e,d,r)},{trans:a,transless:K.transless||K}):function y(_,p,k,v){if(_.idbdb&&(_._state.openComplete||K.letThrough||_._vip)){var b=_._createTransaction(p,k,_._dbSchema);try{b.create(),_._state.PR1398_maxLoop=3}catch(w){return w.name===or.InvalidState&&_.isOpen()&&0<--_._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),_.close({disableAutoOpen:!1}),_.open().then(function(){return y(_,p,k,v)})):ge(w)}return b._promise(p,function(w,x){return rt(function(){return K.trans=b,v(w,x,b)})}).then(function(w){if(p==="readwrite")try{b.idbtrans.commit()}catch{}return p==="readonly"?w:b._completion.then(function(){return w})})}if(_._state.openComplete)return ge(new V.DatabaseClosed(_._state.dbOpenError));if(!_._state.isBeingOpened){if(!_._state.autoOpen)return ge(new V.DatabaseClosed);_.open().catch(ie)}return _._state.dbReadyPromise.then(function(){return y(_,p,k,v)})}(this.db,e,[this.name],d);return u&&(g._consoleTask=u,g=g.catch(function(y){return console.trace(y),ge(y)})),g}finally{f&&Ft()}},se.prototype.get=function(e,t){var r=this;return e&&e.constructor===Object?this.where(e).first(t):e==null?ge(new V.Type("Invalid argument to Table.get()")):this._trans("readonly",function(a){return r.core.get({trans:a,key:e}).then(function(s){return r.hook.reading.fire(s)})}).then(t)},se.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(E(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=m(e);if(t.length===1)return this.where(t[0]).equals(e[t[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter(function(f){if(f.compound&&t.every(function(y){return 0<=f.keyPath.indexOf(y)})){for(var g=0;g<t.length;++g)if(t.indexOf(f.keyPath[g])===-1)return!1;return!0}return!1}).sort(function(f,g){return f.keyPath.length-g.keyPath.length})[0];if(r&&this.db._maxKey!==xt){var u=r.keyPath.slice(0,t.length);return this.where(u).equals(u.map(function(g){return e[g]}))}!r&&We&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var a=this.schema.idxByName;function s(f,g){return te(f,g)===0}var d=t.reduce(function(p,g){var y=p[0],_=p[1],p=a[g],k=e[g];return[y||p,y||!p?kt(_,p&&p.multi?function(v){return v=Ie(v,g),E(v)&&v.some(function(b){return s(k,b)})}:function(v){return s(k,Ie(v,g))}):_]},[null,null]),u=d[0],d=d[1];return u?this.where(u.name).equals(e[u.keyPath]).filter(d):r?this.filter(d):this.where(t).equals("")},se.prototype.filter=function(e){return this.toCollection().and(e)},se.prototype.count=function(e){return this.toCollection().count(e)},se.prototype.offset=function(e){return this.toCollection().offset(e)},se.prototype.limit=function(e){return this.toCollection().limit(e)},se.prototype.each=function(e){return this.toCollection().each(e)},se.prototype.toArray=function(e){return this.toCollection().toArray(e)},se.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},se.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,E(e)?"[".concat(e.join("+"),"]"):e))},se.prototype.reverse=function(){return this.toCollection().reverse()},se.prototype.mapToClass=function(e){var t,r=this.db,a=this.name;function s(){return t!==null&&t.apply(this,arguments)||this}(this.schema.mappedClass=e).prototype instanceof So&&(function(g,y){if(typeof y!="function"&&y!==null)throw new TypeError("Class extends value "+String(y)+" is not a constructor or null");function _(){this.constructor=g}i(g,y),g.prototype=y===null?Object.create(y):(_.prototype=y.prototype,new _)}(s,t=e),Object.defineProperty(s.prototype,"db",{get:function(){return r},enumerable:!1,configurable:!0}),s.prototype.table=function(){return a},e=s);for(var u=new Set,d=e.prototype;d;d=q(d))Object.getOwnPropertyNames(d).forEach(function(g){return u.add(g)});function f(g){if(!g)return g;var y,_=Object.create(e.prototype);for(y in g)if(!u.has(y))try{_[y]=g[y]}catch{}return _}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=f,this.hook("reading",f),e},se.prototype.defineClass=function(){return this.mapToClass(function(e){C(this,e)})},se.prototype.add=function(e,t){var r=this,a=this.schema.primKey,s=a.auto,u=a.keyPath,d=e;return u&&s&&(d=An(u)(e)),this._trans("readwrite",function(f){return r.core.mutate({trans:f,type:"add",keys:t!=null?[t]:null,values:[d]})}).then(function(f){return f.numFailures?N.reject(f.failures[0]):f.lastResult}).then(function(f){if(u)try{xe(e,u,f)}catch{}return f})},se.prototype.upsert=function(e,t){var r=this,a=this.schema.primKey.keyPath;return this._trans("readwrite",function(s){return r.core.get({trans:s,key:e}).then(function(u){var d=u??{};return Do(d,t),a&&xe(d,a,e),r.core.mutate({trans:s,type:"put",values:[d],keys:[e],upsert:!0,updates:{keys:[e],changeSpecs:[t]}}).then(function(f){return f.numFailures?N.reject(f.failures[0]):!!u})})})},se.prototype.update=function(e,t){return typeof e!="object"||E(e)?this.where(":id").equals(e).modify(t):(e=Ie(e,this.schema.primKey.keyPath),e===void 0?ge(new V.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(t))},se.prototype.put=function(e,t){var r=this,a=this.schema.primKey,s=a.auto,u=a.keyPath,d=e;return u&&s&&(d=An(u)(e)),this._trans("readwrite",function(f){return r.core.mutate({trans:f,type:"put",values:[d],keys:t!=null?[t]:null})}).then(function(f){return f.numFailures?N.reject(f.failures[0]):f.lastResult}).then(function(f){if(u)try{xe(e,u,f)}catch{}return f})},se.prototype.delete=function(e){var t=this;return this._trans("readwrite",function(r){return t.core.mutate({trans:r,type:"delete",keys:[e]}).then(function(a){return Sn(t,[e],a)}).then(function(a){return a.numFailures?N.reject(a.failures[0]):void 0})})},se.prototype.clear=function(){var e=this;return this._trans("readwrite",function(t){return e.core.mutate({trans:t,type:"deleteRange",range:Ao}).then(function(r){return Sn(e,null,r)})}).then(function(t){return t.numFailures?N.reject(t.failures[0]):void 0})},se.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",function(r){return t.core.getMany({keys:e,trans:r}).then(function(a){return a.map(function(s){return t.hook.reading.fire(s)})})})},se.prototype.bulkAdd=function(e,t,r){var a=this,s=Array.isArray(t)?t:void 0,u=(r=r||(s?void 0:t))?r.allKeys:void 0;return this._trans("readwrite",function(d){var y=a.schema.primKey,f=y.auto,y=y.keyPath;if(y&&s)throw new V.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new V.InvalidArgument("Arguments objects and keys must have the same length");var g=e.length,y=y&&f?e.map(An(y)):e;return a.core.mutate({trans:d,type:"add",keys:s,values:y,wantResults:u}).then(function(b){var p=b.numFailures,k=b.results,v=b.lastResult,b=b.failures;if(p===0)return u?k:v;throw new jt("".concat(a.name,".bulkAdd(): ").concat(p," of ").concat(g," operations failed"),b)})})},se.prototype.bulkPut=function(e,t,r){var a=this,s=Array.isArray(t)?t:void 0,u=(r=r||(s?void 0:t))?r.allKeys:void 0;return this._trans("readwrite",function(d){var y=a.schema.primKey,f=y.auto,y=y.keyPath;if(y&&s)throw new V.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new V.InvalidArgument("Arguments objects and keys must have the same length");var g=e.length,y=y&&f?e.map(An(y)):e;return a.core.mutate({trans:d,type:"put",keys:s,values:y,wantResults:u}).then(function(b){var p=b.numFailures,k=b.results,v=b.lastResult,b=b.failures;if(p===0)return u?k:v;throw new jt("".concat(a.name,".bulkPut(): ").concat(p," of ").concat(g," operations failed"),b)})})},se.prototype.bulkUpdate=function(e){var t=this,r=this.core,a=e.map(function(d){return d.key}),s=e.map(function(d){return d.changes}),u=[];return this._trans("readwrite",function(d){return r.getMany({trans:d,keys:a,cache:"clone"}).then(function(f){var g=[],y=[];e.forEach(function(p,k){var v=p.key,b=p.changes,w=f[k];if(w){for(var x=0,I=Object.keys(b);x<I.length;x++){var A=I[x],S=b[A];if(A===t.schema.primKey.keyPath){if(te(S,v)!==0)throw new V.Constraint("Cannot update primary key in bulkUpdate()")}else xe(w,A,S)}u.push(k),g.push(v),y.push(w)}});var _=g.length;return r.mutate({trans:d,type:"put",keys:g,values:y,updates:{keys:a,changeSpecs:s}}).then(function(p){var k=p.numFailures,v=p.failures;if(k===0)return _;for(var b=0,w=Object.keys(v);b<w.length;b++){var x,I=w[b],A=u[Number(I)];A!=null&&(x=v[I],delete v[I],v[A]=x)}throw new jt("".concat(t.name,".bulkUpdate(): ").concat(k," of ").concat(_," operations failed"),v)})})})},se.prototype.bulkDelete=function(e){var t=this,r=e.length;return this._trans("readwrite",function(a){return t.core.mutate({trans:a,type:"delete",keys:e}).then(function(s){return Sn(t,e,s)})}).then(function(d){var s=d.numFailures,u=d.lastResult,d=d.failures;if(s===0)return u;throw new jt("".concat(t.name,".bulkDelete(): ").concat(s," of ").concat(r," operations failed"),d)})},se);function se(){}function Xt(e){function t(d,f){if(f){for(var g=arguments.length,y=new Array(g-1);--g;)y[g-1]=arguments[g];return r[d].subscribe.apply(null,y),e}if(typeof d=="string")return r[d]}var r={};t.addEventType=u;for(var a=1,s=arguments.length;a<s;++a)u(arguments[a]);return t;function u(d,f,g){if(typeof d!="object"){var y;f=f||Sa;var _={subscribers:[],fire:g=g||ie,subscribe:function(p){_.subscribers.indexOf(p)===-1&&(_.subscribers.push(p),_.fire=f(_.fire,p))},unsubscribe:function(p){_.subscribers=_.subscribers.filter(function(k){return k!==p}),_.fire=_.subscribers.reduce(f,g)}};return r[d]=t[d]=_}m(y=d).forEach(function(p){var k=y[p];if(E(k))u(p,y[p][0],y[p][1]);else{if(k!=="asap")throw new V.InvalidArgument("Invalid event config");var v=u(p,Qt,function(){for(var b=arguments.length,w=new Array(b);b--;)w[b]=arguments[b];v.subscribers.forEach(function(x){Ce(function(){x.apply(null,w)})})})}})}}function en(e,t){return _e(t).from({prototype:e}),t}function Lt(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function gr(e,t){e.filter=kt(e.filter,t)}function yr(e,t,r){var a=e.replayFilter;e.replayFilter=a?function(){return kt(a(),t())}:t,e.justLimit=r&&!a}function Cn(e,t){if(e.isPrimKey)return t.primaryKey;var r=t.getIndexByKeyPath(e.index);if(!r)throw new V.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return r}function qo(e,t,r){var a=Cn(e,t.schema);return t.openCursor({trans:r,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:a,range:e.range}})}function On(e,t,r,a){var s=e.replayFilter?kt(e.filter,e.replayFilter()):e.filter;if(e.or){var u={},d=function(f,g,y){var _,p;s&&!s(g,y,function(k){return g.stop(k)},function(k){return g.fail(k)})||((p=""+(_=g.primaryKey))=="[object ArrayBuffer]"&&(p=""+new Uint8Array(_)),$(u,p)||(u[p]=!0,t(f,g,y)))};return Promise.all([e.or._iterate(d,r),Mo(qo(e,a,r),e.algorithm,d,!e.keysOnly&&e.valueMapper)])}return Mo(qo(e,a,r),kt(e.algorithm,s),t,!e.keysOnly&&e.valueMapper)}function Mo(e,t,r,a){var s=he(a?function(u,d,f){return r(a(u),d,f)}:r);return e.then(function(u){if(u)return u.start(function(){var d=function(){return u.continue()};t&&!t(u,function(f){return d=f},function(f){u.stop(f),d=ie},function(f){u.fail(f),d=ie})||s(u.value,u,function(f){return d=f}),d()})})}var qa=(ne.prototype._read=function(e,t){var r=this._ctx;return r.error?r.table._trans(null,ge.bind(null,r.error)):r.table._trans("readonly",e).then(t)},ne.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,ge.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},ne.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=kt(t.algorithm,e)},ne.prototype._iterate=function(e,t){return On(this._ctx,e,t,this._ctx.table.core)},ne.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&C(r,e),t._ctx=r,t},ne.prototype.raw=function(){return this._ctx.valueMapper=null,this},ne.prototype.each=function(e){var t=this._ctx;return this._read(function(r){return On(t,e,r,t.table.core)})},ne.prototype.count=function(e){var t=this;return this._read(function(r){var a=t._ctx,s=a.table.core;if(Lt(a,!0))return s.count({trans:r,query:{index:Cn(a,s.schema),range:a.range}}).then(function(d){return Math.min(d,a.limit)});var u=0;return On(a,function(){return++u,!1},r,s).then(function(){return u})}).then(e)},ne.prototype.sortBy=function(e,t){var r=e.split(".").reverse(),a=r[0],s=r.length-1;function u(g,y){return y?u(g[r[y]],y-1):g[a]}var d=this._ctx.dir==="next"?1:-1;function f(g,y){return te(u(g,s),u(y,s))*d}return this.toArray(function(g){return g.sort(f)}).then(t)},ne.prototype.toArray=function(e){var t=this;return this._read(function(r){var a=t._ctx;if(a.dir==="next"&&Lt(a,!0)&&0<a.limit){var s=a.valueMapper,u=Cn(a,a.table.core.schema);return a.table.core.query({trans:r,limit:a.limit,values:!0,query:{index:u,range:a.range}}).then(function(f){return f=f.result,s?f.map(s):f})}var d=[];return On(a,function(f){return d.push(f)},r,a.table.core).then(function(){return d})},e)},ne.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,Lt(t)?yr(t,function(){var r=e;return function(a,s){return r===0||(r===1?--r:s(function(){a.advance(r),r=0}),!1)}}):yr(t,function(){var r=e;return function(){return--r<0}})),this},ne.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),yr(this._ctx,function(){var t=e;return function(r,a,s){return--t<=0&&a(s),0<=t}},!0),this},ne.prototype.until=function(e,t){return gr(this._ctx,function(r,a,s){return!e(r.value)||(a(s),t)}),this},ne.prototype.first=function(e){return this.limit(1).toArray(function(t){return t[0]}).then(e)},ne.prototype.last=function(e){return this.reverse().first(e)},ne.prototype.filter=function(e){var t;return gr(this._ctx,function(r){return e(r.value)}),(t=this._ctx).isMatch=kt(t.isMatch,e),this},ne.prototype.and=function(e){return this.filter(e)},ne.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},ne.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},ne.prototype.desc=function(){return this.reverse()},ne.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(r,a){e(a.key,a)})},ne.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},ne.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(r,a){e(a.primaryKey,a)})},ne.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var r=[];return this.each(function(a,s){r.push(s.key)}).then(function(){return r}).then(e)},ne.prototype.primaryKeys=function(e){var t=this._ctx;if(t.dir==="next"&&Lt(t,!0)&&0<t.limit)return this._read(function(a){var s=Cn(t,t.table.core.schema);return t.table.core.query({trans:a,values:!1,limit:t.limit,query:{index:s,range:t.range}})}).then(function(a){return a.result}).then(e);t.keysOnly=!t.isMatch;var r=[];return this.each(function(a,s){r.push(s.primaryKey)}).then(function(){return r}).then(e)},ne.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},ne.prototype.firstKey=function(e){return this.limit(1).keys(function(t){return t[0]}).then(e)},ne.prototype.lastKey=function(e){return this.reverse().firstKey(e)},ne.prototype.distinct=function(){var e=this._ctx,e=e.index&&e.table.schema.idxByName[e.index];if(!e||!e.multi)return this;var t={};return gr(this._ctx,function(s){var a=s.primaryKey.toString(),s=$(t,a);return t[a]=!0,!s}),this},ne.prototype.modify=function(e){var t=this,r=this._ctx;return this._write(function(a){var s=typeof e=="function"?e:function(w){return Do(w,e)},u=r.table.core,y=u.schema.primaryKey,d=y.outbound,f=y.extractKey,g=200,y=t.db._options.modifyChunkSize;y&&(g=typeof y=="object"?y[u.name]||y["*"]||200:y);function _(w,A){var I=A.failures,A=A.numFailures;k+=w-A;for(var S=0,O=m(I);S<O.length;S++){var P=O[S];p.push(I[P])}}var p=[],k=0,v=[],b=e===Bo;return t.clone().primaryKeys().then(function(w){function x(A){var S=Math.min(g,w.length-A),O=w.slice(A,A+S);return(b?Promise.resolve([]):u.getMany({trans:a,keys:O,cache:"immutable"})).then(function(P){var j=[],D=[],M=d?[]:null,z=b?O:[];if(!b)for(var B=0;B<S;++B){var L=P[B],G={value:ae(L),primKey:w[A+B]};s.call(G,G.value,G)!==!1&&(G.value==null?z.push(w[A+B]):d||te(f(L),f(G.value))===0?(D.push(G.value),d&&M.push(w[A+B])):(z.push(w[A+B]),j.push(G.value)))}return Promise.resolve(0<j.length&&u.mutate({trans:a,type:"add",values:j}).then(function(J){for(var ee in J.failures)z.splice(parseInt(ee),1);_(j.length,J)})).then(function(){return(0<D.length||I&&typeof e=="object")&&u.mutate({trans:a,type:"put",keys:M,values:D,criteria:I,changeSpec:typeof e!="function"&&e,isAdditionalChunk:0<A}).then(function(J){return _(D.length,J)})}).then(function(){return(0<z.length||I&&b)&&u.mutate({trans:a,type:"delete",keys:z,criteria:I,isAdditionalChunk:0<A}).then(function(J){return Sn(r.table,z,J)}).then(function(J){return _(z.length,J)})}).then(function(){return w.length>A+S&&x(A+g)})})}var I=Lt(r)&&r.limit===1/0&&(typeof e!="function"||b)&&{index:r.index,range:r.range};return x(0).then(function(){if(0<p.length)throw new mn("Error modifying one or more objects",p,k,v);return w.length})})})},ne.prototype.delete=function(){var e=this._ctx,t=e.range;return!Lt(e)||e.table.schema.yProps||!e.isPrimKey&&t.type!==3?this.modify(Bo):this._write(function(r){var a=e.table.core.schema.primaryKey,s=t;return e.table.core.count({trans:r,query:{index:a,range:s}}).then(function(u){return e.table.core.mutate({trans:r,type:"deleteRange",range:s}).then(function(g){var f=g.failures,g=g.numFailures;if(g)throw new mn("Could not delete some values",Object.keys(f).map(function(y){return f[y]}),u-g);return u-g})})})},ne);function ne(){}var Bo=function(e,t){return t.value=null};function Ma(e,t){return e<t?-1:e===t?0:1}function Ba(e,t){return t<e?-1:e===t?0:1}function ze(e,t,r){return e=e instanceof jo?new e.Collection(e):e,e._ctx.error=new(r||TypeError)(t),e}function Kt(e){return new e.Collection(e,function(){return Ro("")}).limit(0)}function Tn(e,t,r,a){var s,u,d,f,g,y,_,p=r.length;if(!r.every(function(b){return typeof b=="string"}))return ze(e,Io);function k(b){s=b==="next"?function(x){return x.toUpperCase()}:function(x){return x.toLowerCase()},u=b==="next"?function(x){return x.toLowerCase()}:function(x){return x.toUpperCase()},d=b==="next"?Ma:Ba;var w=r.map(function(x){return{lower:u(x),upper:s(x)}}).sort(function(x,I){return d(x.lower,I.lower)});f=w.map(function(x){return x.upper}),g=w.map(function(x){return x.lower}),_=(y=b)==="next"?"":a}k("next"),e=new e.Collection(e,function(){return at(f[0],g[p-1]+a)}),e._ondirectionchange=function(b){k(b)};var v=0;return e._addAlgorithm(function(b,w,x){var I=b.key;if(typeof I!="string")return!1;var A=u(I);if(t(A,g,v))return!0;for(var S=null,O=v;O<p;++O){var P=function(j,D,M,z,B,L){for(var G=Math.min(j.length,z.length),J=-1,ee=0;ee<G;++ee){var Fe=D[ee];if(Fe!==z[ee])return B(j[ee],M[ee])<0?j.substr(0,ee)+M[ee]+M.substr(ee+1):B(j[ee],z[ee])<0?j.substr(0,ee)+z[ee]+M.substr(ee+1):0<=J?j.substr(0,J)+D[J]+M.substr(J+1):null;B(j[ee],Fe)<0&&(J=ee)}return G<z.length&&L==="next"?j+M.substr(j.length):G<j.length&&L==="prev"?j.substr(0,M.length):J<0?null:j.substr(0,J)+z[J]+M.substr(J+1)}(I,A,f[O],g[O],d,y);P===null&&S===null?v=O+1:(S===null||0<d(S,P))&&(S=P)}return w(S!==null?function(){b.continue(S+_)}:x),!1}),e}function at(e,t,r,a){return{type:2,lower:e,upper:t,lowerOpen:r,upperOpen:a}}function Ro(e){return{type:1,lower:e,upper:e}}var jo=(Object.defineProperty(Ee.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Ee.prototype.between=function(e,t,r,a){r=r!==!1,a=a===!0;try{return 0<this._cmp(e,t)||this._cmp(e,t)===0&&(r||a)&&(!r||!a)?Kt(this):new this.Collection(this,function(){return at(e,t,!r,!a)})}catch{return ze(this,Ze)}},Ee.prototype.equals=function(e){return e==null?ze(this,Ze):new this.Collection(this,function(){return Ro(e)})},Ee.prototype.above=function(e){return e==null?ze(this,Ze):new this.Collection(this,function(){return at(e,void 0,!0)})},Ee.prototype.aboveOrEqual=function(e){return e==null?ze(this,Ze):new this.Collection(this,function(){return at(e,void 0,!1)})},Ee.prototype.below=function(e){return e==null?ze(this,Ze):new this.Collection(this,function(){return at(void 0,e,!1,!0)})},Ee.prototype.belowOrEqual=function(e){return e==null?ze(this,Ze):new this.Collection(this,function(){return at(void 0,e)})},Ee.prototype.startsWith=function(e){return typeof e!="string"?ze(this,Io):this.between(e,e+xt,!0,!0)},Ee.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):Tn(this,function(t,r){return t.indexOf(r[0])===0},[e],xt)},Ee.prototype.equalsIgnoreCase=function(e){return Tn(this,function(t,r){return t===r[0]},[e],"")},Ee.prototype.anyOfIgnoreCase=function(){var e=Qe.apply(je,arguments);return e.length===0?Kt(this):Tn(this,function(t,r){return r.indexOf(t)!==-1},e,"")},Ee.prototype.startsWithAnyOfIgnoreCase=function(){var e=Qe.apply(je,arguments);return e.length===0?Kt(this):Tn(this,function(t,r){return r.some(function(a){return t.indexOf(a)===0})},e,xt)},Ee.prototype.anyOf=function(){var e=this,t=Qe.apply(je,arguments),r=this._cmp;try{t.sort(r)}catch{return ze(this,Ze)}if(t.length===0)return Kt(this);var a=new this.Collection(this,function(){return at(t[0],t[t.length-1])});a._ondirectionchange=function(u){r=u==="next"?e._ascending:e._descending,t.sort(r)};var s=0;return a._addAlgorithm(function(u,d,f){for(var g=u.key;0<r(g,t[s]);)if(++s===t.length)return d(f),!1;return r(g,t[s])===0||(d(function(){u.continue(t[s])}),!1)}),a},Ee.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Ee.prototype.noneOf=function(){var e=Qe.apply(je,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return ze(this,Ze)}var t=e.reduce(function(r,a){return r?r.concat([[r[r.length-1][1],a]]):[[-1/0,a]]},null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},Ee.prototype.inAnyRange=function(I,t){var r=this,a=this._cmp,s=this._ascending,u=this._descending,d=this._min,f=this._max;if(I.length===0)return Kt(this);if(!I.every(function(A){return A[0]!==void 0&&A[1]!==void 0&&s(A[0],A[1])<=0}))return ze(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",V.InvalidArgument);var g=!t||t.includeLowers!==!1,y=t&&t.includeUppers===!0,_,p=s;function k(A,S){return p(A[0],S[0])}try{(_=I.reduce(function(A,S){for(var O=0,P=A.length;O<P;++O){var j=A[O];if(a(S[0],j[1])<0&&0<a(S[1],j[0])){j[0]=d(j[0],S[0]),j[1]=f(j[1],S[1]);break}}return O===P&&A.push(S),A},[])).sort(k)}catch{return ze(this,Ze)}var v=0,b=y?function(A){return 0<s(A,_[v][1])}:function(A){return 0<=s(A,_[v][1])},w=g?function(A){return 0<u(A,_[v][0])}:function(A){return 0<=u(A,_[v][0])},x=b,I=new this.Collection(this,function(){return at(_[0][0],_[_.length-1][1],!g,!y)});return I._ondirectionchange=function(A){p=A==="next"?(x=b,s):(x=w,u),_.sort(k)},I._addAlgorithm(function(A,S,O){for(var P,j=A.key;x(j);)if(++v===_.length)return S(O),!1;return!b(P=j)&&!w(P)||(r._cmp(j,_[v][1])===0||r._cmp(j,_[v][0])===0||S(function(){p===s?A.continue(_[v][0]):A.continue(_[v][1])}),!1)}),I},Ee.prototype.startsWithAnyOf=function(){var e=Qe.apply(je,arguments);return e.every(function(t){return typeof t=="string"})?e.length===0?Kt(this):this.inAnyRange(e.map(function(t){return[t,t+xt]})):ze(this,"startsWithAnyOf() only works with strings")},Ee);function Ee(){}function Ge(e){return he(function(t){return tn(t),e(t.target.error),!1})}function tn(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var nn="storagemutated",vr="x-storagemutated-1",st=Xt(null,nn),Ra=(Ye.prototype._lock=function(){return X(!K.global),++this._reculock,this._reculock!==1||K.global||(K.lockOwnerFor=this),this},Ye.prototype._unlock=function(){if(X(!K.global),--this._reculock==0)for(K.global||(K.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{_t(e[1],e[0])}catch{}}return this},Ye.prototype._locked=function(){return this._reculock&&K.lockOwnerFor!==this},Ye.prototype.create=function(e){var t=this;if(!this.mode)return this;var r=this.db.idbdb,a=this.db._state.dbOpenError;if(X(!this.idbtrans),!e&&!r)switch(a&&a.name){case"DatabaseClosedError":throw new V.DatabaseClosed(a);case"MissingAPIError":throw new V.MissingAPI(a.message,a);default:throw new V.OpenFailed(a)}if(!this.active)throw new V.TransactionInactive;return X(this._completion._state===null),(e=this.idbtrans=e||(this.db.core||r).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=he(function(s){tn(s),t._reject(e.error)}),e.onabort=he(function(s){tn(s),t.active&&t._reject(new V.Abort(e.error)),t.active=!1,t.on("abort").fire(s)}),e.oncomplete=he(function(){t.active=!1,t._resolve(),"mutatedParts"in e&&st.storagemutated.fire(e.mutatedParts)}),this},Ye.prototype._promise=function(e,t,r){var a=this;if(e==="readwrite"&&this.mode!=="readwrite")return ge(new V.ReadOnly("Transaction is readonly"));if(!this.active)return ge(new V.TransactionInactive);if(this._locked())return new N(function(u,d){a._blockedFuncs.push([function(){a._promise(e,t,r).then(u,d)},K])});if(r)return rt(function(){var u=new N(function(d,f){a._lock();var g=t(d,f,a);g&&g.then&&g.then(d,f)});return u.finally(function(){return a._unlock()}),u._lib=!0,u});var s=new N(function(u,d){var f=t(u,d,a);f&&f.then&&f.then(u,d)});return s._lib=!0,s},Ye.prototype._root=function(){return this.parent?this.parent._root():this},Ye.prototype.waitFor=function(e){var t,r=this._root(),a=N.resolve(e);r._waitingFor?r._waitingFor=r._waitingFor.then(function(){return a}):(r._waitingFor=a,r._waitingQueue=[],t=r.idbtrans.objectStore(r.storeNames[0]),function u(){for(++r._spinCount;r._waitingQueue.length;)r._waitingQueue.shift()();r._waitingFor&&(t.get(-1/0).onsuccess=u)}());var s=r._waitingFor;return new N(function(u,d){a.then(function(f){return r._waitingQueue.push(he(u.bind(null,f)))},function(f){return r._waitingQueue.push(he(d.bind(null,f)))}).finally(function(){r._waitingFor===s&&(r._waitingFor=null)})})},Ye.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new V.Abort))},Ye.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if($(t,e))return t[e];var r=this.schema[e];if(!r)throw new V.NotFound("Table "+e+" not part of transaction");return r=new this.db.Table(e,r,this),r.core=this.db.core.table(e),t[e]=r},Ye);function Ye(){}function br(e,t,r,a,s,u,d,f){return{name:e,keyPath:t,unique:r,multi:a,auto:s,compound:u,src:(r&&!d?"&":"")+(a?"*":"")+(s?"++":"")+zo(t),type:f}}function zo(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function wr(e,t,r){return{name:e,primKey:t,indexes:r,mappedClass:null,idxByName:(a=function(s){return[s.name,s]},r.reduce(function(s,u,d){return d=a(u,d),d&&(s[d[0]]=d[1]),s},{}))};var a}var rn=function(e){try{return e.only([[]]),rn=function(){return[[]]},[[]]}catch{return rn=function(){return xt},xt}};function _r(e){return e==null?function(){}:typeof e=="string"?(t=e).split(".").length===1?function(r){return r[t]}:function(r){return Ie(r,t)}:function(r){return Ie(r,e)};var t}function Fo(e){return[].slice.call(e)}var ja=0;function on(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function za(e,t,g){function a(x){if(x.type===3)return null;if(x.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var v=x.lower,b=x.upper,w=x.lowerOpen,x=x.upperOpen;return v===void 0?b===void 0?null:t.upperBound(b,!!x):b===void 0?t.lowerBound(v,!!w):t.bound(v,b,!!w,!!x)}function s(k){var v,b=k.name;return{name:b,schema:k,mutate:function(w){var x=w.trans,I=w.type,A=w.keys,S=w.values,O=w.range;return new Promise(function(P,j){P=he(P);var D=x.objectStore(b),M=D.keyPath==null,z=I==="put"||I==="add";if(!z&&I!=="delete"&&I!=="deleteRange")throw new Error("Invalid operation type: "+I);var B,L=(A||S||{length:1}).length;if(A&&S&&A.length!==S.length)throw new Error("Given keys array must have same length as given values array.");if(L===0)return P({numFailures:0,failures:{},results:[],lastResult:void 0});function G(Pe){++Fe,tn(Pe)}var J=[],ee=[],Fe=0;if(I==="deleteRange"){if(O.type===4)return P({numFailures:Fe,failures:ee,results:[],lastResult:void 0});O.type===3?J.push(B=D.clear()):J.push(B=D.delete(a(O)))}else{var M=z?M?[S,A]:[S,null]:[A,null],W=M[0],Te=M[1];if(z)for(var De=0;De<L;++De)J.push(B=Te&&Te[De]!==void 0?D[I](W[De],Te[De]):D[I](W[De])),B.onerror=G;else for(De=0;De<L;++De)J.push(B=D[I](W[De])),B.onerror=G}function Ln(Pe){Pe=Pe.target.result,J.forEach(function(At,Fr){return At.error!=null&&(ee[Fr]=At.error)}),P({numFailures:Fe,failures:ee,results:I==="delete"?A:J.map(function(At){return At.result}),lastResult:Pe})}B.onerror=function(Pe){G(Pe),Ln(Pe)},B.onsuccess=Ln})},getMany:function(w){var x=w.trans,I=w.keys;return new Promise(function(A,S){A=he(A);for(var O,P=x.objectStore(b),j=I.length,D=new Array(j),M=0,z=0,B=function(J){J=J.target,D[J._pos]=J.result,++z===M&&A(D)},L=Ge(S),G=0;G<j;++G)I[G]!=null&&((O=P.get(I[G]))._pos=G,O.onsuccess=B,O.onerror=L,++M);M===0&&A(D)})},get:function(w){var x=w.trans,I=w.key;return new Promise(function(A,S){A=he(A);var O=x.objectStore(b).get(I);O.onsuccess=function(P){return A(P.target.result)},O.onerror=Ge(S)})},query:(v=y,function(w){return new Promise(function(x,I){x=he(x);var A,S,O,M=w.trans,P=w.values,j=w.limit,B=w.query,D=j===1/0?void 0:j,z=B.index,B=B.range,M=M.objectStore(b),z=z.isPrimaryKey?M:M.index(z.name),B=a(B);if(j===0)return x({result:[]});v?((D=P?z.getAll(B,D):z.getAllKeys(B,D)).onsuccess=function(L){return x({result:L.target.result})},D.onerror=Ge(I)):(A=0,S=!P&&"openKeyCursor"in z?z.openKeyCursor(B):z.openCursor(B),O=[],S.onsuccess=function(L){var G=S.result;return G?(O.push(P?G.value:G.primaryKey),++A===j?x({result:O}):void G.continue()):x({result:O})},S.onerror=Ge(I))})}),openCursor:function(w){var x=w.trans,I=w.values,A=w.query,S=w.reverse,O=w.unique;return new Promise(function(P,j){P=he(P);var z=A.index,D=A.range,M=x.objectStore(b),M=z.isPrimaryKey?M:M.index(z.name),z=S?O?"prevunique":"prev":O?"nextunique":"next",B=!I&&"openKeyCursor"in M?M.openKeyCursor(a(D),z):M.openCursor(a(D),z);B.onerror=Ge(j),B.onsuccess=he(function(L){var G,J,ee,Fe,W=B.result;W?(W.___id=++ja,W.done=!1,G=W.continue.bind(W),J=(J=W.continuePrimaryKey)&&J.bind(W),ee=W.advance.bind(W),Fe=function(){throw new Error("Cursor not stopped")},W.trans=x,W.stop=W.continue=W.continuePrimaryKey=W.advance=function(){throw new Error("Cursor not started")},W.fail=he(j),W.next=function(){var Te=this,De=1;return this.start(function(){return De--?Te.continue():Te.stop()}).then(function(){return Te})},W.start=function(Te){function De(){if(B.result)try{Te()}catch(Pe){W.fail(Pe)}else W.done=!0,W.start=function(){throw new Error("Cursor behind last entry")},W.stop()}var Ln=new Promise(function(Pe,At){Pe=he(Pe),B.onerror=Ge(At),W.fail=At,W.stop=function(Fr){W.stop=W.continue=W.continuePrimaryKey=W.advance=Fe,Pe(Fr)}});return B.onsuccess=he(function(Pe){B.onsuccess=De,De()}),W.continue=G,W.continuePrimaryKey=J,W.advance=ee,De(),Ln},P(W)):P(null)},j)})},count:function(w){var x=w.query,I=w.trans,A=x.index,S=x.range;return new Promise(function(O,P){var j=I.objectStore(b),D=A.isPrimaryKey?j:j.index(A.name),j=a(S),D=j?D.count(j):D.count();D.onsuccess=he(function(M){return O(M.target.result)}),D.onerror=Ge(P)})}}}var u,d,f,_=(d=g,f=Fo((u=e).objectStoreNames),{schema:{name:u.name,tables:f.map(function(k){return d.objectStore(k)}).map(function(k){var v=k.keyPath,x=k.autoIncrement,b=E(v),w={},x={name:k.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:v==null,compound:b,keyPath:v,autoIncrement:x,unique:!0,extractKey:_r(v)},indexes:Fo(k.indexNames).map(function(I){return k.index(I)}).map(function(O){var A=O.name,S=O.unique,P=O.multiEntry,O=O.keyPath,P={name:A,compound:E(O),keyPath:O,unique:S,multiEntry:P,extractKey:_r(O)};return w[on(O)]=P}),getIndexByKeyPath:function(I){return w[on(I)]}};return w[":id"]=x.primaryKey,v!=null&&(w[on(v)]=x.primaryKey),x})},hasGetAll:0<f.length&&"getAll"in d.objectStore(f[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),g=_.schema,y=_.hasGetAll,_=g.tables.map(s),p={};return _.forEach(function(k){return p[k.name]=k}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(k){if(!p[k])throw new Error("Table '".concat(k,"' not found"));return p[k]},MIN_KEY:-1/0,MAX_KEY:rn(t),schema:g}}function Fa(e,t,r,a){var s=r.IDBKeyRange;return r.indexedDB,{dbcore:(a=za(t,s,a),e.dbcore.reduce(function(u,d){return d=d.create,c(c({},u),d(u))},a))}}function Dn(e,a){var r=a.db,a=Fa(e._middlewares,r,e._deps,a);e.core=a.dbcore,e.tables.forEach(function(s){var u=s.name;e.core.schema.tables.some(function(d){return d.name===u})&&(s.core=e.core.table(u),e[u]instanceof e.Table&&(e[u].core=s.core))})}function Pn(e,t,r,a){r.forEach(function(s){var u=a[s];t.forEach(function(d){var f=function g(y,_){return ve(y,_)||(y=q(y))&&g(y,_)}(d,s);(!f||"value"in f&&f.value===void 0)&&(d===e.Transaction.prototype||d instanceof e.Transaction?de(d,s,{get:function(){return this.table(s)},set:function(g){Y(this,s,{value:g,writable:!0,configurable:!0,enumerable:!0})}}):d[s]=new e.Table(s,u))})})}function xr(e,t){t.forEach(function(r){for(var a in r)r[a]instanceof e.Table&&delete r[a]})}function $a(e,t){return e._cfg.version-t._cfg.version}function Na(e,t,r,a){var s=e._dbSchema;r.objectStoreNames.contains("$meta")&&!s.$meta&&(s.$meta=wr("$meta",No("")[0],[]),e._storeNames.push("$meta"));var u=e._createTransaction("readwrite",e._storeNames,s);u.create(r),u._completion.catch(a);var d=u._reject.bind(u),f=K.transless||K;rt(function(){return K.trans=u,K.transless=f,t!==0?(Dn(e,r),y=t,((g=u).storeNames.includes("$meta")?g.table("$meta").get("version").then(function(_){return _??y}):N.resolve(y)).then(function(_){return k=_,v=u,b=r,w=[],_=(p=e)._versions,x=p._dbSchema=Mn(0,p.idbdb,b),(_=_.filter(function(I){return I._cfg.version>=k})).length!==0?(_.forEach(function(I){w.push(function(){var A=x,S=I._cfg.dbschema;Bn(p,A,b),Bn(p,S,b),x=p._dbSchema=S;var O=kr(A,S);O.add.forEach(function(z){Er(b,z[0],z[1].primKey,z[1].indexes)}),O.change.forEach(function(z){if(z.recreate)throw new V.Upgrade("Not yet support for changing primary key");var B=b.objectStore(z.name);z.add.forEach(function(L){return qn(B,L)}),z.change.forEach(function(L){B.deleteIndex(L.name),qn(B,L)}),z.del.forEach(function(L){return B.deleteIndex(L)})});var P=I._cfg.contentUpgrade;if(P&&I._cfg.version>k){Dn(p,b),v._memoizedTables={};var j=He(S);O.del.forEach(function(z){j[z]=A[z]}),xr(p,[p.Transaction.prototype]),Pn(p,[p.Transaction.prototype],m(j),j),v.schema=j;var D,M=rr(P);return M&&$t(),O=N.follow(function(){var z;(D=P(v))&&M&&(z=ot.bind(null,null),D.then(z,z))}),D&&typeof D.then=="function"?N.resolve(D):O.then(function(){return D})}}),w.push(function(A){var S,O,P=I._cfg.dbschema;S=P,O=A,[].slice.call(O.db.objectStoreNames).forEach(function(j){return S[j]==null&&O.db.deleteObjectStore(j)}),xr(p,[p.Transaction.prototype]),Pn(p,[p.Transaction.prototype],p._storeNames,p._dbSchema),v.schema=p._dbSchema}),w.push(function(A){p.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(p.idbdb.version/10)===I._cfg.version?(p.idbdb.deleteObjectStore("$meta"),delete p._dbSchema.$meta,p._storeNames=p._storeNames.filter(function(S){return S!=="$meta"})):A.objectStore("$meta").put(I._cfg.version,"version"))})}),function I(){return w.length?N.resolve(w.shift()(v.idbtrans)).then(I):N.resolve()}().then(function(){$o(x,b)})):N.resolve();var p,k,v,b,w,x}).catch(d)):(m(s).forEach(function(_){Er(r,_,s[_].primKey,s[_].indexes)}),Dn(e,r),void N.follow(function(){return e.on.populate.fire(u)}).catch(d));var g,y})}function La(e,t){$o(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var r=Mn(0,e.idbdb,t);Bn(e,e._dbSchema,t);for(var a=0,s=kr(r,e._dbSchema).change;a<s.length;a++){var u=function(d){if(d.change.length||d.recreate)return console.warn("Unable to patch indexes of table ".concat(d.name," because it has changes on the type of index or primary key.")),{value:void 0};var f=t.objectStore(d.name);d.add.forEach(function(g){We&&console.debug("Dexie upgrade patch: Creating missing index ".concat(d.name,".").concat(g.src)),qn(f,g)})}(s[a]);if(typeof u=="object")return u.value}}function kr(e,t){var r,a={del:[],add:[],change:[]};for(r in e)t[r]||a.del.push(r);for(r in t){var s=e[r],u=t[r];if(s){var d={name:r,def:u,recreate:!1,del:[],add:[],change:[]};if(""+(s.primKey.keyPath||"")!=""+(u.primKey.keyPath||"")||s.primKey.auto!==u.primKey.auto)d.recreate=!0,a.change.push(d);else{var f=s.idxByName,g=u.idxByName,y=void 0;for(y in f)g[y]||d.del.push(y);for(y in g){var _=f[y],p=g[y];_?_.src!==p.src&&d.change.push(p):d.add.push(p)}(0<d.del.length||0<d.add.length||0<d.change.length)&&a.change.push(d)}}else a.add.push([r,u])}return a}function Er(e,t,r,a){var s=e.db.createObjectStore(t,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return a.forEach(function(u){return qn(s,u)}),s}function $o(e,t){m(e).forEach(function(r){t.db.objectStoreNames.contains(r)||(We&&console.debug("Dexie: Creating missing table",r),Er(t,r,e[r].primKey,e[r].indexes))})}function qn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function Mn(e,t,r){var a={};return be(t.objectStoreNames,0).forEach(function(s){for(var u=r.objectStore(s),d=br(zo(y=u.keyPath),y||"",!0,!1,!!u.autoIncrement,y&&typeof y!="string",!0),f=[],g=0;g<u.indexNames.length;++g){var _=u.index(u.indexNames[g]),y=_.keyPath,_=br(_.name,y,!!_.unique,!!_.multiEntry,!1,y&&typeof y!="string",!1);f.push(_)}a[s]=wr(s,d,f)}),a}function Bn(e,t,r){for(var a=r.db.objectStoreNames,s=0;s<a.length;++s){var u=a[s],d=r.objectStore(u);e._hasGetAll="getAll"in d;for(var f=0;f<d.indexNames.length;++f){var g=d.indexNames[f],y=d.index(g).keyPath,_=typeof y=="string"?y:"["+be(y).join("+")+"]";!t[u]||(y=t[u].idxByName[_])&&(y.name=g,delete t[u].idxByName[_],t[u].idxByName[g]=y)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&h.WorkerGlobalScope&&h instanceof h.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function No(e){return e.split(",").map(function(t,r){var u=t.split(":"),a=(s=u[1])===null||s===void 0?void 0:s.trim(),s=(t=u[0].trim()).replace(/([&*]|\+\+)/g,""),u=/^\[/.test(s)?s.match(/^\[(.*)\]$/)[1].split("+"):s;return br(s,u||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),E(u),r===0,a)})}var Ka=(Vt.prototype._createTableSchema=wr,Vt.prototype._parseIndexSyntax=No,Vt.prototype._parseStoresSpec=function(e,t){var r=this;m(e).forEach(function(a){if(e[a]!==null){var s=r._parseIndexSyntax(e[a]),u=s.shift();if(!u)throw new V.Schema("Invalid schema for table "+a+": "+e[a]);if(u.unique=!0,u.multi)throw new V.Schema("Primary key cannot be multiEntry*");s.forEach(function(d){if(d.auto)throw new V.Schema("Only primary key can be marked as autoIncrement (++)");if(!d.keyPath)throw new V.Schema("Index must have a name and cannot be an empty string")}),s=r._createTableSchema(a,u,s),t[a]=s}})},Vt.prototype.stores=function(r){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?C(this._cfg.storesSource,r):r;var r=t._versions,a={},s={};return r.forEach(function(u){C(a,u._cfg.storesSource),s=u._cfg.dbschema={},u._parseStoresSpec(a,s)}),t._dbSchema=s,xr(t,[t._allTables,t,t.Transaction.prototype]),Pn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],m(s),s),t._storeNames=m(s),this},Vt.prototype.upgrade=function(e){return this._cfg.contentUpgrade=ir(this._cfg.contentUpgrade||ie,e),this},Vt);function Vt(){}function Ir(e,t){var r=e._dbNamesDB;return r||(r=e._dbNamesDB=new Xe(In,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),r.table("dbnames")}function Ar(e){return e&&typeof e.databases=="function"}function Sr(e){return rt(function(){return K.letThrough=!0,e()})}function Cr(e){return!("from"in e)}var Oe=function(e,t){if(!this){var r=new Oe;return e&&"d"in e&&C(r,e),r}C(this,arguments.length?{d:1,from:e,to:1<arguments.length?t:e}:{d:0})};function an(e,t,r){var a=te(t,r);if(!isNaN(a)){if(0<a)throw RangeError();if(Cr(e))return C(e,{from:t,to:r,d:1});var s=e.l,a=e.r;if(te(r,e.from)<0)return s?an(s,t,r):e.l={from:t,to:r,d:1,l:null,r:null},Ko(e);if(0<te(t,e.to))return a?an(a,t,r):e.r={from:t,to:r,d:1,l:null,r:null},Ko(e);te(t,e.from)<0&&(e.from=t,e.l=null,e.d=a?a.d+1:1),0<te(r,e.to)&&(e.to=r,e.r=null,e.d=e.l?e.l.d+1:1),r=!e.r,s&&!e.l&&sn(e,s),a&&r&&sn(e,a)}}function sn(e,t){Cr(t)||function r(a,g){var u=g.from,d=g.to,f=g.l,g=g.r;an(a,u,d),f&&r(a,f),g&&r(a,g)}(e,t)}function Lo(e,t){var r=Rn(t),a=r.next();if(a.done)return!1;for(var s=a.value,u=Rn(e),d=u.next(s.from),f=d.value;!a.done&&!d.done;){if(te(f.from,s.to)<=0&&0<=te(f.to,s.from))return!0;te(s.from,f.from)<0?s=(a=r.next(f.from)).value:f=(d=u.next(s.from)).value}return!1}function Rn(e){var t=Cr(e)?null:{s:0,n:e};return{next:function(r){for(var a=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,a)for(;t.n.l&&te(r,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!a||te(r,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function Ko(e){var t,r,a=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((r=e.l)===null||r===void 0?void 0:r.d)||0),s=1<a?"r":a<-1?"l":"";s&&(t=s=="r"?"l":"r",r=c({},e),a=e[s],e.from=a.from,e.to=a.to,e[s]=a[s],r[s]=a[t],(e[t]=r).d=Vo(r)),e.d=Vo(e)}function Vo(r){var t=r.r,r=r.l;return(t?r?Math.max(t.d,r.d):t.d:r?r.d:0)+1}function jn(e,t){return m(t).forEach(function(r){e[r]?sn(e[r],t[r]):e[r]=function a(s){var u,d,f={};for(u in s)$(s,u)&&(d=s[u],f[u]=!d||typeof d!="object"||H.has(d.constructor)?d:a(d));return f}(t[r])}),e}function Or(e,t){return e.all||t.all||Object.keys(e).some(function(r){return t[r]&&Lo(t[r],e[r])})}F(Oe.prototype,((Ne={add:function(e){return sn(this,e),this},addKey:function(e){return an(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(r){return an(t,r,r)}),this},hasKey:function(e){var t=Rn(this).next(e).value;return t&&te(t.from,e)<=0&&0<=te(t.to,e)}})[we]=function(){return Rn(this)},Ne));var Et={},Tr={},Dr=!1;function zn(e){jn(Tr,e),Dr||(Dr=!0,setTimeout(function(){Dr=!1,Pr(Tr,!(Tr={}))},0))}function Pr(e,t){t===void 0&&(t=!1);var r=new Set;if(e.all)for(var a=0,s=Object.values(Et);a<s.length;a++)Uo(d=s[a],e,r,t);else for(var u in e){var d,f=/^idb\:\/\/(.*)\/(.*)\//.exec(u);f&&(u=f[1],f=f[2],(d=Et["idb://".concat(u,"/").concat(f)])&&Uo(d,e,r,t))}r.forEach(function(g){return g()})}function Uo(e,t,r,a){for(var s=[],u=0,d=Object.entries(e.queries.query);u<d.length;u++){for(var f=d[u],g=f[0],y=[],_=0,p=f[1];_<p.length;_++){var k=p[_];Or(t,k.obsSet)?k.subscribers.forEach(function(x){return r.add(x)}):a&&y.push(k)}a&&s.push([g,y])}if(a)for(var v=0,b=s;v<b.length;v++){var w=b[v],g=w[0],y=w[1];e.queries.query[g]=y}}function Va(e){var t=e._state,r=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?ge(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var a=t.openCanceller,s=Math.round(10*e.verno),u=!1;function d(){if(t.openCanceller!==a)throw new V.DatabaseClosed("db.open() was cancelled")}function f(){return new N(function(k,v){if(d(),!r)throw new V.MissingAPI;var b=e.name,w=t.autoSchema||!s?r.open(b):r.open(b,s);if(!w)throw new V.MissingAPI;w.onerror=Ge(v),w.onblocked=he(e._fireOnBlocked),w.onupgradeneeded=he(function(x){var I;_=w.transaction,t.autoSchema&&!e._options.allowEmptyDB?(w.onerror=tn,_.abort(),w.result.close(),(I=r.deleteDatabase(b)).onsuccess=I.onerror=he(function(){v(new V.NoSuchDatabase("Database ".concat(b," doesnt exist")))})):(_.onerror=Ge(v),x=x.oldVersion>Math.pow(2,62)?0:x.oldVersion,p=x<1,e.idbdb=w.result,u&&La(e,_),Na(e,x/10,_,v))},v),w.onsuccess=he(function(){_=null;var x,I,A,S,O,P=e.idbdb=w.result,j=be(P.objectStoreNames);if(0<j.length)try{var D=P.transaction((S=j).length===1?S[0]:S,"readonly");if(t.autoSchema)I=P,A=D,(x=e).verno=I.version/10,A=x._dbSchema=Mn(0,I,A),x._storeNames=be(I.objectStoreNames,0),Pn(x,[x._allTables],m(A),A);else if(Bn(e,e._dbSchema,D),((O=kr(Mn(0,(O=e).idbdb,D),O._dbSchema)).add.length||O.change.some(function(M){return M.add.length||M.change.length}))&&!u)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),P.close(),s=P.version+1,u=!0,k(f());Dn(e,D)}catch{}Nt.push(e),P.onversionchange=he(function(M){t.vcFired=!0,e.on("versionchange").fire(M)}),P.onclose=he(function(){e.close({disableAutoOpen:!1})}),p&&(O=e._deps,D=b,P=O.indexedDB,O=O.IDBKeyRange,Ar(P)||D===In||Ir(P,O).put({name:D}).catch(ie)),k()},v)}).catch(function(k){switch(k==null?void 0:k.name){case"UnknownError":if(0<t.PR1398_maxLoop)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),f();break;case"VersionError":if(0<s)return s=0,f()}return N.reject(k)})}var g,y=t.dbReadyResolve,_=null,p=!1;return N.race([a,(typeof navigator>"u"?N.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(k){function v(){return indexedDB.databases().finally(k)}g=setInterval(v,100),v()}).finally(function(){return clearInterval(g)}):Promise.resolve()).then(f)]).then(function(){return d(),t.onReadyBeingFired=[],N.resolve(Sr(function(){return e.on.ready.fire(e.vip)})).then(function k(){if(0<t.onReadyBeingFired.length){var v=t.onReadyBeingFired.reduce(ir,ie);return t.onReadyBeingFired=[],N.resolve(Sr(function(){return v(e.vip)})).then(k)}})}).finally(function(){t.openCanceller===a&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(k){t.dbOpenError=k;try{_&&_.abort()}catch{}return a===t.openCanceller&&e._close(),ge(k)}).finally(function(){t.openComplete=!0,y()}).then(function(){var k;return p&&(k={},e.tables.forEach(function(v){v.schema.indexes.forEach(function(b){b.name&&(k["idb://".concat(e.name,"/").concat(v.name,"/").concat(b.name)]=new Oe(-1/0,[[[]]]))}),k["idb://".concat(e.name,"/").concat(v.name,"/")]=k["idb://".concat(e.name,"/").concat(v.name,"/:dels")]=new Oe(-1/0,[[[]]])}),st(nn).fire(k),Pr(k,!0)),e})}function qr(e){function t(u){return e.next(u)}var r=s(t),a=s(function(u){return e.throw(u)});function s(u){return function(g){var f=u(g),g=f.value;return f.done?g:g&&typeof g.then=="function"?g.then(r,a):E(g)?Promise.all(g).then(r,a):r(g)}}return s(t)()}function Fn(e,t,r){for(var a=E(e)?e.slice():[e],s=0;s<r;++s)a.push(t);return a}var Ua={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return c(c({},e),{table:function(t){var r=e.table(t),a=r.schema,s={},u=[];function d(p,k,v){var b=on(p),w=s[b]=s[b]||[],x=p==null?0:typeof p=="string"?1:p.length,I=0<k,I=c(c({},v),{name:I?"".concat(b,"(virtual-from:").concat(v.name,")"):v.name,lowLevelIndex:v,isVirtual:I,keyTail:k,keyLength:x,extractKey:_r(p),unique:!I&&v.unique});return w.push(I),I.isPrimaryKey||u.push(I),1<x&&d(x===2?p[0]:p.slice(0,x-1),k+1,v),w.sort(function(A,S){return A.keyTail-S.keyTail}),I}t=d(a.primaryKey.keyPath,0,a.primaryKey),s[":id"]=[t];for(var f=0,g=a.indexes;f<g.length;f++){var y=g[f];d(y.keyPath,0,y)}function _(p){var k,v=p.query.index;return v.isVirtual?c(c({},p),{query:{index:v.lowLevelIndex,range:(k=p.query.range,v=v.keyTail,{type:k.type===1?2:k.type,lower:Fn(k.lower,k.lowerOpen?e.MAX_KEY:e.MIN_KEY,v),lowerOpen:!0,upper:Fn(k.upper,k.upperOpen?e.MIN_KEY:e.MAX_KEY,v),upperOpen:!0})}}):p}return c(c({},r),{schema:c(c({},a),{primaryKey:t,indexes:u,getIndexByKeyPath:function(p){return(p=s[on(p)])&&p[0]}}),count:function(p){return r.count(_(p))},query:function(p){return r.query(_(p))},openCursor:function(p){var k=p.query.index,v=k.keyTail,b=k.isVirtual,w=k.keyLength;return b?r.openCursor(_(p)).then(function(I){return I&&x(I)}):r.openCursor(p);function x(I){return Object.create(I,{continue:{value:function(A){A!=null?I.continue(Fn(A,p.reverse?e.MAX_KEY:e.MIN_KEY,v)):p.unique?I.continue(I.key.slice(0,w).concat(p.reverse?e.MIN_KEY:e.MAX_KEY,v)):I.continue()}},continuePrimaryKey:{value:function(A,S){I.continuePrimaryKey(Fn(A,e.MAX_KEY,v),S)}},primaryKey:{get:function(){return I.primaryKey}},key:{get:function(){var A=I.key;return w===1?A[0]:A.slice(0,w)}},value:{get:function(){return I.value}}})}}})}})}};function Mr(e,t,r,a){return r=r||{},a=a||"",m(e).forEach(function(s){var u,d,f;$(t,s)?(u=e[s],d=t[s],typeof u=="object"&&typeof d=="object"&&u&&d?(f=Bt(u))!==Bt(d)?r[a+s]=t[s]:f==="Object"?Mr(u,d,r,a+s+"."):u!==d&&(r[a+s]=t[s]):u!==d&&(r[a+s]=t[s])):r[a+s]=void 0}),m(t).forEach(function(s){$(e,s)||(r[a+s]=t[s])}),r}function Br(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var Ha={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return c(c({},e),{table:function(t){var r=e.table(t),a=r.schema.primaryKey;return c(c({},r),{mutate:function(s){var u=K.trans,d=u.table(t).hook,f=d.deleting,g=d.creating,y=d.updating;switch(s.type){case"add":if(g.fire===ie)break;return u._promise("readwrite",function(){return _(s)},!0);case"put":if(g.fire===ie&&y.fire===ie)break;return u._promise("readwrite",function(){return _(s)},!0);case"delete":if(f.fire===ie)break;return u._promise("readwrite",function(){return _(s)},!0);case"deleteRange":if(f.fire===ie)break;return u._promise("readwrite",function(){return function p(k,v,b){return r.query({trans:k,values:!1,query:{index:a,range:v},limit:b}).then(function(w){var x=w.result;return _({type:"delete",keys:x,trans:k}).then(function(I){return 0<I.numFailures?Promise.reject(I.failures[0]):x.length<b?{failures:[],numFailures:0,lastResult:void 0}:p(k,c(c({},v),{lower:x[x.length-1],lowerOpen:!0}),b)})})}(s.trans,s.range,1e4)},!0)}return r.mutate(s);function _(p){var k,v,b,w=K.trans,x=p.keys||Br(a,p);if(!x)throw new Error("Keys missing");return(p=p.type==="add"||p.type==="put"?c(c({},p),{keys:x}):c({},p)).type!=="delete"&&(p.values=l([],p.values)),p.keys&&(p.keys=l([],p.keys)),k=r,b=x,((v=p).type==="add"?Promise.resolve([]):k.getMany({trans:v.trans,keys:b,cache:"immutable"})).then(function(I){var A=x.map(function(S,O){var P,j,D,M=I[O],z={onerror:null,onsuccess:null};return p.type==="delete"?f.fire.call(z,S,M,w):p.type==="add"||M===void 0?(P=g.fire.call(z,S,p.values[O],w),S==null&&P!=null&&(p.keys[O]=S=P,a.outbound||xe(p.values[O],a.keyPath,S))):(P=Mr(M,p.values[O]),(j=y.fire.call(z,P,S,M,w))&&(D=p.values[O],Object.keys(j).forEach(function(B){$(D,B)?D[B]=j[B]:xe(D,B,j[B])}))),z});return r.mutate(p).then(function(S){for(var O=S.failures,P=S.results,j=S.numFailures,S=S.lastResult,D=0;D<x.length;++D){var M=(P||x)[D],z=A[D];M==null?z.onerror&&z.onerror(O[D]):z.onsuccess&&z.onsuccess(p.type==="put"&&I[D]?p.values[D]:M)}return{failures:O,results:P,numFailures:j,lastResult:S}}).catch(function(S){return A.forEach(function(O){return O.onerror&&O.onerror(S)}),Promise.reject(S)})})}}})}})}};function Ho(e,t,r){try{if(!t||t.keys.length<e.length)return null;for(var a=[],s=0,u=0;s<t.keys.length&&u<e.length;++s)te(t.keys[s],e[u])===0&&(a.push(r?ae(t.values[s]):t.values[s]),++u);return a.length===e.length?a:null}catch{return null}}var Qa={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var r=e.table(t);return c(c({},r),{getMany:function(a){if(!a.cache)return r.getMany(a);var s=Ho(a.keys,a.trans._cache,a.cache==="clone");return s?N.resolve(s):r.getMany(a).then(function(u){return a.trans._cache={keys:a.keys,values:a.cache==="clone"?ae(u):u},u})},mutate:function(a){return a.type!=="add"&&(a.trans._cache=null),r.mutate(a)}})}}}};function Qo(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function Wo(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Wa={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,r=new Oe(e.MIN_KEY,e.MAX_KEY);return c(c({},e),{transaction:function(a,s,u){if(K.subscr&&s!=="readonly")throw new V.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(K.querier));return e.transaction(a,s,u)},table:function(a){var s=e.table(a),u=s.schema,d=u.primaryKey,p=u.indexes,f=d.extractKey,g=d.outbound,y=d.autoIncrement&&p.filter(function(v){return v.compound&&v.keyPath.includes(d.keyPath)}),_=c(c({},s),{mutate:function(v){function b(B){return B="idb://".concat(t,"/").concat(a,"/").concat(B),S[B]||(S[B]=new Oe)}var w,x,I,A=v.trans,S=v.mutatedParts||(v.mutatedParts={}),O=b(""),P=b(":dels"),j=v.type,z=v.type==="deleteRange"?[v.range]:v.type==="delete"?[v.keys]:v.values.length<50?[Br(d,v).filter(function(B){return B}),v.values]:[],D=z[0],M=z[1],z=v.trans._cache;return E(D)?(O.addKeys(D),(z=j==="delete"||D.length===M.length?Ho(D,z):null)||P.addKeys(D),(z||M)&&(w=b,x=z,I=M,u.indexes.forEach(function(B){var L=w(B.name||"");function G(ee){return ee!=null?B.extractKey(ee):null}function J(ee){return B.multiEntry&&E(ee)?ee.forEach(function(Fe){return L.addKey(Fe)}):L.addKey(ee)}(x||I).forEach(function(ee,Te){var W=x&&G(x[Te]),Te=I&&G(I[Te]);te(W,Te)!==0&&(W!=null&&J(W),Te!=null&&J(Te))})}))):D?(M={from:(M=D.lower)!==null&&M!==void 0?M:e.MIN_KEY,to:(M=D.upper)!==null&&M!==void 0?M:e.MAX_KEY},P.add(M),O.add(M)):(O.add(r),P.add(r),u.indexes.forEach(function(B){return b(B.name).add(r)})),s.mutate(v).then(function(B){return!D||v.type!=="add"&&v.type!=="put"||(O.addKeys(B.results),y&&y.forEach(function(L){for(var G=v.values.map(function(W){return L.extractKey(W)}),J=L.keyPath.findIndex(function(W){return W===d.keyPath}),ee=0,Fe=B.results.length;ee<Fe;++ee)G[ee][J]=B.results[ee];b(L.name).addKeys(G)})),A.mutatedParts=jn(A.mutatedParts||{},S),B})}}),p=function(b){var w=b.query,b=w.index,w=w.range;return[b,new Oe((b=w.lower)!==null&&b!==void 0?b:e.MIN_KEY,(w=w.upper)!==null&&w!==void 0?w:e.MAX_KEY)]},k={get:function(v){return[d,new Oe(v.key)]},getMany:function(v){return[d,new Oe().addKeys(v.keys)]},count:p,query:p,openCursor:p};return m(k).forEach(function(v){_[v]=function(b){var w=K.subscr,x=!!w,I=Qo(K,s)&&Wo(v,b)?b.obsSet={}:w;if(x){var A=function(M){return M="idb://".concat(t,"/").concat(a,"/").concat(M),I[M]||(I[M]=new Oe)},S=A(""),O=A(":dels"),w=k[v](b),x=w[0],w=w[1];if((v==="query"&&x.isPrimaryKey&&!b.values?O:A(x.name||"")).add(w),!x.isPrimaryKey){if(v!=="count"){var P=v==="query"&&g&&b.values&&s.query(c(c({},b),{values:!1}));return s[v].apply(this,arguments).then(function(M){if(v==="query"){if(g&&b.values)return P.then(function(G){return G=G.result,S.addKeys(G),M});var z=b.values?M.result.map(f):M.result;(b.values?S:O).addKeys(z)}else if(v==="openCursor"){var B=M,L=b.values;return B&&Object.create(B,{key:{get:function(){return O.addKey(B.primaryKey),B.key}},primaryKey:{get:function(){var G=B.primaryKey;return O.addKey(G),G}},value:{get:function(){return L&&S.addKey(B.primaryKey),B.value}}})}return M})}O.add(r)}}return s[v].apply(this,arguments)}}),_}})}};function Go(e,t,r){if(r.numFailures===0)return t;if(t.type==="deleteRange")return null;var a=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;return r.numFailures===a?null:(t=c({},t),E(t.keys)&&(t.keys=t.keys.filter(function(s,u){return!(u in r.failures)})),"values"in t&&E(t.values)&&(t.values=t.values.filter(function(s,u){return!(u in r.failures)})),t)}function Rr(e,t){return r=e,((a=t).lower===void 0||(a.lowerOpen?0<te(r,a.lower):0<=te(r,a.lower)))&&(e=e,(t=t).upper===void 0||(t.upperOpen?te(e,t.upper)<0:te(e,t.upper)<=0));var r,a}function Yo(e,t,k,a,s,u){if(!k||k.length===0)return e;var d=t.query.index,f=d.multiEntry,g=t.query.range,y=a.schema.primaryKey.extractKey,_=d.extractKey,p=(d.lowLevelIndex||d).extractKey,k=k.reduce(function(v,b){var w=v,x=[];if(b.type==="add"||b.type==="put")for(var I=new Oe,A=b.values.length-1;0<=A;--A){var S,O=b.values[A],P=y(O);I.hasKey(P)||(S=_(O),(f&&E(S)?S.some(function(B){return Rr(B,g)}):Rr(S,g))&&(I.addKey(P),x.push(O)))}switch(b.type){case"add":var j=new Oe().addKeys(t.values?v.map(function(L){return y(L)}):v),w=v.concat(t.values?x.filter(function(L){return L=y(L),!j.hasKey(L)&&(j.addKey(L),!0)}):x.map(function(L){return y(L)}).filter(function(L){return!j.hasKey(L)&&(j.addKey(L),!0)}));break;case"put":var D=new Oe().addKeys(b.values.map(function(L){return y(L)}));w=v.filter(function(L){return!D.hasKey(t.values?y(L):L)}).concat(t.values?x:x.map(function(L){return y(L)}));break;case"delete":var M=new Oe().addKeys(b.keys);w=v.filter(function(L){return!M.hasKey(t.values?y(L):L)});break;case"deleteRange":var z=b.range;w=v.filter(function(L){return!Rr(y(L),z)})}return w},e);return k===e?e:(k.sort(function(v,b){return te(p(v),p(b))||te(y(v),y(b))}),t.limit&&t.limit<1/0&&(k.length>t.limit?k.length=t.limit:e.length===t.limit&&k.length<t.limit&&(s.dirty=!0)),u?Object.freeze(k):k)}function Jo(e,t){return te(e.lower,t.lower)===0&&te(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function Ga(e,t){return function(r,a,s,u){if(r===void 0)return a!==void 0?-1:0;if(a===void 0)return 1;if((a=te(r,a))===0){if(s&&u)return 0;if(s)return 1;if(u)return-1}return a}(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&0<=function(r,a,s,u){if(r===void 0)return a!==void 0?1:0;if(a===void 0)return-1;if((a=te(r,a))===0){if(s&&u)return 0;if(s)return-1;if(u)return 1}return a}(e.upper,t.upper,e.upperOpen,t.upperOpen)}function Ya(e,t,r,a){e.subscribers.add(r),a.addEventListener("abort",function(){var s,u;e.subscribers.delete(r),e.subscribers.size===0&&(s=e,u=t,setTimeout(function(){s.subscribers.size===0&&me(u,s)},3e3))})}var Ja={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name;return c(c({},e),{transaction:function(r,a,s){var u,d,f=e.transaction(r,a,s);return a==="readwrite"&&(d=(u=new AbortController).signal,s=function(g){return function(){if(u.abort(),a==="readwrite"){for(var y=new Set,_=0,p=r;_<p.length;_++){var k=p[_],v=Et["idb://".concat(t,"/").concat(k)];if(v){var b=e.table(k),w=v.optimisticOps.filter(function(L){return L.trans===f});if(f._explicit&&g&&f.mutatedParts)for(var x=0,I=Object.values(v.queries.query);x<I.length;x++)for(var A=0,S=(j=I[x]).slice();A<S.length;A++)Or((D=S[A]).obsSet,f.mutatedParts)&&(me(j,D),D.subscribers.forEach(function(L){return y.add(L)}));else if(0<w.length){v.optimisticOps=v.optimisticOps.filter(function(L){return L.trans!==f});for(var O=0,P=Object.values(v.queries.query);O<P.length;O++)for(var j,D,M,z=0,B=(j=P[O]).slice();z<B.length;z++)(D=B[z]).res!=null&&f.mutatedParts&&(g&&!D.dirty?(M=Object.isFrozen(D.res),M=Yo(D.res,D.req,w,b,D,M),D.dirty?(me(j,D),D.subscribers.forEach(function(L){return y.add(L)})):M!==D.res&&(D.res=M,D.promise=N.resolve({result:M}))):(D.dirty&&me(j,D),D.subscribers.forEach(function(L){return y.add(L)})))}}}y.forEach(function(L){return L()})}}},f.addEventListener("abort",s(!1),{signal:d}),f.addEventListener("error",s(!1),{signal:d}),f.addEventListener("complete",s(!0),{signal:d})),f},table:function(r){var a=e.table(r),s=a.schema.primaryKey;return c(c({},a),{mutate:function(u){var d=K.trans;if(s.outbound||d.db._options.cache==="disabled"||d.explicit||d.idbtrans.mode!=="readwrite")return a.mutate(u);var f=Et["idb://".concat(t,"/").concat(r)];return f?(d=a.mutate(u),u.type!=="add"&&u.type!=="put"||!(50<=u.values.length||Br(s,u).some(function(g){return g==null}))?(f.optimisticOps.push(u),u.mutatedParts&&zn(u.mutatedParts),d.then(function(g){0<g.numFailures&&(me(f.optimisticOps,u),(g=Go(0,u,g))&&f.optimisticOps.push(g),u.mutatedParts&&zn(u.mutatedParts))}),d.catch(function(){me(f.optimisticOps,u),u.mutatedParts&&zn(u.mutatedParts)})):d.then(function(g){var y=Go(0,c(c({},u),{values:u.values.map(function(_,p){var k;return g.failures[p]?_:(_=(k=s.keyPath)!==null&&k!==void 0&&k.includes(".")?ae(_):c({},_),xe(_,s.keyPath,g.results[p]),_)})}),g);f.optimisticOps.push(y),queueMicrotask(function(){return u.mutatedParts&&zn(u.mutatedParts)})}),d):a.mutate(u)},query:function(u){if(!Qo(K,a)||!Wo("query",u))return a.query(u);var d=((y=K.trans)===null||y===void 0?void 0:y.db._options.cache)==="immutable",p=K,f=p.requery,g=p.signal,y=function(b,w,x,I){var A=Et["idb://".concat(b,"/").concat(w)];if(!A)return[];if(!(w=A.queries[x]))return[null,!1,A,null];var S=w[(I.query?I.query.index.name:null)||""];if(!S)return[null,!1,A,null];switch(x){case"query":var O=S.find(function(P){return P.req.limit===I.limit&&P.req.values===I.values&&Jo(P.req.query.range,I.query.range)});return O?[O,!0,A,S]:[S.find(function(P){return("limit"in P.req?P.req.limit:1/0)>=I.limit&&(!I.values||P.req.values)&&Ga(P.req.query.range,I.query.range)}),!1,A,S];case"count":return O=S.find(function(P){return Jo(P.req.query.range,I.query.range)}),[O,!!O,A,S]}}(t,r,"query",u),_=y[0],p=y[1],k=y[2],v=y[3];return _&&p?_.obsSet=u.obsSet:(p=a.query(u).then(function(b){var w=b.result;if(_&&(_.res=w),d){for(var x=0,I=w.length;x<I;++x)Object.freeze(w[x]);Object.freeze(w)}else b.result=ae(w);return b}).catch(function(b){return v&&_&&me(v,_),Promise.reject(b)}),_={obsSet:u.obsSet,promise:p,subscribers:new Set,type:"query",req:u,dirty:!1},v?v.push(_):(v=[_],(k=k||(Et["idb://".concat(t,"/").concat(r)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[u.query.index.name||""]=v)),Ya(_,v,f,g),_.promise.then(function(b){return{result:Yo(b.result,u,k==null?void 0:k.optimisticOps,a,_,d)}})}})}})}};function $n(e,t){return new Proxy(e,{get:function(r,a,s){return a==="db"?t:Reflect.get(r,a,s)}})}var Xe=(ye.prototype.version=function(e){if(isNaN(e)||e<.1)throw new V.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new V.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,r=t.filter(function(a){return a._cfg.version===e})[0];return r||(r=new this.Version(e),t.push(r),t.sort($a),r.stores({}),this._state.autoSchema=!1,r)},ye.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||K.letThrough||this._vip)?e():new N(function(r,a){if(t._state.openComplete)return a(new V.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void a(new V.DatabaseClosed);t.open().catch(ie)}t._state.dbReadyPromise.then(r,a)}).then(e)},ye.prototype.use=function(e){var t=e.stack,r=e.create,a=e.level,s=e.name;return s&&this.unuse({stack:t,name:s}),e=this._middlewares[t]||(this._middlewares[t]=[]),e.push({stack:t,create:r,level:a??10,name:s}),e.sort(function(u,d){return u.level-d.level}),this},ye.prototype.unuse=function(e){var t=e.stack,r=e.name,a=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(s){return a?s.create!==a:!!r&&s.name!==r})),this},ye.prototype.open=function(){var e=this;return _t(nt,function(){return Va(e)})},ye.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var e=this._state,t=Nt.indexOf(this);if(0<=t&&Nt.splice(t,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new N(function(r){e.dbReadyResolve=r}),e.openCanceller=new N(function(r,a){e.cancelOpen=a}))},ye.prototype.close=function(r){var t=(r===void 0?{disableAutoOpen:!0}:r).disableAutoOpen,r=this._state;t?(r.isBeingOpened&&r.cancelOpen(new V.DatabaseClosed),this._close(),r.autoOpen=!1,r.dbOpenError=new V.DatabaseClosed):(this._close(),r.autoOpen=this._options.autoOpen||r.isBeingOpened,r.openComplete=!1,r.dbOpenError=null)},ye.prototype.delete=function(e){var t=this;e===void 0&&(e={disableAutoOpen:!0});var r=0<arguments.length&&typeof arguments[0]!="object",a=this._state;return new N(function(s,u){function d(){t.close(e);var f=t._deps.indexedDB.deleteDatabase(t.name);f.onsuccess=he(function(){var g,y,_;g=t._deps,y=t.name,_=g.indexedDB,g=g.IDBKeyRange,Ar(_)||y===In||Ir(_,g).delete(y).catch(ie),s()}),f.onerror=Ge(u),f.onblocked=t._fireOnBlocked}if(r)throw new V.InvalidArgument("Invalid closeOptions argument to db.delete()");a.isBeingOpened?a.dbReadyPromise.then(d):d()})},ye.prototype.backendDB=function(){return this.idbdb},ye.prototype.isOpen=function(){return this.idbdb!==null},ye.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},ye.prototype.hasFailed=function(){return this._state.dbOpenError!==null},ye.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(ye.prototype,"tables",{get:function(){var e=this;return m(this._allTables).map(function(t){return e._allTables[t]})},enumerable:!1,configurable:!0}),ye.prototype.transaction=function(){var e=(function(t,r,a){var s=arguments.length;if(s<2)throw new V.InvalidArgument("Too few arguments");for(var u=new Array(s-1);--s;)u[s-1]=arguments[s];return a=u.pop(),[t,Mt(u),a]}).apply(this,arguments);return this._transaction.apply(this,e)},ye.prototype._transaction=function(e,t,r){var a=this,s=K.trans;s&&s.db===this&&e.indexOf("!")===-1||(s=null);var u,d,f=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");try{if(d=t.map(function(y){if(y=y instanceof a.Table?y.name:y,typeof y!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return y}),e=="r"||e===pr)u=pr;else{if(e!="rw"&&e!=mr)throw new V.InvalidArgument("Invalid transaction mode: "+e);u=mr}if(s){if(s.mode===pr&&u===mr){if(!f)throw new V.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");s=null}s&&d.forEach(function(y){if(s&&s.storeNames.indexOf(y)===-1){if(!f)throw new V.SubTransaction("Table "+y+" not included in parent transaction.");s=null}}),f&&s&&!s.active&&(s=null)}}catch(y){return s?s._promise(null,function(_,p){p(y)}):ge(y)}var g=(function y(_,p,k,v,b){return N.resolve().then(function(){var w=K.transless||K,x=_._createTransaction(p,k,_._dbSchema,v);if(x.explicit=!0,w={trans:x,transless:w},v)x.idbtrans=v.idbtrans;else try{x.create(),x.idbtrans._explicit=!0,_._state.PR1398_maxLoop=3}catch(S){return S.name===or.InvalidState&&_.isOpen()&&0<--_._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),_.close({disableAutoOpen:!1}),_.open().then(function(){return y(_,p,k,null,b)})):ge(S)}var I,A=rr(b);return A&&$t(),w=N.follow(function(){var S;(I=b.call(x,x))&&(A?(S=ot.bind(null,null),I.then(S,S)):typeof I.next=="function"&&typeof I.throw=="function"&&(I=qr(I)))},w),(I&&typeof I.then=="function"?N.resolve(I).then(function(S){return x.active?S:ge(new V.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):w.then(function(){return I})).then(function(S){return v&&x._resolve(),x._completion.then(function(){return S})}).catch(function(S){return x._reject(S),ge(S)})})}).bind(null,this,u,d,s,r);return s?s._promise(u,g,"lock"):K.trans?_t(K.transless,function(){return a._whenReady(g)}):this._whenReady(g)},ye.prototype.table=function(e){if(!$(this._allTables,e))throw new V.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},ye);function ye(e,t){var r=this;this._middlewares={},this.verno=0;var a=ye.dependencies;this._options=t=c({addons:ye.addons,autoOpen:!0,indexedDB:a.indexedDB,IDBKeyRange:a.IDBKeyRange,cache:"cloned"},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange},a=t.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var s,u,d,f,g,y={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ie,dbReadyPromise:null,cancelOpen:ie,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:t.autoOpen};y.dbReadyPromise=new N(function(p){y.dbReadyResolve=p}),y.openCanceller=new N(function(p,k){y.cancelOpen=k}),this._state=y,this.name=e,this.on=Xt(this,"populate","blocked","versionchange","close",{ready:[ir,ie]}),this.once=function(p,k){var v=function(){for(var b=[],w=0;w<arguments.length;w++)b[w]=arguments[w];r.on(p).unsubscribe(v),k.apply(r,b)};return r.on(p,v)},this.on.ready.subscribe=U(this.on.ready.subscribe,function(p){return function(k,v){ye.vip(function(){var b,w=r._state;w.openComplete?(w.dbOpenError||N.resolve().then(k),v&&p(k)):w.onReadyBeingFired?(w.onReadyBeingFired.push(k),v&&p(k)):(p(k),b=r,v||p(function x(){b.on.ready.unsubscribe(k),b.on.ready.unsubscribe(x)}))})}}),this.Collection=(s=this,en(qa.prototype,function(I,x){this.db=s;var v=Ao,b=null;if(x)try{v=x()}catch(A){b=A}var w=I._ctx,x=w.table,I=x.hook.reading.fire;this._ctx={table:x,index:w.index,isPrimKey:!w.index||x.schema.primKey.keyPath&&w.index===x.schema.primKey.name,range:v,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:b,or:w.or,valueMapper:I!==Qt?I:null}})),this.Table=(u=this,en(Po.prototype,function(p,k,v){this.db=u,this._tx=v,this.name=p,this.schema=k,this.hook=u._allTables[p]?u._allTables[p].hook:Xt(null,{creating:[Ea,ie],reading:[ka,Qt],updating:[Aa,ie],deleting:[Ia,ie]})})),this.Transaction=(d=this,en(Ra.prototype,function(p,k,v,b,w){var x=this;p!=="readonly"&&k.forEach(function(I){I=(I=v[I])===null||I===void 0?void 0:I.yProps,I&&(k=k.concat(I.map(function(A){return A.updatesTable})))}),this.db=d,this.mode=p,this.storeNames=k,this.schema=v,this.chromeTransactionDurability=b,this.idbtrans=null,this.on=Xt(this,"complete","error","abort"),this.parent=w||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new N(function(I,A){x._resolve=I,x._reject=A}),this._completion.then(function(){x.active=!1,x.on.complete.fire()},function(I){var A=x.active;return x.active=!1,x.on.error.fire(I),x.parent?x.parent._reject(I):A&&x.idbtrans&&x.idbtrans.abort(),ge(I)})})),this.Version=(f=this,en(Ka.prototype,function(p){this.db=f,this._cfg={version:p,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(g=this,en(jo.prototype,function(p,k,v){if(this.db=g,this._ctx={table:p,index:k===":id"?null:k,or:v},this._cmp=this._ascending=te,this._descending=function(b,w){return te(w,b)},this._max=function(b,w){return 0<te(b,w)?b:w},this._min=function(b,w){return te(b,w)<0?b:w},this._IDBKeyRange=g._deps.IDBKeyRange,!this._IDBKeyRange)throw new V.MissingAPI})),this.on("versionchange",function(p){0<p.newVersion?console.warn("Another connection wants to upgrade database '".concat(r.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(r.name,"'. Closing db now to resume the delete request.")),r.close({disableAutoOpen:!1})}),this.on("blocked",function(p){!p.newVersion||p.newVersion<p.oldVersion?console.warn("Dexie.delete('".concat(r.name,"') was blocked")):console.warn("Upgrade '".concat(r.name,"' blocked by other connection holding version ").concat(p.oldVersion/10))}),this._maxKey=rn(t.IDBKeyRange),this._createTransaction=function(p,k,v,b){return new r.Transaction(p,k,v,r._options.chromeTransactionDurability,b)},this._fireOnBlocked=function(p){r.on("blocked").fire(p),Nt.filter(function(k){return k.name===r.name&&k!==r&&!k._state.vcFired}).map(function(k){return k.on("versionchange").fire(p)})},this.use(Qa),this.use(Ja),this.use(Wa),this.use(Ua),this.use(Ha);var _=new Proxy(this,{get:function(p,k,v){if(k==="_vip")return!0;if(k==="table")return function(w){return $n(r.table(w),_)};var b=Reflect.get(p,k,v);return b instanceof Po?$n(b,_):k==="tables"?b.map(function(w){return $n(w,_)}):k==="_createTransaction"?function(){return $n(b.apply(this,arguments),_)}:b}});this.vip=_,a.forEach(function(p){return p(r)})}var Nn,Ne=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Za=(jr.prototype.subscribe=function(e,t,r){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:t,complete:r})},jr.prototype[Ne]=function(){return this},jr);function jr(e){this._subscribe=e}try{Nn={indexedDB:h.indexedDB||h.mozIndexedDB||h.webkitIndexedDB||h.msIndexedDB,IDBKeyRange:h.IDBKeyRange||h.webkitIDBKeyRange}}catch{Nn={indexedDB:null,IDBKeyRange:null}}function Zo(e){var t,r=!1,a=new Za(function(s){var u=rr(e),d,f=!1,g={},y={},_={get closed(){return f},unsubscribe:function(){f||(f=!0,d&&d.abort(),p&&st.storagemutated.unsubscribe(v))}};s.start&&s.start(_);var p=!1,k=function(){return hr(b)},v=function(w){jn(g,w),Or(y,g)&&k()},b=function(){var w,x,I;!f&&Nn.indexedDB&&(g={},w={},d&&d.abort(),d=new AbortController,I=function(A){var S=zt();try{u&&$t();var O=rt(e,A);return O=u?O.finally(ot):O}finally{S&&Ft()}}(x={subscr:w,signal:d.signal,requery:k,querier:e,trans:null}),Promise.resolve(I).then(function(A){r=!0,t=A,f||x.signal.aborted||(g={},function(S){for(var O in S)if($(S,O))return;return 1}(y=w)||p||(st(nn,v),p=!0),hr(function(){return!f&&s.next&&s.next(A)}))},function(A){r=!1,["DatabaseClosedError","AbortError"].includes(A==null?void 0:A.name)||f||hr(function(){f||s.error&&s.error(A)})}))};return setTimeout(k,0),_});return a.hasValue=function(){return r},a.getValue=function(){return t},a}var It=Xe;function zr(e){var t=ct;try{ct=!0,st.storagemutated.fire(e),Pr(e,!0)}finally{ct=t}}F(It,c(c({},gn),{delete:function(e){return new It(e,{addons:[]}).delete()},exists:function(e){return new It(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return t=It.dependencies,r=t.indexedDB,t=t.IDBKeyRange,(Ar(r)?Promise.resolve(r.databases()).then(function(a){return a.map(function(s){return s.name}).filter(function(s){return s!==In})}):Ir(r,t).toCollection().primaryKeys()).then(e)}catch{return ge(new V.MissingAPI)}var t,r},defineClass:function(){return function(e){C(this,e)}},ignoreTransaction:function(e){return K.trans?_t(K.transless,e):e()},vip:Sr,async:function(e){return function(){try{var t=qr(e.apply(this,arguments));return t&&typeof t.then=="function"?t:N.resolve(t)}catch(r){return ge(r)}}},spawn:function(e,t,r){try{var a=qr(e.apply(r,t||[]));return a&&typeof a.then=="function"?a:N.resolve(a)}catch(s){return ge(s)}},currentTransaction:{get:function(){return K.trans||null}},waitFor:function(e,t){return t=N.resolve(typeof e=="function"?It.ignoreTransaction(e):e).timeout(t||6e4),K.trans?K.trans.waitFor(t):t},Promise:N,debug:{get:function(){return We},set:function(e){bo(e)}},derive:_e,extend:C,props:F,override:U,Events:Xt,on:st,liveQuery:Zo,extendObservabilitySet:jn,getByKeyPath:Ie,setByKeyPath:xe,delByKeyPath:function(e,t){typeof t=="string"?xe(e,t,void 0):"length"in t&&[].map.call(t,function(r){xe(e,r,void 0)})},shallowClone:He,deepClone:ae,getObjectDiff:Mr,cmp:te,asap:Ce,minKey:-1/0,addons:[],connections:Nt,errnames:or,dependencies:Nn,cache:Et,semVer:"4.2.1",version:"4.2.1".split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,r){return e+t/Math.pow(10,2*r)})})),It.maxKey=rn(It.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(st(nn,function(e){ct||(e=new CustomEvent(vr,{detail:e}),ct=!0,dispatchEvent(e),ct=!1)}),addEventListener(vr,function(e){e=e.detail,ct||zr(e)}));var Ut,ct=!1,Xo=function(){};return typeof BroadcastChannel<"u"&&((Xo=function(){(Ut=new BroadcastChannel(vr)).onmessage=function(e){return e.data&&zr(e.data)}})(),typeof Ut.unref=="function"&&Ut.unref(),st(nn,function(e){ct||Ut.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!Xe.disableBfCache&&e.persisted){We&&console.debug("Dexie: handling persisted pagehide"),Ut!=null&&Ut.close();for(var t=0,r=Nt;t<r.length;t++)r[t].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!Xe.disableBfCache&&e.persisted&&(We&&console.debug("Dexie: handling persisted pageshow"),Xo(),zr({all:new Oe(-1/0,[[]])}))})),N.rejectionMapper=function(e,t){return!e||e instanceof Rt||e instanceof TypeError||e instanceof SyntaxError||!e.name||!vo[e.name]?e:(t=new vo[e.name](t||e.message,e),"stack"in e&&de(t,"stack",{get:function(){return this.inner.stack}}),t)},bo(We),c(Xe,Object.freeze({__proto__:null,Dexie:Xe,liveQuery:Zo,Entity:So,cmp:te,PropModification:Zt,replacePrefix:function(e,t){return new Zt({replacePrefix:[e,t]})},add:function(e){return new Zt({add:e})},remove:function(e){return new Zt({remove:e})},default:Xe,RangeSet:Oe,mergeRanges:sn,rangesOverlap:Lo}),{default:Xe}),Xe})})(ya);var Dl=ya.exports;const no=Tl(Dl),xi=Symbol.for("Dexie"),Gn=globalThis[xi]||(globalThis[xi]=no);if(no.semVer!==Gn.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${no.semVer} and ${Gn.semVer}`);const{liveQuery:hf,mergeRanges:pf,rangesOverlap:mf,RangeSet:gf,cmp:yf,Entity:vf,PropModification:bf,replacePrefix:wf,add:_f,remove:xf,DexieYProvider:kf}=Gn;class Pl extends Gn{constructor(){super("IslamQA"),this.version(1).stores({categories:"reference, parent_reference",questions:"reference, primary_category",folders:"++id, folder_name",folder_questions:"++id, reference, folder_id",latest_questions:"reference, primary_category",settings:"key",quiz_configurations:"++id, mode, difficulty",quiz_attempts:"++id, session_id, completion_date",quiz_sessions:"++id, quiz_config_id",quiz_questions:"reference"}),this.categories=this.table("categories"),this.questions=this.table("questions"),this.folders=this.table("folders"),this.folder_questions=this.table("folder_questions"),this.latest_questions=this.table("latest_questions"),this.settings=this.table("settings"),this.quiz_configurations=this.table("quiz_configurations"),this.quiz_attempts=this.table("quiz_attempts"),this.quiz_sessions=this.table("quiz_sessions"),this.quiz_questions=this.table("quiz_questions")}async isImported(){try{const n=await this.settings.get("import_status");return(n==null?void 0:n.value)==="completed"}catch(n){return console.error("Error checking import status:",n),!1}}async markAsImported(){try{await this.settings.put({key:"import_status",value:"completed",timestamp:Date.now()})}catch(n){console.error("Error marking as imported:",n)}}async hasData(){try{return await this.questions.count()>0}catch(n){return console.error("Error checking data:",n),!1}}async getStats(){try{const[n,i]=await Promise.all([this.categories.count(),this.questions.count()]);return{categories:n,questions:i}}catch(n){return console.error("Error getting stats:",n),{categories:0,questions:0}}}async importCategories(n,i=null){try{const l=n.length,h=Math.ceil(l/100);console.log(` Importing ${l} categories in ${h} batches of 100`);for(let m=0;m<h;m++){const E=m*100,C=Math.min(E+100,l),q=n.slice(E,C);await this.categories.bulkPut(q);const R=C;i&&i({batchIndex:m+1,totalBatches:h,itemsProcessed:R,totalItems:l,percentage:R/l*100}),console.log(`   Batch ${m+1}/${h} (${R}/${l} categories)`),m<h-1&&await new Promise($=>setTimeout($,0))}console.log(` Imported ${n.length} categories`)}catch(c){throw console.error("Error importing categories:",c),c}}async importQuestions(n,i=null){try{const l=n.length,h=Math.ceil(l/500);console.log(` Importing ${l} questions in ${h} batches of 500`);for(let m=0;m<h;m++){const E=m*500,C=Math.min(E+500,l),q=n.slice(E,C);await this.questions.bulkPut(q);const R=C;i&&i({batchIndex:m+1,totalBatches:h,itemsProcessed:R,totalItems:l,percentage:R/l*100}),console.log(`   Batch ${m+1}/${h} (${R}/${l} questions)`),m<h-1&&await new Promise($=>setTimeout($,0))}console.log(` Imported ${n.length} questions`)}catch(c){throw console.error("Error importing questions:",c),c}}async importAnswers(n){console.warn("  importAnswers() is deprecated. Answers are now embedded in questions.answer")}async getCategories(n=null){try{if(n===null){const l=await this.categories.filter(h=>h.parent_reference===null).toArray();return console.log(`Found ${l.length} root categories (parent_reference=null)`),l}const i=typeof n=="string"?parseInt(n,10):n,c=await this.categories.where("parent_reference").equals(i).toArray();return console.log(`Found ${c.length} categories with parent_reference=${i}`),c}catch(i){return console.error("Error getting categories:",i),[]}}async getAllDescendantCategoryReferences(n){try{const i=typeof n=="string"?parseInt(n,10):n,c=await this.categories.where("reference").equals(i).first();if(!c)return[i];const l=[i];if(c.children_references&&c.children_references.length>0)for(const h of c.children_references){const m=await this.getAllDescendantCategoryReferences(h);l.push(...m)}return l}catch(i){return console.error("Error getting descendant categories:",i),[n]}}async getCategory(n){try{const i=typeof n=="string"?parseInt(n,10):n,c=await this.categories.where("reference").equals(i).first();return console.log(`Looking for category with reference=${i}:`,c),c}catch(i){return console.error("Error getting category:",i),null}}async getQuestionsByCategory(n,i=100,c=0){try{const l=typeof n=="string"?parseInt(n,10):n,h=await this.questions.where("primary_category").equals(l).offset(c).limit(i).toArray();return console.log(`Found ${h.length} questions for primary_category=${l}`),h}catch(l){return console.error("Error getting questions:",l),[]}}async getQuestion(n){try{const i=typeof n=="string"?parseInt(n):n,c=await this.questions.where("reference").equals(i).first();return console.log(`Looking for question with reference=${i}:`,c),c}catch(i){return console.error("Error getting question:",i),null}}async getAnswer(n){try{const i=typeof n=="string"?parseInt(n):n,c=await this.questions.where("reference").equals(i).first();return console.log(`Looking for answer for question with reference=${i}`),c}catch(i){return console.error("Error getting answer:",i),null}}async searchQuestions(n,i=50){try{const c=n.toLowerCase();return await this.questions.filter(h=>{var m,E;return((m=h.title)==null?void 0:m.toLowerCase().includes(c))||((E=h.question)==null?void 0:E.toLowerCase().includes(c))}).limit(i).toArray()}catch(c){return console.error("Error searching questions:",c),[]}}async getAllQuestions(){try{return await this.questions.toArray()}catch(n){return console.error("Error getting all questions:",n),[]}}async getFolders(){try{return await this.folders.toArray()}catch(n){return console.error("Error getting folders:",n),[]}}async createFolder(n){try{return await this.folders.add({folder_name:n})}catch(i){throw console.error("Error creating folder:",i),i}}async deleteFolder(n){try{await this.transaction("rw",[this.folders,this.folder_questions],async()=>{await this.folders.delete(n),await this.folder_questions.where("folder_id").equals(n).delete()})}catch(i){throw console.error("Error deleting folder:",i),i}}async addQuestionToFolder(n,i){try{if(await this.folder_questions.where("[reference+folder_id]").equals([n,i]).first())return;await this.folder_questions.add({reference:n,folder_id:i})}catch(c){throw console.error("Error adding question to folder:",c),c}}async removeQuestionFromFolder(n,i){try{await this.folder_questions.where("[reference+folder_id]").equals([n,i]).delete()}catch(c){throw console.error("Error removing question from folder:",c),c}}async getQuestionsInFolder(n){try{const c=(await this.folder_questions.where("folder_id").equals(n).toArray()).map(h=>h.reference);return await this.questions.where("reference").anyOf(c).toArray()}catch(i){return console.error("Error getting folder questions:",i),[]}}async getQuizConfigurations(n=null){try{let i=this.quiz_configurations;n&&(i=i.where("mode").equals(n));const c=await i.toArray();return console.log(`Found ${c.length} quiz configurations${n?` for mode=${n}`:""}`),c}catch(i){return console.error("Error getting quiz configurations:",i),[]}}async getQuizConfiguration(n){try{return await this.quiz_configurations.get(n)||null}catch(i){return console.error("Error getting quiz configuration:",i),null}}async createQuizConfiguration(n){try{const i=await this.quiz_configurations.add(n);return console.log(` Created quiz configuration with id=${i}`),i}catch(i){throw console.error("Error creating quiz configuration:",i),i}}async saveQuizAttempt(n){try{const i=await this.quiz_attempts.add({...n,completion_date:Date.now()});return console.log(` Saved quiz attempt with id=${i}`),i}catch(i){throw console.error("Error saving quiz attempt:",i),i}}async getQuizAttempts(n=null){try{let i=this.quiz_attempts;return n&&(i=i.where("session_id").equals(n)),await i.toArray()}catch(i){return console.error("Error getting quiz attempts:",i),[]}}async getQuizStats(){try{const n=await this.quiz_attempts.toArray();if(n.length===0)return{total_attempts:0,average_score:0,total_points:0};const i=n.reduce((m,E)=>m+(E.points||0),0),c=n.reduce((m,E)=>m+(E.correct||0),0),l=n.reduce((m,E)=>m+(E.total||0),0),h=l>0?(c/l*100).toFixed(1):0;return{total_attempts:n.length,total_points:i,total_questions:l,total_correct:c,average_accuracy:parseFloat(h)}}catch(n){return console.error("Error getting quiz stats:",n),{total_attempts:0,average_score:0,total_points:0}}}async getQuizQuestion(n){try{return await this.quiz_questions.get(n)||null}catch(i){return console.error("Error getting quiz question:",i),null}}async saveQuizQuestion(n){try{return await this.quiz_questions.put({reference:n.reference,questionText:n.questionText,options:n.options,explanation:n.explanation,difficulty:n.difficulty,tags:n.tags||[],source:n.source||"llm-generated",generatedDate:Date.now(),...n})}catch(i){throw console.error("Error saving quiz question:",i),i}}async bulkImportQuizQuestions(n){try{const i=n.map(c=>({reference:c.reference,questionText:c.questionText,options:c.options,explanation:c.explanation,difficulty:c.difficulty,tags:c.tags||[],source:c.source||"llm-generated",generatedDate:c.generatedDate||Date.now(),...c}));return await this.quiz_questions.bulkPut(i),console.log(` Imported ${n.length} quiz questions`),n.length}catch(i){throw console.error("Error bulk importing quiz questions:",i),i}}async getAllQuizQuestions(){try{return await this.quiz_questions.toArray()}catch(n){return console.error("Error getting all quiz questions:",n),[]}}async getQuizQuestionStats(){try{const n=await this.quiz_questions.count(),i=await this.questions.count();return{quizQuestions:n,total:i,percentage:i>0?(n/i*100).toFixed(1):0}}catch(n){return console.error("Error getting quiz question stats:",n),{quizQuestions:0,total:0,percentage:0}}}async clearAllData(){try{await this.transaction("rw",[this.categories,this.questions,this.folders,this.folder_questions,this.latest_questions,this.settings,this.quiz_configurations,this.quiz_attempts,this.quiz_sessions,this.quiz_questions],async()=>{await this.categories.clear(),await this.questions.clear(),await this.folders.clear(),await this.folder_questions.clear(),await this.latest_questions.clear(),await this.settings.clear(),await this.quiz_configurations.clear(),await this.quiz_attempts.clear(),await this.quiz_sessions.clear(),await this.quiz_questions.clear()}),console.log(" Database cleared")}catch(n){throw console.error("Error clearing database:",n),n}}}const ce=new Pl,va=Ii("data",()=>{const o=pe(!1),n=pe(!1),i=pe(null);async function c(){try{const U=await ce.hasData();if(n.value=U,U){const X=await ce.getStats();console.log(" Data store initialized:",X),i.value=await ce.getCategories(null),console.log(` Cached ${i.value.length} root categories`)}else console.log("  Database is empty, need to import data")}catch(U){console.error("Failed to initialize data store:",U),n.value=!1}}async function l(U=null){try{return U===null&&i.value!==null?i.value:await ce.getCategories(U)}catch(X){return console.error("Error getting categories:",X),[]}}async function h(U){try{return await ce.getCategory(U)}catch(X){return console.error("Error getting category:",X),null}}async function m(U,X=100,Ce=0){try{return await ce.getQuestionsByCategory(U,X,Ce)}catch(Ie){return console.error("Error getting questions:",Ie),[]}}async function E(U){try{return await ce.getQuestion(U)}catch(X){return console.error("Error getting question:",X),null}}async function C(U){try{return await ce.getAnswer(U)}catch(X){return console.error("Error getting answer:",X),null}}async function q(U,X=50){try{return await ce.searchQuestions(U,X)}catch(Ce){return console.error("Error searching questions:",Ce),[]}}async function R(){try{return await ce.getAllQuestions()}catch(U){return console.error("Error getting all questions:",U),[]}}async function $(){try{return await ce.getFolders()}catch(U){return console.error("Error getting folders:",U),[]}}async function F(U){try{return await ce.createFolder(U)}catch(X){throw console.error("Error creating folder:",X),X}}async function Y(U){try{await ce.deleteFolder(U)}catch(X){throw console.error("Error deleting folder:",X),X}}async function de(U,X){try{await ce.addQuestionToFolder(U,X)}catch(Ce){throw console.error("Error adding question to folder:",Ce),Ce}}async function _e(U,X){try{await ce.removeQuestionFromFolder(U,X)}catch(Ce){throw console.error("Error removing question from folder:",Ce),Ce}}async function ve(U){try{return await ce.getQuestionsInFolder(U)}catch(X){return console.error("Error getting folder questions:",X),[]}}async function Re(){try{return await ce.isImported()}catch(U){return console.error("Error checking import status:",U),!1}}async function be(){try{return await ce.getStats()}catch(U){return console.error("Error getting stats:",U),{categories:0,questions:0,answers:0}}}return{isLoading:o,isReady:n,initialize:c,getCategoriesByParent:l,getCategory:h,getQuestionsByCategory:m,getQuestion:E,getAnswer:C,searchQuestions:q,getAllQuestions:R,getFolders:$,createFolder:F,deleteFolder:Y,addQuestionToFolder:de,removeQuestionFromFolder:_e,getQuestionsInFolder:ve,isDataImported:Re,getStats:be}}),ba="/islamqa/logo.png",ql=Ii("gamification",()=>{const o=pe(0),n=pe(1),i=pe(0),c=pe(null),l=pe([]);pe(0),pe(0);const h=pe(new Set),m=pe({totalPoints:0,quizzesCompleted:0,questionsRead:0,bookmarksCreated:0,avgAccuracy:0,longestStreak:0}),E=[{name:"Bronze",minPoints:0,color:"#cd7f32",icon:"",benefits:"Getting started"},{name:"Silver",minPoints:500,color:"#c0c0c0",icon:"",benefits:"Making progress"},{name:"Gold",minPoints:1500,color:"#ffd700",icon:"",benefits:"Dedicated learner"},{name:"Platinum",minPoints:3e3,color:"#e5e4e2",icon:"",benefits:"Knowledge expert"},{name:"Diamond",minPoints:5e3,color:"#b9f2ff",icon:"",benefits:"Master scholar"},{name:"Legend",minPoints:1e4,color:"#ff6b6b",icon:"",benefits:"Islamic knowledge champion"}],C=[{id:"first-quiz",name:"Quiz Starter",description:"Complete your first quiz",icon:"",requirement:{type:"quiz",count:1},points:50,unlocked:!1},{id:"quiz-master",name:"Quiz Master",description:"Complete 10 quizzes",icon:"",requirement:{type:"quiz",count:10},points:200,unlocked:!1},{id:"perfect-score",name:"Perfect Score",description:"Get 100% on a quiz",icon:"",requirement:{type:"accuracy",count:100},points:150,unlocked:!1},{id:"scholar",name:"Scholar",description:"Read 50 questions",icon:"",requirement:{type:"read",count:50},points:100,unlocked:!1},{id:"knowledge-seeker",name:"Knowledge Seeker",description:"Read 100 questions",icon:"",requirement:{type:"read",count:100},points:250,unlocked:!1},{id:"dedicated-learner",name:"Dedicated Learner",description:"Maintain a 7-day streak",icon:"",requirement:{type:"streak",count:7},points:300,unlocked:!1},{id:"collector",name:"Collector",description:"Bookmark 20 questions",icon:"",requirement:{type:"bookmarks",count:20},points:100,unlocked:!1},{id:"early-riser",name:"Early Riser",description:"Complete daily quiz 5 days in a row",icon:"",requirement:{type:"daily-streak",count:5},points:200,unlocked:!1}],q=Ke(()=>Math.floor(o.value/500)+1),R=Ke(()=>(q.value*500,500-o.value%500)),$=Ke(()=>l.value.filter(H=>H.unlocked)),F=Ke(()=>l.value.filter(H=>!H.unlocked)),Y=Ke(()=>{for(let H=E.length-1;H>=0;H--)if(o.value>=E[H].minPoints)return E[H];return E[0]}),de=Ke(()=>{const H=E.findIndex(Z=>Z.name===Y.value.name);return H<E.length-1?E[H+1]:null}),_e=Ke(()=>{if(!de.value)return 100;const H=Y.value.minPoints,Z=de.value.minPoints,ae=(o.value-H)/(Z-H)*100;return Math.min(Math.round(ae),100)}),ve=Ke(()=>Math.round(o.value%500/5));function Re(){const H=localStorage.getItem("gamification");if(H){const Z=JSON.parse(H);o.value=Z.points||0,i.value=Z.streak||0,c.value=Z.lastQuizDate||null,l.value=Z.achievements||C.map(ae=>({...ae})),m.value=Z.stats||m.value,h.value=new Set(Z.readQuestionIds||[])}else l.value=C.map(Z=>({...Z,unlocked:!1}))}function be(){localStorage.setItem("gamification",JSON.stringify({points:o.value,streak:i.value,lastQuizDate:c.value,achievements:l.value,stats:m.value,readQuestionIds:Array.from(h.value)}))}function U(H,Z=""){o.value+=H,console.log(` +${H} points (${Z})`),He(),be()}function X(H,Z){m.value.quizzesCompleted++,m.value.totalPoints+=H;const ae=(m.value.avgAccuracy*(m.value.quizzesCompleted-1)+Z)/m.value.quizzesCompleted;m.value.avgAccuracy=Math.round(ae),U(H,"Quiz completion"),xe(),He(),be()}function Ce(H){!H||h.value.has(H)||(h.value.add(H),m.value.questionsRead++,U(5,"Question read"),He())}function Ie(){m.value.bookmarksCreated++,U(10,"Bookmark created"),He()}function xe(){const H=new Date().toISOString().split("T")[0],Z=c.value?new Date(c.value):null,ae=Z?Z.toISOString().split("T")[0]:null;if(ae!==H)if(c.value=new Date().toISOString(),Z){const mt=Math.floor((new Date(H)-new Date(ae))/864e5);mt===1?(i.value++,m.value.longestStreak=Math.max(m.value.longestStreak,i.value),U(100,`${i.value}-day streak!`),console.log(` Streak: ${i.value} days!`)):mt>1&&(i.value=1,U(50,"Streak reset - welcome back!"))}else i.value=1}function He(){l.value.forEach(H=>{if(H.unlocked)return;const Z=H.requirement;let ae=!1;switch(Z.type){case"quiz":ae=m.value.quizzesCompleted>=Z.count;break;case"accuracy":ae=m.value.avgAccuracy>=Z.count;break;case"read":ae=m.value.questionsRead>=Z.count;break;case"streak":ae=i.value>=Z.count;break;case"bookmarks":ae=m.value.bookmarksCreated>=Z.count;break;case"daily-streak":ae=i.value>=Z.count&&i.value%5===0;break}ae&&(H.unlocked=!0,U(H.points,`Achievement: ${H.name}`),console.log(` Achievement unlocked: ${H.name}`))})}function Ht(H){return l.value.find(Z=>Z.id===H)}function Mt(){confirm("Are you sure you want to reset all progress? This cannot be undone.")&&(o.value=0,i.value=0,c.value=null,l.value=C.map(H=>({...H,unlocked:!1})),m.value={totalPoints:0,quizzesCompleted:0,questionsRead:0,bookmarksCreated:0,avgAccuracy:0,longestStreak:0},localStorage.removeItem("gamification"))}return{points:o,level:n,streak:i,lastQuizDate:c,achievements:l,stats:m,tiers:E,currentLevel:q,pointsToNextLevel:R,levelProgress:ve,unlockedAchievements:$,lockedAchievements:F,currentTier:Y,nextTier:de,tierProgress:_e,initializeFromStorage:Re,saveToStorage:be,awardPoints:U,completeQuiz:X,readQuestion:Ce,createBookmark:Ie,checkAchievements:He,getAchievement:Ht,resetProgress:Mt}}),qe={__name:"Icon",props:{name:{type:String,required:!0},size:{type:String,default:"md",validator:o=>["xs","sm","md","lg","xl"].includes(o)}},setup(o){const n=o,i=Ke(()=>({xs:"w-3 h-3",sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6",xl:"w-8 h-8"})[n.size]),c={home:()=>Q("path",{d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"}),search:()=>Q("path",{d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"}),menu:()=>Q("path",{d:"M4 6h16M4 12h16M4 18h16"}),x:()=>Q("path",{d:"M6 18L18 6M6 6l12 12"}),close:()=>Q("path",{d:"M6 18L18 6M6 6l12 12"}),chevronRight:()=>Q("path",{d:"M9 5l7 7-7 7"}),chevronLeft:()=>Q("path",{d:"M15 19l-7-7 7-7"}),chevronDown:()=>Q("path",{d:"M19 9l-7 7-7-7"}),chevronUp:()=>Q("path",{d:"M5 15l7-7 7 7"}),arrowLeft:()=>Q("path",{d:"M10 19l-7-7m0 0l7-7m-7 7h18"}),arrowRight:()=>Q("path",{d:"M14 5l7 7m0 0l-7 7m7-7H3"}),book:()=>Q("path",{d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"}),collection:()=>Q("path",{d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"}),folder:()=>Q("path",{d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"}),document:()=>Q("path",{d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"}),bookmark:()=>Q("path",{d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"}),bookmarkSolid:()=>Q("path",{d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z",fill:"currentColor"}),heart:()=>Q("path",{d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"}),share:()=>Q("path",{d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"}),plus:()=>Q("path",{d:"M12 4v16m8-8H4"}),check:()=>Q("path",{d:"M5 13l4 4L19 7"}),checkCircle:()=>Q("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"}),xCircle:()=>Q("path",{d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"}),exclamation:()=>Q("path",{d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"}),info:()=>Q("path",{d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}),adjustments:()=>Q("path",{d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"}),cog:()=>Q("path",{d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),dotsVertical:()=>Q("path",{d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"}),sun:()=>Q("path",{d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"}),moon:()=>Q("path",{d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"}),lightning:()=>Q("path",{d:"M13 10V3L4 14h7v7l9-11h-7z"}),fire:()=>Q("path",{d:"M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.656 7.343A7.975 7.975 0 0120 13a7.975 7.975 0 01-2.343 5.657z M9.879 16.121A3 3 0 1012.015 11L11 14H9c0 .768.293 1.536.879 2.121z"}),star:()=>Q("path",{d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"}),trophy:()=>Q("path",{d:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"}),download:()=>Q("path",{d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"}),upload:()=>Q("path",{d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"}),globe:()=>Q("path",{d:"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}),code:()=>Q("path",{d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"}),link:()=>Q("path",{d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"}),shield:()=>Q("path",{d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"}),database:()=>Q("path",{d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"}),user:()=>Q("path",{d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"}),edit:()=>Q("path",{d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"}),pencil:()=>Q("path",{d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})},l=Ke(()=>c[n.name]||c.question);return(h,m)=>(oe(),ue("svg",{class:Ue(i.value),fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24","stroke-linecap":"round","stroke-linejoin":"round"},[(oe(),ro(Ai(l.value)))],2))}},Ml=["aria-label"],Bl={__name:"ThemeToggle",setup(o){const{isDark:n,toggleTheme:i}=ga();return(c,l)=>(oe(),ue("button",{onClick:l[0]||(l[0]=(...h)=>Je(i)&&Je(i)(...h)),class:"p-2 rounded-lg transition-colors hover:bg-neutral-100 dark:hover:bg-neutral-800 text-neutral-600 dark:text-neutral-300","aria-label":Je(n)?"Switch to light mode":"Switch to dark mode"},[le(qe,{name:Je(n)?"sun":"moon",size:"md"},null,8,["name"])],8,Ml))}},Rl={class:"hidden lg:flex lg:flex-col lg:fixed lg:inset-y-0 lg:z-50 lg:w-72 bg-white dark:bg-neutral-900 border-r border-neutral-200 dark:border-neutral-800 transition-colors"},jl={class:"flex h-16 shrink-0 items-center justify-between px-6 border-b border-neutral-200 dark:border-neutral-800"},zl={class:"flex-1 overflow-y-auto px-4 py-6 space-y-1"},Fl={class:"shrink-0 border-t border-neutral-200 dark:border-neutral-800 p-4"},$l={class:"bg-gradient-to-br from-primary-50 to-primary-100 dark:from-primary-900/20 dark:to-primary-800/20 rounded-lg p-4 border border-primary-100 dark:border-primary-800/30"},Nl={class:"flex items-center justify-between mb-2"},Ll={class:"text-xs text-neutral-600 dark:text-neutral-400"},Kl={class:"w-full bg-white dark:bg-neutral-800 rounded-full h-2 mb-2"},Vl={class:"flex items-center justify-between text-xs text-neutral-600 dark:text-neutral-400"},Ul={__name:"DesktopSidebar",setup(o){const n=Si(),i=ql(),c=[{name:"Home",to:"/",icon:"home"},{name:"Browse",to:"/browse",icon:"book"},{name:"Search",to:"/search",icon:"search"},{name:"Quiz",to:"/quiz",icon:"lightning",badge:"NEW"},{name:"Leaderboard",to:"/leaderboard",icon:"trophy",badge:"NEW"},{name:"My Bookmarks",to:"/bookmarks",icon:"bookmark"},{name:"Settings",to:"/settings",icon:"cog"}],l=h=>h==="/"?n.path==="/":n.path.startsWith(h);return(h,m)=>{const E=oo("router-link");return oe(),ue("aside",Rl,[T("div",jl,[le(E,{to:"/",class:"flex items-center gap-3"},{default:Ot(()=>[...m[0]||(m[0]=[T("img",{src:ba,alt:"BetterIslam Q&A Logo",class:"w-10 h-10 rounded-lg shadow-soft"},null,-1),T("div",null,[T("h1",{class:"text-lg font-bold text-neutral-900 dark:text-neutral-100"},"IslamQA"),T("p",{class:"text-xs text-neutral-500 dark:text-neutral-400"},"Islamic Knowledge")],-1)])]),_:1}),le(Bl)]),T("nav",zl,[(oe(),ue(un,null,Vn(c,C=>le(E,{key:C.name,to:C.to,class:Ue(["group flex items-center gap-3 px-3 py-2.5 text-sm font-medium rounded-lg transition-all",l(C.to)?"bg-primary-50 dark:bg-primary-900/20 text-primary-700 dark:text-primary-400":"text-neutral-700 dark:text-neutral-300 hover:bg-neutral-100 dark:hover:bg-neutral-800 hover:text-neutral-900 dark:hover:text-neutral-100"])},{default:Ot(()=>[le(qe,{name:C.icon,size:"md",class:Ue(l(C.to)?"":"group-hover:scale-110 transition-transform")},null,8,["name","class"]),T("span",null,Me(C.name),1),C.badge?(oe(),ue("span",{key:0,class:Ue(["ml-auto px-2 py-0.5 text-xs font-semibold rounded-full",C.badge==="NEW"?"bg-accent-100 dark:bg-accent-900/30 text-accent-700 dark:text-accent-400":"bg-neutral-200 dark:bg-neutral-700 text-neutral-700 dark:text-neutral-300"])},Me(C.badge),3)):Ve("",!0)]),_:2},1032,["to","class"])),64))]),T("div",Fl,[T("div",$l,[T("div",Nl,[m[1]||(m[1]=T("span",{class:"text-sm font-medium text-neutral-700 dark:text-neutral-300"},"Your Progress",-1)),T("span",Ll,"Level "+Me(Je(i).currentLevel),1)]),T("div",Kl,[T("div",{class:"bg-gradient-to-r from-primary-500 to-primary-600 dark:from-primary-400 dark:to-primary-500 h-2 rounded-full transition-all duration-500",style:Ci({width:Je(i).levelProgress+"%"})},null,4)]),T("div",Vl,[T("span",null,Me(Je(i).points)+" pts",1),T("span",null,Me(Je(i).pointsToNextLevel)+" to next",1)])])])])}}},mo=(o,n)=>{const i=o.__vccOpts||o;for(const[c,l]of n)i[c]=l;return i},Hl={class:"lg:hidden fixed bottom-0 inset-x-0 z-50 bg-white dark:bg-neutral-900 border-t border-neutral-200 dark:border-neutral-800 safe-area-bottom transition-colors"},Ql={class:"grid grid-cols-5 h-16"},Wl={class:"relative"},Gl={key:0,class:"absolute -top-1 -right-1 w-2 h-2 bg-accent-500 dark:bg-accent-400 rounded-full"},Yl={class:"text-2xs font-medium"},Jl={key:0,class:"absolute top-0 left-1/2 -translate-x-1/2 w-12 h-1 bg-primary-600 dark:bg-primary-400 rounded-b-full"},Zl={__name:"MobileBottomNav",setup(o){const n=Si(),i=[{name:"Home",to:"/",icon:"home"},{name:"Browse",to:"/browse",icon:"book"},{name:"Quiz",to:"/quiz",icon:"lightning",badge:!0},{name:"Board",to:"/leaderboard",icon:"trophy",badge:!0},{name:"More",to:"/settings",icon:"cog"}],c=l=>l==="/"?n.path==="/":n.path.startsWith(l);return(l,h)=>{const m=oo("router-link");return oe(),ue("nav",Hl,[T("div",Ql,[(oe(),ue(un,null,Vn(i,E=>le(m,{key:E.name,to:E.to,class:Ue(["flex flex-col items-center justify-center gap-1 transition-colors relative",c(E.to)?"text-primary-600 dark:text-primary-400":"text-neutral-500 dark:text-neutral-400 active:bg-neutral-50 dark:active:bg-neutral-800"])},{default:Ot(()=>[T("div",Wl,[le(qe,{name:E.icon,size:"lg"},null,8,["name"]),E.badge?(oe(),ue("span",Gl)):Ve("",!0)]),T("span",Yl,Me(E.name),1),c(E.to)?(oe(),ue("div",Jl)):Ve("",!0)]),_:2},1032,["to","class"])),64))])])}}},Xl=mo(Zl,[["__scopeId","data-v-68b8191e"]]),go="app_onboarding",wa="1.0";function ed(){try{const o=localStorage.getItem(go);if(!o)return{completed:!1,version:null,timestamp:null};const n=JSON.parse(o);return n.version!==wa?(console.log("[Onboarding] Version outdated, resetting..."),{completed:!1,version:null,timestamp:null}):n}catch(o){return console.error("[Onboarding] Error reading status:",o),{completed:!1,version:null,timestamp:null}}}function td(){try{const o={completed:!0,version:wa,timestamp:Date.now()};return localStorage.setItem(go,JSON.stringify(o)),console.log("[Onboarding] Marked as completed"),o}catch(o){return console.error("[Onboarding] Error saving completion:",o),null}}function nd(){return!ed().completed}function Ef(){localStorage.removeItem(go),console.log("[Onboarding] Reset")}function rd(){return[{id:"welcome",icon:"book",title:"Welcome to BetterIslam Q&A",description:"Access 11,000+ authentic Islamic Q&A completely offline. Browse categories, search questions, and learn at your own pace.",image:null,color:"primary",type:"info"},{id:"browse",icon:"collection",title:"Browse Categories",description:"Explore 269 categories covering all aspects of Islam. From prayer to business, find answers to your questions organized by topic.",image:null,color:"accent",type:"info"},{id:"search",icon:"search",title:"Powerful Search",description:"Search across thousands of questions instantly. Find exactly what you're looking for with our fast offline search.",image:null,color:"primary",type:"info"},{id:"bookmarks",icon:"bookmark",title:"Save Your Favorites",description:"Bookmark important questions for quick access. Create custom folders to organize your saved content.",image:null,color:"accent",type:"info"},{id:"quiz",icon:"lightning",title:"Test Your Knowledge",description:"Take quizzes to test your Islamic knowledge. Track your progress and compete on the leaderboard.",image:null,color:"primary",type:"info"},{id:"privacy",icon:"shield",title:"Your Privacy Matters",description:"We respect your privacy. Choose whether to share anonymous usage data to help us improve the app.",image:null,color:"accent",type:"privacy"},{id:"offline",icon:"download",title:"100% Offline Access",description:"Everything works offline - no internet needed! All content is stored locally on your device for instant access anytime, anywhere.",image:null,color:"primary",type:"info"},{id:"import",icon:"download",title:"Setup Your Database",description:"Let's import 8000+ Islamic Q&A items to your device. This takes a few minutes and enables full offline access.",image:null,color:"accent",type:"import"}]}class od{constructor(){this.isLoading=!1,this.progress=0,this.currentStep=""}getDataPath(){return window.cordova?"./data":"/islamqa/data".replace(/\/+/g,"/")}async loadAndImport(n){try{if(await ce.isImported())return console.log(" Data already imported"),n&&n({step:"Data already loaded",progress:100}),!0;this.isLoading=!0,this.progress=0,this.currentStep="Loading categories...",n&&n({step:this.currentStep,progress:10});const c=await this.loadCategories();c&&c.length>0&&(await ce.importCategories(c,E=>{const q=10+E.percentage/100*20;this.progress=q,n&&n({step:`Importing categories (${E.itemsProcessed}/${E.totalItems})`,progress:q})}),this.progress=30,n&&n({step:`Categories imported (${c.length} total)`,progress:30})),this.currentStep="Loading questions...",n&&n({step:this.currentStep,progress:35});const l=await this.loadQuestions();l&&l.length>0&&(await ce.importQuestions(l,E=>{const q=40+E.percentage/100*35;this.progress=q,n&&n({step:`Importing questions (${E.itemsProcessed}/${E.totalItems})`,progress:q})}),this.progress=75,n&&n({step:`Questions imported (${l.length} total)`,progress:75})),this.currentStep="Loading quiz questions...",n&&n({step:this.currentStep,progress:80});const h=await this.loadQuizQuestions();h&&h.length>0?(await ce.bulkImportQuizQuestions(h),this.progress=90,n&&n({step:`Quiz questions imported (${h.length} total)`,progress:90})):n&&n({step:"No quiz questions available yet",progress:90}),await ce.markAsImported(),this.progress=100,n&&n({step:"Import complete!",progress:100});const m=await ce.getStats();return console.log(" Database stats:",m),this.isLoading=!1,!0}catch(i){throw this.isLoading=!1,console.error(" Data import failed:",i),i}}async loadCategories(){try{const n=this.getDataPath(),i=await fetch(`${n}/categories.json`);if(!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);const c=await i.json();return console.log(` Loaded ${c.length} categories from categories.json`),c}catch(n){return console.error("Failed to load categories:",n),[]}}async loadQuestions(){try{const n=this.getDataPath(),i=await fetch(`${n}/questions.json`);if(!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);const c=await i.json();return console.log(` Loaded ${c.length} questions from questions.json`),c}catch(n){return console.error("Failed to load questions:",n),[]}}async loadQuizQuestions(){try{const n=this.getDataPath(),i=await fetch(`${n}/quiz-questions.json`);if(!i.ok)return console.warn(`  Quiz questions file not found (HTTP ${i.status})`),[];const c=await i.json(),h=(Array.isArray(c)?c:c.quizzes||[]).map(m=>({reference:m.sourceQuestionId||m.reference,id:m.id,questionText:m.questionText,options:m.options,explanation:m.explanation,difficulty:m.difficulty,tags:m.tags||[],category:m.category,source:m.source||"IslamQA",type:m.type||"multiple-choice"}));return console.log(` Loaded ${h.length} quiz questions from quiz-questions.json`),h}catch(n){return console.warn("  Failed to load quiz questions (optional):",n.message),[]}}async loadAnswers(n){return console.warn("  loadAnswers() is deprecated. Answers are now embedded in questions.answer"),[]}async isDataImported(){return await ce.isImported()}async getStats(){return await ce.getStats()}}const ki=new od,id={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-gradient-to-br from-primary-600 via-primary-700 to-accent-700 dark:from-primary-900 dark:via-primary-950 dark:to-accent-900"},ad={class:"relative w-full h-full flex flex-col"},sd={class:"flex-1 flex items-center justify-center p-4 sm:p-6 md:p-12 overflow-y-auto"},cd={class:"w-full max-w-2xl my-auto"},ud={class:"mb-6 sm:mb-8 flex justify-center"},ld={class:"text-xl sm:text-2xl md:text-4xl font-bold text-white mb-3 sm:mb-4 md:mb-6 px-2"},dd={class:"text-sm sm:text-base md:text-xl text-white/90 leading-relaxed max-w-xl mx-auto px-4 sm:px-6"},fd={key:1,class:"bg-white/10 backdrop-blur-md rounded-2xl p-4 sm:p-6 md:p-8 max-w-xl mx-auto"},hd={class:"mb-4 sm:mb-6 flex justify-center"},pd={class:"w-16 h-16 sm:w-20 sm:h-20 md:w-24 md:h-24 rounded-full bg-white/20 flex items-center justify-center"},md={class:"text-xl sm:text-2xl md:text-3xl font-bold text-white mb-3 sm:mb-4"},gd={class:"space-y-2 sm:space-y-3"},yd={key:2,class:"bg-white/10 backdrop-blur-md rounded-2xl p-4 sm:p-6 md:p-8 max-w-xl mx-auto"},vd={class:"mb-4 sm:mb-6 flex justify-center"},bd={class:"w-16 h-16 sm:w-20 sm:h-20 md:w-24 md:h-24 rounded-full bg-white/20 flex items-center justify-center"},wd={class:"text-xl sm:text-2xl md:text-3xl font-bold text-white mb-3 sm:mb-4"},_d={key:0,class:"text-white/90 space-y-3 sm:space-y-4 mb-4 sm:mb-6"},xd={class:"text-xs sm:text-sm md:text-base"},kd={class:"bg-white/10 rounded-lg p-3 sm:p-4 text-xs sm:text-sm space-y-1.5 sm:space-y-2"},Ed={class:"flex items-center gap-2"},Id={class:"flex items-center gap-2"},Ad={class:"flex items-center gap-2"},Sd={key:1,class:"space-y-3 sm:space-y-4 mb-4 sm:mb-6"},Cd={class:"text-white/90 text-xs sm:text-sm"},Od={class:"bg-white/20 rounded-full h-2.5 sm:h-3 overflow-hidden"},Td={class:"text-white/80 text-sm sm:text-base font-semibold"},Dd={key:2,class:"text-white/90 space-y-3 sm:space-y-4 mb-4 sm:mb-6"},Pd={class:"flex justify-center mb-3 sm:mb-4"},qd={key:3,class:"bg-red-500/20 border border-red-300/50 rounded-lg p-3 sm:p-4 mb-3 sm:mb-4"},Md={class:"text-white text-xs sm:text-sm"},Bd={class:"pb-6 sm:pb-8 md:pb-12 px-4 sm:px-6"},Rd={class:"max-w-2xl mx-auto"},jd={class:"flex justify-center gap-1 sm:gap-2 mb-4 sm:mb-6 md:mb-8 px-2"},zd=["onClick","aria-label"],Fd={class:"flex items-center justify-between gap-2 sm:gap-4"},$d={key:1,class:"w-10 sm:w-20"},Nd=["disabled"],Ld={__name:"OnboardingSlides",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","complete","skip"],setup(o,{emit:n}){const i=o,c=n,l=pe(i.modelValue),h=pe(0),m=pe(!0),E=rd(),{acceptAll:C,rejectAll:q}=kl(),R=pe(null),$=va(),F=pe(!1),Y=pe(0),de=pe(""),_e=pe(""),ve=pe(!1),Re=Ke(()=>h.value===E.length-1),be=Ke(()=>E[h.value]);ts(()=>i.modelValue,we=>{l.value=we,we&&(h.value=0)});function U(){h.value<E.length-1&&(h.value++,Ie())}function X(){h.value>0&&(h.value--,Ie())}function Ce(we){h.value=we,Ie()}function Ie(){m.value=!1,setTimeout(()=>{m.value=!0},50)}function xe(){return be.value.type==="privacy"?R.value?"Continue":"Choose One":Re.value&&ve.value?"Get Started":"Next"}function He(){Re.value&&ve.value?Z():U()}function Ht(){R.value="accept",C(),console.log("[Onboarding] User accepted analytics")}function Mt(){R.value="reject",q(),console.log("[Onboarding] User declined analytics")}async function H(){F.value=!0,_e.value="",Y.value=0;try{if(console.log(" Starting data import from onboarding..."),await ki.isDataImported()){console.log(" Data already imported, skipping..."),Y.value=100,ve.value=!0;return}await ki.loadAndImport(re=>{de.value=re.step,Y.value=re.progress}),Y.value=100,de.value="Import complete!",ve.value=!0,console.log(" Import finished from onboarding"),await $.initialize(),console.log(" Data store initialized")}catch(we){console.error(" Import failed:",we),_e.value=we.message||"Import failed. Please try again.",F.value=!1}}function Z(){td(),c("complete"),ae()}function ae(){l.value=!1,c("update:modelValue",!1)}function mt(we){if(F.value)return we.preventDefault(),we.returnValue="Import is in progress. Are you sure you want to leave? Your data will be lost.","Import is in progress. Are you sure you want to leave? Your data will be lost."}function Bt(we){l.value&&(we.key==="ArrowRight"?U():we.key==="ArrowLeft"?X():we.key==="Enter"&&Re.value&&ve.value&&Z())}return Oi(()=>{window.addEventListener("keydown",Bt),window.addEventListener("beforeunload",mt)}),ns(()=>{window.removeEventListener("keydown",Bt),window.removeEventListener("beforeunload",mt)}),(we,re)=>(oe(),ro(os,{to:"body"},[le(Ti,{name:"fade"},{default:Ot(()=>[l.value?(oe(),ue("div",id,[T("div",ad,[re[11]||(re[11]=T("div",{class:"pt-6 sm:pt-8 flex justify-center"},[T("img",{src:ba,alt:"BetterIslam Q&A",class:"w-20 h-20 sm:w-24 sm:h-24 rounded-2xl shadow-2xl"})],-1)),T("div",sd,[T("div",cd,[le(rs,{name:"slide-fade",mode:"out-in"},{default:Ot(()=>[(oe(!0),ue(un,null,Vn(Je(E),(me,je)=>is((oe(),ue("div",{key:me.id,class:"text-center"},[me.type==="info"?(oe(),ue(un,{key:0},[T("div",ud,[T("div",{class:Ue(["w-20 h-20 sm:w-24 sm:h-24 md:w-32 md:h-32 rounded-full bg-white/10 backdrop-blur-sm flex items-center justify-center shadow-2xl",m.value&&h.value===je?"animate-pulse":""])},[le(qe,{name:me.icon,class:Ue(["text-white",me.icon==="lightning"||me.icon==="fire"?"w-12 h-12 sm:w-16 sm:h-16 md:w-20 md:h-20":"w-10 h-10 sm:w-12 sm:h-12 md:w-16 md:h-16"])},null,8,["name","class"])],2)]),T("h2",ld,Me(me.title),1),T("p",dd,Me(me.description),1)],64)):me.type==="privacy"?(oe(),ue("div",fd,[T("div",hd,[T("div",pd,[le(qe,{name:"shield",class:"text-white w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12"})])]),T("h2",md,Me(me.title),1),re[2]||(re[2]=T("div",{class:"text-left space-y-3 sm:space-y-4 mb-4 sm:mb-6 max-h-[40vh] sm:max-h-none overflow-y-auto px-1"},[T("div",{class:"text-white/90 text-xs sm:text-sm md:text-base space-y-1.5 sm:space-y-2"},[T("p",{class:"font-semibold"},"What we collect (optional):"),T("ul",{class:"space-y-0.5 sm:space-y-1 text-xs sm:text-sm"},[T("li",{class:"flex items-start gap-2"},[T("span",{class:"text-white/60 flex-shrink-0"},""),T("span",null,"Anonymous usage patterns")]),T("li",{class:"flex items-start gap-2"},[T("span",{class:"text-white/60 flex-shrink-0"},""),T("span",null,"Search queries (to improve results)")]),T("li",{class:"flex items-start gap-2"},[T("span",{class:"text-white/60 flex-shrink-0"},""),T("span",null,"Device type and platform")])])]),T("div",{class:"text-white/90 text-xs sm:text-sm md:text-base space-y-1.5 sm:space-y-2"},[T("p",{class:"font-semibold"},"What we never collect:"),T("ul",{class:"space-y-0.5 sm:space-y-1 text-xs sm:text-sm"},[T("li",{class:"flex items-start gap-2"},[T("span",{class:"text-red-300 flex-shrink-0"},""),T("span",null,"Personal info (name, email, phone)")]),T("li",{class:"flex items-start gap-2"},[T("span",{class:"text-red-300 flex-shrink-0"},""),T("span",null,"Location data")]),T("li",{class:"flex items-start gap-2"},[T("span",{class:"text-red-300 flex-shrink-0"},""),T("span",null,"Contact lists or photos")])])])],-1)),T("div",gd,[T("button",{onClick:Ht,class:Ue([R.value==="accept"?"bg-white text-primary-700 ring-4 ring-white/50":"bg-white/20 text-white hover:bg-white/30","w-full px-4 sm:px-6 py-2.5 sm:py-3 rounded-xl font-semibold transition-all flex items-center justify-center gap-2 text-sm sm:text-base"])},[le(qe,{name:R.value==="accept"?"check":"shield",size:"sm"},null,8,["name"]),re[0]||(re[0]=cn(" Accept Analytics ",-1))],2),T("button",{onClick:Mt,class:Ue([R.value==="reject"?"bg-white text-primary-700 ring-4 ring-white/50":"bg-white/20 text-white hover:bg-white/30","w-full px-4 sm:px-6 py-2.5 sm:py-3 rounded-xl font-semibold transition-all flex items-center justify-center gap-2 text-sm sm:text-base"])},[le(qe,{name:R.value==="reject"?"check":"xCircle",size:"sm"},null,8,["name"]),re[1]||(re[1]=cn(" Decline Analytics ",-1))],2)]),re[3]||(re[3]=T("p",{class:"text-xs text-white/60 mt-3 sm:mt-4"}," You can change this anytime in Settings ",-1))])):me.type==="import"?(oe(),ue("div",yd,[T("div",vd,[T("div",bd,[le(qe,{name:"download",class:Ue(["text-white w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12",F.value?"animate-pulse":""])},null,8,["class"])])]),T("h2",wd,Me(ve.value?"Setup Complete!":F.value?"Importing Data...":me.title),1),!F.value&&!ve.value?(oe(),ue("div",_d,[T("p",xd,Me(me.description),1),T("div",kd,[T("div",Ed,[le(qe,{name:"book",size:"sm",class:"text-white/80 flex-shrink-0"}),re[4]||(re[4]=T("span",null,[T("strong",null,"8000+"),cn(" Islamic Q&A items")],-1))]),T("div",Id,[le(qe,{name:"collection",size:"sm",class:"text-white/80 flex-shrink-0"}),re[5]||(re[5]=T("span",null,[T("strong",null,"269"),cn(" Categories")],-1))]),T("div",Ad,[le(qe,{name:"download",size:"sm",class:"text-white/80 flex-shrink-0"}),re[6]||(re[6]=T("span",null,[T("strong",null,"~50MB"),cn(" database size")],-1))])])])):Ve("",!0),F.value?(oe(),ue("div",Sd,[T("p",Cd,Me(de.value),1),T("div",Od,[T("div",{class:"bg-white h-full transition-all duration-300",style:Ci({width:Y.value+"%"})},null,4)]),T("p",Td,Me(Math.round(Y.value))+"%",1),re[7]||(re[7]=T("p",{class:"text-xs text-white/60"}," Please don't refresh or close during import ",-1))])):Ve("",!0),ve.value?(oe(),ue("div",Dd,[T("div",Pd,[le(qe,{name:"check",class:"text-white w-12 h-12 sm:w-16 sm:h-16"})]),re[8]||(re[8]=T("p",{class:"text-sm sm:text-base md:text-lg"}," All set! You're ready to explore Islamic knowledge offline. ",-1))])):Ve("",!0),_e.value?(oe(),ue("div",qd,[T("p",Md,Me(_e.value),1)])):Ve("",!0)])):Ve("",!0)])),[[as,h.value===je]])),128))]),_:1})])]),T("div",Bd,[T("div",Rd,[T("div",jd,[(oe(!0),ue(un,null,Vn(Je(E),(me,je)=>(oe(),ue("button",{key:me.id,onClick:Qe=>Ce(je),class:Ue(["transition-all duration-300 flex-shrink-0",[h.value===je?"w-6 sm:w-8 h-1.5 sm:h-2 bg-white rounded-full":"w-1.5 sm:w-2 h-1.5 sm:h-2 bg-white/40 hover:bg-white/60 rounded-full"]]),"aria-label":`Go to slide ${je+1}`},null,10,zd))),128))]),T("div",Fd,[h.value>0&&!F.value?(oe(),ue("button",{key:0,onClick:X,class:"flex items-center gap-1 sm:gap-2 px-3 sm:px-6 py-2.5 sm:py-3 text-white/90 hover:text-white font-medium transition-colors text-sm sm:text-base"},[le(qe,{name:"arrowLeft",size:"sm"}),re[9]||(re[9]=T("span",{class:"hidden sm:inline"},"Previous",-1))])):(oe(),ue("div",$d)),be.value.type!=="import"||ve.value?(oe(),ue("button",{key:2,onClick:He,disabled:be.value.type==="privacy"&&!R.value,class:"flex items-center gap-1.5 sm:gap-2 px-5 sm:px-8 py-3 sm:py-4 bg-white text-primary-700 dark:text-primary-800 rounded-xl font-bold text-base sm:text-lg hover:bg-white/90 transition-all shadow-xl hover:shadow-2xl hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed"},[T("span",null,Me(xe()),1),le(qe,{name:Re.value&&ve.value?"check":"arrowRight",size:"md"},null,8,["name"])],8,Nd)):Ve("",!0),be.value.type==="import"&&!F.value&&!ve.value?(oe(),ue("button",{key:3,onClick:H,class:"flex items-center gap-1.5 sm:gap-2 px-5 sm:px-8 py-3 sm:py-4 bg-white text-primary-700 dark:text-primary-800 rounded-xl font-bold text-base sm:text-lg hover:bg-white/90 transition-all shadow-xl hover:shadow-2xl hover:scale-105"},[re[10]||(re[10]=T("span",null,"Start Import",-1)),le(qe,{name:"download",size:"md"})])):Ve("",!0)])])])]),re[12]||(re[12]=T("div",{class:"absolute inset-0 pointer-events-none overflow-hidden"},[T("div",{class:"absolute top-1/4 -left-32 w-64 h-64 bg-accent-400/20 rounded-full blur-3xl"}),T("div",{class:"absolute bottom-1/4 -right-32 w-64 h-64 bg-primary-400/20 rounded-full blur-3xl"})],-1))])):Ve("",!0)]),_:1})]))}},Kd=mo(Ld,[["__scopeId","data-v-b009d498"]]),Vd={id:"app",class:"min-h-screen bg-white dark:bg-neutral-950 transition-colors duration-200"},Ud={class:"lg:pl-72"},Hd={class:"min-h-screen pb-16 lg:pb-0"},Qd={__name:"App",setup(o){const n=ss(),{initTheme:i}=ga(),c=va(),l=pe(!1);Oi(async()=>{i(),console.log(" Running in browser mode"),setTimeout(()=>{nd()?(console.log("[Onboarding] First launch detected, showing integrated onboarding"),l.value=!0):h()},1e3),window.cordova&&window.device&&window.device.platform==="Android"&&document.addEventListener("backbutton",C,!1),console.log(" App mounted successfully")});async function h(){try{const q=await c.isDataImported(),R=n.currentRoute.value.path;!q&&R!=="/import"?(console.log("  Data not imported, redirecting to import page"),n.push("/import")):q&&await c.initialize()}catch(q){console.error("Error checking import status:",q)}}async function m(){console.log("[Onboarding] User completed onboarding (with privacy & import)"),l.value=!1;try{await c.initialize(),console.log(" Data store initialized after onboarding"),n.currentRoute.value.path!=="/"&&n.push("/")}catch(q){console.error(" Error initializing data store after onboarding:",q),h()}}function E(){console.log("[Onboarding] Skip triggered (deprecated)"),l.value=!1,h()}const C=q=>{q.preventDefault(),window.history.length>1&&n.currentRoute.value.path!=="/"?n.back():window.navigator.app&&window.navigator.app.exitApp()};return(q,R)=>{const $=oo("router-view");return oe(),ue("div",Vd,[le(Ul),T("div",Ud,[le(Xl),T("main",Hd,[le($,null,{default:Ot(({Component:F,route:Y})=>[le(Ti,{name:Y.meta.transition||"fade",mode:"out-in"},{default:Ot(()=>[(oe(),ro(Ai(F),{key:Y.path}))]),_:2},1032,["name"])]),_:1})])]),le(Kd,{modelValue:l.value,"onUpdate:modelValue":R[0]||(R[0]=F=>l.value=F),onComplete:m,onSkip:E},null,8,["modelValue"])])}}},Wd=mo(Qd,[["__scopeId","data-v-08ca8406"]]),Ei=()=>{const o=cs(Wd),n=us();o.use(n),o.use(ma),o.mount("#app"),console.log(" Vue app initialized"),Il()};window.cordova?document.addEventListener("deviceready",()=>{if(console.log(" Cordova device ready"),window.device&&window.device.platform==="iOS")console.log(" Skipping Microsoft Clarity (not supported on iOS)");else if(window.ClarityPlugin){const o=function(c){console.log(" Microsoft Clarity initialized:",c)},n=function(c){console.error(" Microsoft Clarity failed to initialize:",c)},i={logLevel:window.ClarityPlugin.LogLevel.None,allowMeteredNetworkUsage:!0};window.ClarityPlugin.initialize("u73c1nlpij",o,n,i)}else console.warn(" Microsoft Clarity plugin not available");Ei()},!1):(console.log(" Running in browser mode"),Ei());export{Hn as A,Zd as B,pt as C,ef as D,Jn as E,qt as F,of as G,cf as H,nf as I,af as J,Yd as K,zi as L,Xd as M,ys as N,Kd as O,Ri as P,sf as Q,Li as R,ff as S,Mc as T,xl as U,qe as _,mo as a,ql as b,ce as c,ki as d,kl as e,ga as f,Ol as g,Jd as h,tf as i,rf as j,Tt as k,ft as l,As as m,df as n,hn as o,Mi as p,lf as q,Ef as r,fe as s,gs as t,va as u,uf as v,ks as w,Ki as x,Zn as y,_s as z};
